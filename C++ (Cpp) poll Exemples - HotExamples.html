<!DOCTYPE html>
<!-- saved from url=(0080)https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html -->
<html lang="fr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" type="text/javascript" src="./C++ (Cpp) poll Exemples - HotExamples_files/gpt.js"></script><script async="" type="text/javascript" src="./C++ (Cpp) poll Exemples - HotExamples_files/gpt.js"></script><script data-cfasync="false">
    "use strict";!function(){var e=function(){var e,t="__tcfapiLocator",a=[],n=window;for(;n;){try{if(n.frames[t]){e=n;break}}catch(e){}if(n===window.top)break;n=n.parent}e||(!function e(){var a=n.document,r=!!n.frames[t];if(!r)if(a.body){var i=a.createElement("iframe");i.style.cssText="display:none",i.name=t,a.body.appendChild(i)}else setTimeout(e,5);return!r}(),n.__tcfapi=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(!n.length)return a;if("setGdprApplies"===n[0])n.length>3&&2===parseInt(n[1],10)&&"boolean"==typeof n[3]&&(e=n[3],"function"==typeof n[2]&&n[2]("set",!0));else if("ping"===n[0]){var i={gdprApplies:e,cmpLoaded:!1,cmpStatus:"stub"};"function"==typeof n[2]&&n[2](i)}else a.push(n)},n.addEventListener("message",(function(e){var t="string"==typeof e.data,a={};try{a=t?JSON.parse(e.data):e.data}catch(e){}var n=a.__tcfapiCall;n&&window.__tcfapi(n.command,n.version,(function(a,r){var i={__tcfapiReturn:{returnValue:a,success:r,callId:n.callId}};t&&(i=JSON.stringify(i)),e.source.postMessage(i,"*")}),n.parameter)}),!1))};"undefined"!=typeof module?module.exports=e:e()}();

    document.addEventListener("DOMContentLoaded", function(event) {
        var t = document.createElement('script');
        t.async = false;
        t.src = 'https://g.ezodn.com/cmp/v2/cmp.js?v=42';
        t.setAttribute("data-cfasync", "false");
        var tag = document.getElementsByTagName('head')[0];
        tag.appendChild(t);
    });
    </script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">var __ez=__ez||{};__ez.stms=Date.now();__ez.evt={};__ez.script={};__ez.ck=__ez.ck||{};__ez.template={};__ez.template.isOrig=false;__ez.queue=(function(){var count=0,incr=0,items=[],timeDelayFired=false,hpItems=[],lpItems=[],allowLoad=true;var obj={func:function(name,funcName,parameters,isBlock,blockedBy,deleteWhenComplete,proceedIfError){var self=this;this.name=name;this.funcName=funcName;this.parameters=parameters===null?null:(parameters instanceof Array)?parameters:[parameters];this.isBlock=isBlock;this.blockedBy=blockedBy;this.deleteWhenComplete=deleteWhenComplete;this.isError=false;this.isComplete=false;this.isInitialized=false;this.proceedIfError=proceedIfError;this.isTimeDelay=false;this.process=function(){log("... func = "+name);self.isInitialized=true;self.isComplete=true;log("... func.apply: "+name);var funcs=self.funcName.split('.');var func=null;if(funcs.length>3){}else if(funcs.length===3){func=window[funcs[0]][funcs[1]][funcs[2]];}else if(funcs.length===2){func=window[funcs[0]][funcs[1]];}else{func=window[self.funcName];}
if(typeof func!=='undefined'&&func!==null){func.apply(null,this.parameters);}
if(self.deleteWhenComplete===true)delete items[name];if(self.isBlock===true){log("----- F'D: "+self.name);processAll();}}},file:function(name,path,isBlock,blockedBy,async,defer,proceedIfError){var self=this;this.name=name;this.path=path;this.async=async;this.defer=defer;this.isBlock=isBlock;this.blockedBy=blockedBy;this.isInitialized=false;this.isError=false;this.isComplete=false;this.proceedIfError=proceedIfError;this.isTimeDelay=false;this.process=function(){self.isInitialized=true;log("... file = "+name);var scr=document.createElement('script');scr.src=path;if(async===true)scr.async=true;else if(defer===true)scr.defer=true;scr.onerror=function(){log("----- ERR'D: "+self.name);self.isError=true;if(self.isBlock===true){processAll();}};scr.onreadystatechange=scr.onload=function(){var state=scr.readyState;log("----- F'D: "+self.name);if((!state||/loaded|complete/.test(state))){self.isComplete=true;if(self.isBlock===true){processAll();}}};document.getElementsByTagName('head')[0].appendChild(scr);}},fileLoaded:function(name,isComplete){this.name=name;this.path="";this.async=false;this.defer=false;this.isBlock=false;this.blockedBy=[];this.isInitialized=true;this.isError=false;this.isComplete=isComplete;this.proceedIfError=false;this.isTimeDelay=false;this.process=function(){};}};function init(){window.addEventListener("load",function(){setTimeout(function(){timeDelayFired=true;log('TDELAY -----');processAll();},5000);},false);}
function addFile(name,path,isBlock,blockedBy,async,defer,proceedIfError,priority){var item=new obj.file(name,path,isBlock,blockedBy,async,defer,proceedIfError);if(priority===true){hpItems[name]=item}else{lpItems[name]=item}
items[name]=item;checkIfBlocked(item);}
function setallowLoad(settobool){allowLoad=settobool}
function addFunc(name,func,parameters,isBlock,blockedBy,autoInc,deleteWhenComplete,proceedIfError,priority){if(autoInc===true)name=name+"_"+incr++;var item=new obj.func(name,func,parameters,isBlock,blockedBy,deleteWhenComplete,proceedIfError);if(priority===true){hpItems[name]=item}else{lpItems[name]=item}
items[name]=item;checkIfBlocked(item);}
function addTimeDelayFile(name,path){var item=new obj.file(name,path,false,[],false,false,true);item.isTimeDelay=true;log(name+' ... '+' FILE! TDELAY');lpItems[name]=item;items[name]=item;checkIfBlocked(item);}
function addTimeDelayFunc(name,func,parameters){var item=new obj.func(name,func,parameters,false,[],true,true);item.isTimeDelay=true;log(name+' ... '+' FUNCTION! TDELAY');lpItems[name]=item;items[name]=item;checkIfBlocked(item);}
function checkIfBlocked(item){if(isBlocked(item)===true||allowLoad==false)return;item.process();}
function isBlocked(item){if(item.isTimeDelay===true&&timeDelayFired===false){log(item.name+" blocked = TIME DELAY!");return true;}
if(item.blockedBy instanceof Array){for(var i=0;i<item.blockedBy.length;i++){var block=item.blockedBy[i];if(items.hasOwnProperty(block)===false){log(item.name+" blocked = "+block);return true;}else if(item.proceedIfError===true&&items[block].isError===true){return false;}else if(items[block].isComplete===false){log(item.name+" blocked = "+block);return true;}}}
return false;}
function markLoaded(filename){if(!filename||0===filename.length){return;}
if(filename in items){var item=items[filename];if(item.isComplete===true){log(item.name+' '+filename+': error loaded duplicate')}else{item.isComplete=true;item.isInitialized=true;}}else{items[filename]=new obj.fileLoaded(filename,true);}
log("markLoaded dummyfile: "+items[filename].name);}
function logWhatsBlocked(){for(var i in items){if(items.hasOwnProperty(i)===false)continue;var item=items[i];isBlocked(item)}}
function log(msg){var href=window.location.href;var reg=new RegExp('[?&]ezq=([^&#]*)','i');var string=reg.exec(href);var res=string?string[1]:null;if(res==="1")console.debug(msg);}
function processAll(){count++;if(count>200)return;log("let's go");processItems(hpItems);processItems(lpItems);}
function processItems(list){for(var i in list){if(list.hasOwnProperty(i)===false)continue;var item=list[i];if(item.isComplete===true||isBlocked(item)||item.isInitialized===true||item.isError===true){if(item.isError===true){log(item.name+': error')}else if(item.isComplete===true){log(item.name+': complete already')}else if(item.isInitialized===true){log(item.name+': initialized already')}}else{item.process();}}}
init();return{addFile:addFile,addDelayFile:addTimeDelayFile,addFunc:addFunc,addDelayFunc:addTimeDelayFunc,items:items,processAll:processAll,setallowLoad:setallowLoad,markLoaded:markLoaded,logWhatsBlocked:logWhatsBlocked,};})();__ez.evt.add=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n()},__ez.evt.remove=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):delete e["on"+t]};__ez.script.add=function(e){var t=document.createElement("script");t.src=e,t.async=!0,t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t)};__ez.dot={};</script><script>var __sellerid="2a3cc1bd6330017a4a81dc7384c99d31";</script><link rel="preload" as="script" href="./C++ (Cpp) poll Exemples - HotExamples_files/gpt.js"><link href="https://ad.doubleclick.net/" rel="dns-prefetch"><link href="https://pagead2.googlesyndication.com/" rel="dns-prefetch"><link href="https://googleads.g.doubleclick.net/" rel="dns-prefetch"><link href="https://tpc.googlesyndication.com/" rel="dns-prefetch"><link href="https://adservice.google.com/" rel="dns-prefetch"><link href="https://secureads.g.doubleclick.net/" rel="dns-prefetch"><link href="https://www.googletagservices.com/" rel="dns-prefetch"><link rel="preload" as="script" href="https://go.ezodn.com/hb/dall.js?b=amx,appnexus,conversant,criteo,ix,medianet,oftmedia,onetag,pubmatic,sovrn&amp;cb=195-2-26"><script async="" src="./C++ (Cpp) poll Exemples - HotExamples_files/apstag.js"></script><script data-cfasync="false" data-pagespeed-no-defer="">var __ezaps=[{"slotID":"div-gpt-ad-hotexamples_com-box-1-0","slotName":"/21732118914/hotexamples_com-box-1","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-box-1-0_1","slotName":"/21732118914/hotexamples_com-box-1","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-box-1-0_2","slotName":"/21732118914/hotexamples_com-box-1","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-box-1-0_3","slotName":"/21732118914/hotexamples_com-box-1","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-large-leaderboard-1-0","slotName":"/21732118914/hotexamples_com-large-leaderboard-1","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1","slotName":"/21732118914/hotexamples_com-large-leaderboard-1","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2","slotName":"/21732118914/hotexamples_com-large-leaderboard-1","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3","slotName":"/21732118914/hotexamples_com-large-leaderboard-1","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-large-billboard-2-0","slotName":"/21732118914/hotexamples_com-large-billboard-2","sizes":[[250,250]]},{"slotID":"div-gpt-ad-hotexamples_com-box-4-0","slotName":"/21732118914/hotexamples_com-box-4","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-banner-2-0","slotName":"/21732118914/hotexamples_com-banner-2","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-banner-1-0","slotName":"/21732118914/hotexamples_com-banner-1","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-medrectangle-4-0","slotName":"/21732118914/hotexamples_com-medrectangle-4","sizes":[[468,60]]},{"slotID":"div-gpt-ad-hotexamples_com-box-2-0","slotName":"/21732118914/hotexamples_com-box-2","sizes":[[728,90]]},{"slotID":"div-gpt-ad-hotexamples_com-large-leaderboard-2-0","slotName":"/21732118914/hotexamples_com-large-leaderboard-2","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-box-3-0","slotName":"/21732118914/hotexamples_com-box-3","sizes":[[728,90]]},{"slotID":"div-gpt-ad-hotexamples_com-leader-1-0","slotName":"/21732118914/hotexamples_com-leader-1","sizes":[[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-medrectangle-3-0","slotName":"/21732118914/hotexamples_com-medrectangle-3","sizes":[[580,400],[336,280],[300,250]]},{"slotID":"div-gpt-ad-hotexamples_com-large-mobile-banner-1-0","slotName":"/21732118914/hotexamples_com-large-mobile-banner-1","sizes":[[300,250]]}];var __ezapid="aa05931b-5308-4ea3-95a2-adf84f4ffde4";!function(a9,a){if(a[a9])return;function q(c,r){a[a9]._Q.push([c,r])}
a[a9]={init:function(){q("i",arguments)},fetchBids:function(){q("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]};}("apstag",window);apstag.init({pubID:__ezapid,adServer:'googletag',schain:{complete:1,ver:'1.0',nodes:[{asi:'ezoic.ai',sid:__sellerid,hp:1}]}});function ezapsFetchBids(amazonSlots){if(typeof amazonSlots==='undefined'||amazonSlots.length===0){return}
apstag.fetchBids({slots:amazonSlots,timeout:2e3},function(bids){function getSlotById(id){if(typeof window.ezslots==='undefined'||window.ezslots==0){return;}
for(var i=0;i<window.ezslots.length;i++){var slot=window[ezslots[i]];if(typeof slot==='undefined'){continue;}
var slotId=slot.getSlotElementId();if(typeof slotId!=='undefined'&&slotId==id){return slot;}}}
function setA9DisplayBids(bids){if(typeof bids==='undefined'||bids.length==0){return;}
var keys=apstag.targetingKeys();for(var i=0;i<bids.length;i++){var bid=bids[i];for(var k=0;k<keys.length;k++){if(keys[k]in bid){ezSetSlotTargeting(bid.slotID,keys[k],bid[keys[k]]);}}}}
googletag.cmd.push(function(){setA9DisplayBids(bids);});});}
if(typeof __tcfapi!="undefined"){}else{ezapsFetchBids(__ezaps);}</script><script>var __banger_pmp_deals=function(){var d={17:{"DealId":17,"Floor":160},18:{"DealId":18,"Floor":25},19:{"DealId":19,"Floor":100},1428:{"DealId":1428,"Floor":25},873:{"DealId":873,"Floor":100},20:{"DealId":20,"Floor":300},21:{"DealId":21,"Floor":2000}};return[{"SlotName":"/21732118914/hotexamples_com-large-mobile-banner-1","Deals":[d[17],d[18],d[19],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-banner-1","Deals":[d[17],d[18],d[19],d[20],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-large-leaderboard-2","Deals":[d[17],d[18],d[19],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-large-billboard-2","Deals":[d[17],d[18],d[19],d[20],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-medrectangle-4","Deals":[d[17],d[18],d[19],d[20],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-box-3","Deals":[d[17],d[18],d[19],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-box-4","Deals":[d[17],d[18],d[19],d[20],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-box-1","Deals":[d[17],d[18],d[19],d[20],d[21],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-large-leaderboard-1","Deals":[d[17],d[18],d[19],d[20],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-leader-1","Deals":[d[17],d[18],d[19],d[20],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-medrectangle-3","Deals":[d[17],d[18],d[19],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-banner-2","Deals":[d[17],d[18],d[19],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-box-2","Deals":[d[18],d[19],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-large-leaderboard-1","Deals":[d[17],d[18],d[19],d[20],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-box-1","Deals":[d[17],d[18],d[19],d[20],d[21],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-large-leaderboard-1","Deals":[d[17],d[18],d[19],d[20],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-box-1","Deals":[d[17],d[18],d[19],d[20],d[21],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-box-1","Deals":[d[17],d[18],d[19],d[20],d[21],d[1428],d[873]]},{"SlotName":"/21732118914/hotexamples_com-large-leaderboard-1","Deals":[d[17],d[18],d[19],d[20],d[1428],d[873]]}]}();</script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">ezobv=51;</script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">function ez_isclean(data){if(typeof data==='undefined'){data=document.URL;}
var re=/(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))(@|%2540|%40)((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/;var isClean=!re.test(data);return isClean;}
var ezSlotKVStore={};function ezSetSlotTargeting(divid,key,value){var slot=ezGetSlotById(divid);if(slot){slot.setTargeting(key,value);}else{if(typeof ezSlotKVStore[divid]=='undefined'){ezSlotKVStore[divid]={};}
ezSlotKVStore[divid][key]=value;}}
function ezGetSlotById(id){if(typeof window.ezslots==='undefined'||window.ezslots==0){return;}
for(var i=0;i<window.ezslots.length;i++){var slot=window[ezslots[i]];if(typeof slot==='undefined'){continue;}
var slotId=slot.getSlotElementId();if(typeof slotId!=='undefined'&&slotId==id){return slot;}}}
var ez_queue=new Array();function sort_queue(a,b)
{if(a.priority<b.priority)return-1;else if(a.priority==b.priority)return 0;else return 1;}
function execute_ez_queue()
{ez_queue.sort(sort_queue);for(var i in ez_queue)
{if(typeof ez_queue[i].method!="undefined")
{try{ez_queue[i].method.call(null);}
catch(err){}}}}
window.ez_ad_units=new Array();window.ezslots=new Array();window.ezsrqt={};function ez_write_tag(d){if(ez_isclean()&&d instanceof Array){if(typeof ezstandalone!=='undefined'&&typeof ezstandalone.selectedPlaceholders!=='undefined'&&ezstandalone.selectedPlaceholders[d[3]]===true){return "1+1";}
ez_ad_units[ez_ad_units.length]=d;var dve="";if(typeof d[5]!='undefined'&&d[5]>0){dve='_'+d[5];}
var ezcmd="googletag.cmd.push(function() {var divid = 'div-gpt-ad-"+d[1]+"-"+d[4]+""+dve+"';if(typeof ezlrarn == 'function'){ezlrarn(divid);}googletag.display(divid);var to = 0;if("+d[2]+".getTargeting('ga')[0] == '0'){to = 500;}if((window.ezDisableInitialLoad==true || googletag.pubads().isInitialLoadDisabled()) && window.ezoll != true){setTimeout(function(){googletag.pubads().refresh(["+d[2]+"])},to);}});";return ezcmd;}
return "1+1";}
function in_array(needle,haystack){var length=haystack.length;for(var i=0;i<length;i++){if(haystack[i]==needle)return true;}
return false;}
var ezrpos=new Array();var ez_current_interval;var ez_current_load=0;function __ez_fad_load(n,r){if(__ez_fad_csnt()&&__ez_fad_rdy()&&ezslit_run[n]!=true&&typeof __ez_fad_divs[n]!='undefined'&&__ez_fad_divs[n].length>0){ezslit_run[n]=true;__ez_fad_gpt();if(n>0&&n!=5){__ez_fad_pb();}
googletag.cmd.push(function(){var s=[];for(var i=0;i<__ez_fad_divs[n].length;i++){if(__ez_fad_divsd.indexOf(__ez_fad_divs[n][i])==-1){__ez_fad_divsd.push(__ez_fad_divs[n][i]);s.push(__ez_fad_initslot[__ez_fad_divs[n][i]](r));googletag.display(__ez_fad_divs[n][i]);}};var ws=[];for(i3=0;i3<s.length;i3++){ws.push(window[s[i3]]);}
googletag.pubads().refresh(ws);setTimeout(__ez_fad_floatshow,0);});if(n==0){if(document.readyState==="complete"||document.readyState==="loaded"){googletag.cmd.push(function(){__ez_fad_load(5,null);});setTimeout(googletag.cmd.push(function(){__ez_fad_floatshow()}),500);setTimeout(function(){__ez_fad_load(1,null);__ez_fad_load(5,null);},5500);return;}
document.addEventListener('DOMContentLoaded',function(evt){googletag.cmd.push(function(){__ez_fad_load(5,null);});setTimeout(googletag.cmd.push(function(){__ez_fad_floatshow()}),500);setTimeout(function(){__ez_fad_load(1,null);__ez_fad_load(5,null);},5500);},false);}}}
var __ez_fad_floatshowd=false;function __ez_fad_floatshow(d){if(__ez_fad_floatshowd==false&&typeof __ez_fad_floating!='undefined'){__ez_fad_floatshowd=true;var e=document.getElementById('ezmobfooter');if(e!=null){e.classList.add('ezmobtrans');}else{head=document.head||document.getElementsByTagName('head')[0],style=document.createElement('style');head.appendChild(style);var css="body > #ezmobfooter{bottom:0px !important;visibility:visible;}";style.type='text/css';if(style.styleSheet){style.styleSheet.cssText=css;}else{style.appendChild(document.createTextNode(css));}}
googletag.cmd.push(function(){for(var i=0;i<__ez_fad_floating.length;i++){var s=__ez_fad_initslot[__ez_fad_floating[i]](null);googletag.display(__ez_fad_floating[i]);googletag.pubads().refresh([window[s]]);}});}}
var __ez_fad_initslot={};var __ez_fad_fastd=[];var __ez_fad_fastdiv=[];var __ez_fad_fastslots=[];var __ez_fad_viewslots=[];var __ez_fad_instaslots=[];var ezslit_run=[];var __ez_fad_divs=[[],[],[],[],[],[],[]];__ez_fad_divpos={};var __ez_fad_divsd=[];var __ez_fad_vw=window.screen.width;var __ez_fad_vh=window.screen.height;function __ez_fad_invisible(e){!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}
function __ez_fad_position(id){var did=document.getElementById(id);if(did!=null){var rect=did.getBoundingClientRect();var vs=window.scrollY||document.body.scrollTop||document.documentElement.scrollTop;var vh=vs+__ez_fad_vh;_ez_fad_vw=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;__ez_fad_vh=window.innerHeight||Math.max(document.documentElement.clientHeight,document.body.clientHeight);var height_adjust=800;if(__ez_fad_vw<1200){height_adjust=__ez_fad_vh*1.25;vh+=0;}
if(__ez_fad_floating.indexOf(id)==-1){__ez_fad_divpos[id]=rect.top;if(__ez_fad_invisible(did)&&isFloat!=true){__ez_fad_divs[4].push(id);}else if(rect.top<vh&&(ezslit_run[0]!=true||ezslit_run[5]!=true)){if(ezslit_run[0]!=true){__ez_fad_gpt();__ez_fad_divs[0].push(id);}else{__ez_fad_divs[5].push(id);}}else if(rect.top<(vh+height_adjust)&&ezslit_run[1]!=true){if(ezslit_run[0]!=true){__ez_fad_load(0,0);};__ez_fad_divs[1].push(id);}else if(rect.top<(vh+height_adjust+(__ez_fad_vh))&&ezslit_run[2]!=true){if(ezslit_run[0]!=true){__ez_fad_load(0,0);};__ez_fad_divs[2].push(id);}else{__ez_fad_divs[3].push(id);}}}}
function __ez_fad_fast(s,f,m){if(__ez_fad_fastd.indexOf(s)==-1){__ez_fad_fastd.push(s);googletag.cmd.push(function(){var ebbr2='empty';var br2=0;if(typeof ezoibfh[f]!='undefined'){ebbr2=ezoibfh[f];br2=f;}
if(typeof window['ezslot_'+s]!='undefined'){var br1=parseInt(window['ezslot_'+s].getTargeting('br1')[0]);if(isNaN(br1)||br2<br1){window['ezslot_'+s].setTargeting('br1',br2).setTargeting('eb_br',ebbr2);if(m!=null){window['ezslot_'+s].setTargeting('bvr',m)}}else{}}else{}});}}
function __ez_fad_csnt(){return document.cookie.indexOf('ezCMPCookieConsent')!==-1||typeof __ez_conestreq=='undefined';}
var __ez_fad_haspo=false;if(typeof PerformanceObserver!='undefined'&&typeof PerformanceObserver.supportedEntryTypes!='undefined'){if(PerformanceObserver.supportedEntryTypes.indexOf('largest-contentful-paint')>-1){__ez_fad_haspo=true;}}
function __ez_fad_rdy(){if(document.body!==null&&(__ez_fad_haspo==false&&__ez_fad_doc_ht>__ez_fad_vp_ht||__ez_fad_hascp)||document.readyState==="complete"){return true;}else{__ez_fad_doc_ht=__ez_fad_docht();__ez_fad_vp_ht=__ez_fad_vpht();}
return false;}
function __ez_fad_docht(){if(typeof document.body!='undefined'&&document.body!=null){return Math.max(document.body.scrollHeight,document.body.offsetHeight);}else if(typeof document.documentElement!='undefined'){return Math.max(document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);}else{return 0;}}
function __ez_fad_vpht(){if(typeof window.innerHeight!='undefined'){return window.innerHeight;}else if(typeof document.body!='undefined'&&document.body!=null){return document.body.clientHeight;}else if(typeof document.documentElement!='undefined'){return document.documentElement.clientHeight;}
else{return 0;}}
var __ez_fad_doc_ht=__ez_fad_docht();var __ez_fad_vp_ht=__ez_fad_vpht();var __ez_fad_hascp=false;try{const __ez__fad_po=new PerformanceObserver((entryList)=>{__ez_fad_hascp=true;});__ez__fad_po.observe({type:'largest-contentful-paint',buffered:true});}catch(e){}</script><script data-ezscrex="false">var ezorbf=[];</script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">window.isEZABL=false;window.ezmadspc=300;window.ezoViewCheck=false;</script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">window.ezDisableInitialLoad=false;</script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">window.googletag=window.googletag||{};googletag.cmd=googletag.cmd||[];</script><script data-ezscrex="false">window.addEventListener("EzoIvent",function(a){if(a.detail[0]>1||a.detail[0]<0){(function(){var gads=document.createElement('script');gads.async=true;gads.type='text/javascript';gads.onload=function(){if(typeof ezogallbs=='function'){ezogallbs()}};var useSSL='https:'==document.location.protocol;gads.src=(useSSL?'https:':'http:')+
'//securepubads.g.doubleclick.net/tag/js/gpt.js';var node=document.getElementsByTagName('script')[0];node.parentNode.insertBefore(gads,node);})();}});</script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">window.ezogetbrkey=function(s){var k='br1';var k2='eb_br';if(window.ezogtk==""){k='br1u';k2='eb_bru';}else if(window.ezogtk!="NT"){k='br1t';k2='eb_brt';}s.setTargeting('br1',s.getTargeting(k));s.setTargeting('eb_br',s.getTargeting(k2));};googletag.cmd.push(function(){googletag.pubads().enableSingleRequest();googletag.pubads().addEventListener('slotRenderEnded',function(event){__ez.queue.addFunc("ezbanger","ezbanger",event,false,['banger.js'],true,true,false,true);});googletag.pubads().addEventListener('impressionViewable',function(event){__ez.queue.addFunc("ezvb","ezvb",event,false,['banger.js'],true,true,false,true);});googletag.pubads().addEventListener('slotResponseReceived',function(event){__ez.queue.addFunc("ezsr","ezsr",event,false,['banger.js'],true,true,false,true);});googletag.pubads().addEventListener('slotRequested',function(e){window.ezsrqt[e.slot.getSlotElementId()]=Date.now();});googletag.pubads().disableInitialLoad();googletag.pubads().disableInitialLoad();googletag.pubads().enableLazyLoad({fetchMarginPercent:400,renderMarginPercent:150,mobileScaling:2.0});googletag.enableServices();});window.ezoll=false;window.ezoadxnc='21732118914';window.ezoadhb='2200';var ezoibfh={0:'zero',1000000:'off',500:'6d82aebae6bcefcae8983b0dcc92cec9',44:'588553dcabeb5286f2bd86e6617a0d98',38:'2987c3db2c41b735b4d6867239315fb0',2:'ff65489184a8bd745b588323ab1b4e22',1800:'5233c23062683d6509453cde6fc6add3',800:'04496beb0f6ca268a9a33f6569f82cb5',220:'c8f8afd5bc9d2b8b306959d0f8989efe',180:'534fb181871009a53a0e48bf40359a65',60:'5dfc84b2afe9d09bb5135bfcbbc5970f',450:'f63322dda53fb357fc621e718fd4fb87',200:'bb779436aa3533ea7e00abe462374b80',20:'45449ee2d6533045f60351c94107ba8e',8:'e2195fcdbbb593f7fa040d51c2eaea6c',0:'e4959d004f77f2c50c86f631c5e35273',280:'2acc48f80457fdc6d4d6786673884135',160:'736e4998c7cae21e6c67e08e2de4db76',36:'c6ffcfdd3dd19ac09fbf0cb03baa3e4b',24:'4b9359dae970d701895b70c7efed2383',22:'eeb512de4b40f938fd78cdef344a7ebd',1100:'8a72b14553d8dfd39917a04b6b74550d',600:'f0925b4547fc827b18897e82de41f3b6',550:'fdeb1c0131f36a890082d4fe8e1da0d1',30:'d753ba285129d8fd7ef33dec95bcaa7e',6:'f09d4fef38161a27d028cff6eebf43aa',400:'24b380adcc0659544af3c796e2648643',240:'8e05f6c6b0f467a340fd9f1edf21c2da',90:'1ea83551a903e458c56ec08ec0ffaa93',70:'ea7c242a89c8cb1608366a3d063fa70d',900:'04ebbcfde9a1ec4f315d9a36cf0b7b8e',350:'073dd12bd568a53b780a1e7d84a65a39',120:'9b8b7ac6c7f250874e7a1340470af55d',16:'5123967dad9631f0d2a57fa9c3237b87',1900:'cce43b634ca6fe368c77e70edfe1459b',950:'13505aceb7f83a105b073aa7cc81124c',700:'b09f4d2e4dcd3d270724508a246baee4',140:'13817432a186231a2c8afb2cc1bac45d',12:'41f20af1f102ac44e83c11508b6865c1',10:'295bc01864bf3dbd0117e0a3f7f6bc96',2200:'f30ba7de9e2a33f0f927ef82759eb3ce',1600:'1cc6194a60dec937c7bbae022bbe3dfd',1000:'c8c538c0b156a3ed71b8a1a8556e8ddf',100:'2b579bd406d80336360cc9360dca858a',14:'780324bcbe122aeb7768d94246861ef2',4:'063a7705d5a9d51bc46e0a87fba28a89',2100:'a8fc62cdaaad9ea4ba6561072b1d55b9',1500:'6a552ada640fe30aee10cad530838cc8',42:'f66e127b473e92f89e2d14510803ea0a',26:'09900f25ac768e2ab6f6a1b9b20b686a',18:'190bf94969f2d51c1f9954199aa5f4f8',1700:'8e2d589a04d2a07b8344f6816b701b81',650:'db457ec4f01ff743ad5ed236c4bdfebb',48:'a07d6583d81e029ba17a8abf2bdda13b',2000:'995960f3f08874f9439eeba20420e444',1200:'4e79eeb5c47815f3d62b430ba7a86908',850:'89140e49112be0d1d542e0eda661bd02',50:'f0b3832c5a11b18826c14c2c6c503110',32:'91e22f7223f09c1ff1a7040043fe9b1b',260:'028fd4209634b3f030ec544d795c74ac',80:'931e89386514f6e0ab7df9718ec5a124',1400:'3991a6d8703c4b654d6670aa0aa33d85',1300:'eac3f7dff0bea6446490695dba17123e',300:'aea15b65f697c2bc2826a2d1d3e3275f',46:'fc44e27e7de5f52a5f3c42d1877542d7',40:'6f1c86ebad23a9c4f3d9e02ac8a8dbbf',750:'8667d34af751e626afa0f7877d61515b',34:'cc08e2bb0d386fbf4465310e5dcc50e8',28:'fe1f34fd0c4fe8bf8d52adece55deeb2'};var ezaxmns={};var ezaucmns={};ezaxmns["div-gpt-ad-hotexamples_com-box-4-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-box-4-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-large-billboard-2-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-large-billboard-2-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-large-mobile-banner-1-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-large-mobile-banner-1-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-medrectangle-3-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-medrectangle-3-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-banner-2-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-banner-2-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-leader-1-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-leader-1-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-banner-1-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-banner-1-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-medrectangle-4-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-medrectangle-4-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-box-3-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-box-3-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-large-leaderboard-2-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-large-leaderboard-2-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-box-1-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-box-1-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-box-1-0_1"]=0;ezaucmns["div-gpt-ad-hotexamples_com-box-1-0_1"]=0;ezaxmns["div-gpt-ad-hotexamples_com-box-1-0_2"]=0;ezaucmns["div-gpt-ad-hotexamples_com-box-1-0_2"]=0;ezaxmns["div-gpt-ad-hotexamples_com-box-1-0_3"]=0;ezaucmns["div-gpt-ad-hotexamples_com-box-1-0_3"]=0;ezaxmns["div-gpt-ad-hotexamples_com-box-2-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-box-2-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-large-leaderboard-1-0"]=0;ezaucmns["div-gpt-ad-hotexamples_com-large-leaderboard-1-0"]=0;ezaxmns["div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1"]=0;ezaucmns["div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1"]=0;ezaxmns["div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2"]=0;ezaucmns["div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2"]=0;ezaxmns["div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3"]=0;ezaucmns["div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3"]=0;var __ez_fad_floating=[];var __ez_fad_gptd=false;var __ez_fad_ezpbinitd=false;function __ez_fad_gpt(){if(__ez_fad_gptd==false){__ez_fad_gptd=true;(function(){var gads=document.createElement('script');gads.async=true;gads.type='text/javascript';var useSSL='https:'==document.location.protocol;gads.src=(useSSL?'https:':'http:')+
'//securepubads.g.doubleclick.net/tag/js/gpt.js';var node=document.getElementsByTagName('script')[0];node.parentNode.insertBefore(gads,node);})();}}function __ez_fad_pb(){if(__ez_fad_ezpbinitd==false&&typeof __ez_fad_ezpbinit=='function'){__ez_fad_ezpbinitd=true;__ez_fad_ezpbinit()}};__ez_fad_initslot['div-gpt-ad-hotexamples_com-box-4-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-box-4-0';ezslot_9=googletag.defineSlot('/21732118914/hotexamples_com-box-4',[[300,250],[468,60],[234,60],[728,90],[320,50],[360,310],[320,360],[350,360]],'div-gpt-ad-hotexamples_com-box-4-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'4276099776420525','eid':'4276099776420525','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1107','sap':'1107','a':'|1|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'9','reft':'n','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'3','al':'1003','compid':'0','tap':'hotexamples_com-box-4-4276099776420525','eb_br':'24b380adcc0659544af3c796e2648643','eba':'0','bv':'2','bvm':'0','bvr':'6','shp':'1','ftsn':'3','br1':'400','br2':'180','ezoic':'1','nmau':'0','mau':'0','stl':[34,116,120,14,51,0,37,34,71,30,0,31],'deal1':[21,22,23,24,25,26,27,28,760,815,817,899,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[9]="9";ezslots.push("ezslot_9");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-4-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-4-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_9";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-4-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-4-0');__ez_fad_fast('9',140,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-box-4-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-4-0');__ez_fad_fast('9',300,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-box-4-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-4-0');__ez_fad_fast('9',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-large-billboard-2-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-large-billboard-2-0';ezslot_8=googletag.defineSlot('/21732118914/hotexamples_com-large-billboard-2',[[250,250],[300,1050],[300,600],[160,600],[120,600],[120,240],[180,150],[125,125],[300,250],[200,200],[234,60],['fluid'],[360,310],[410,350],[370,390]],'div-gpt-ad-hotexamples_com-large-billboard-2-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'176351068453565','eid':'176351068453565','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1117','sap':'1117','a':'|252|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'8','reft':'tf','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'0','al':'1034','compid':'0','tap':'hotexamples_com-large-billboard-2-176351068453565','eb_br':'aea15b65f697c2bc2826a2d1d3e3275f','eba':'0','bv':'24','bvm':'0','bvr':'2','shp':'2','ftsn':'3','br1':'300','br2':'160','ezoic':'1','nmau':'0','mau':'0','stl':[63,13,120,67,51,0,66,20,71,30,0,31],'deal1':[21,22,23,24,25,26,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[8]="8";ezslots.push("ezslot_8");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-billboard-2-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-billboard-2-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_8";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-billboard-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-billboard-2-0');__ez_fad_fast('8',100,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-large-billboard-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-billboard-2-0');__ez_fad_fast('8',240,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-large-billboard-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-billboard-2-0');__ez_fad_fast('8',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-large-mobile-banner-1-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-large-mobile-banner-1-0';ezslot_18=googletag.defineSlot('/21732118914/hotexamples_com-large-mobile-banner-1',[[300,250],[360,310],[370,390],[360,420]],'div-gpt-ad-hotexamples_com-large-mobile-banner-1-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'6355456322448089','eid':'6355456322448089','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1111','sap':'1111','a':'|251|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'18','reft':'tf','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'700','al':'1700','compid':'0','tap':'hotexamples_com-large-mobile-banner-1-6355456322448089','eb_br':'028fd4209634b3f030ec544d795c74ac','eba':'0','bv':'22','bvm':'0','bvr':'5','shp':'1','ftsn':'3','br1':'260','br2':'120','ezoic':'1','nmau':'0','mau':'0','stl':[34,13,120,38,51,0,24,20,37,30,0,31],'deal1':[20,21,22,23,24,25,26,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[18]="18";ezslots.push("ezslot_18");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-mobile-banner-1-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-mobile-banner-1-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_18";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-mobile-banner-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-mobile-banner-1-0');__ez_fad_fast('18',90,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-large-mobile-banner-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-mobile-banner-1-0');__ez_fad_fast('18',200,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-large-mobile-banner-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-mobile-banner-1-0');__ez_fad_fast('18',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-medrectangle-3-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-medrectangle-3-0';ezslot_17=googletag.defineSlot('/21732118914/hotexamples_com-medrectangle-3',[[580,400],[360,310],[430,380],[430,430]],'div-gpt-ad-hotexamples_com-medrectangle-3-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'6652471194481135','eid':'6652471194481135','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1105','sap':'1105','a':'|6|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'17','reft':'n','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'21','al':'1021','compid':'0','tap':'hotexamples_com-medrectangle-3-6652471194481135','eb_br':'8e05f6c6b0f467a340fd9f1edf21c2da','eba':'0','bv':'4','bvm':'0','bvr':'4','shp':'1','ftsn':'3','br1':'240','br2':'120','ezoic':'1','nmau':'0','mau':'0','stl':[32,34,28,66,45,122,66,27,0,30,34,31],'deal1':[20,21,22,23,24,25,26,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[17]="17";ezslots.push("ezslot_17");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-medrectangle-3-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-medrectangle-3-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_17";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-medrectangle-3-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-medrectangle-3-0');__ez_fad_fast('17',80,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-medrectangle-3-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-medrectangle-3-0');__ez_fad_fast('17',200,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-medrectangle-3-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-medrectangle-3-0');__ez_fad_fast('17',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-banner-2-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-banner-2-0';ezslot_10=googletag.defineSlot('/21732118914/hotexamples_com-banner-2',[[300,250],[360,310],[420,330],[390,420]],'div-gpt-ad-hotexamples_com-banner-2-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'4786046734443026','eid':'4786046734443026','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1131','sap':'1131','a':'|5|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'10','reft':'tf','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'31','al':'1031','compid':'0','tap':'hotexamples_com-banner-2-4786046734443026','eb_br':'2acc48f80457fdc6d4d6786673884135','eba':'0','bv':'4','bvm':'0','bvr':'4','shp':'2','ftsn':'3','br1':'280','br2':'140','ezoic':'1','nmau':'0','mau':'0','stl':[63,14,28,4,51,0,88,0,71,30,0,31],'deal1':[20,21,22,23,24,25,26,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[10]="10";ezslots.push("ezslot_10");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-banner-2-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-banner-2-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_10";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-banner-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-banner-2-0');__ez_fad_fast('10',90,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-banner-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-banner-2-0');__ez_fad_fast('10',220,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-banner-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-banner-2-0');__ez_fad_fast('10',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-leader-1-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-leader-1-0';ezslot_16=googletag.defineSlot('/21732118914/hotexamples_com-leader-1',[[300,250],[360,310],[310,370],[390,380]],'div-gpt-ad-hotexamples_com-leader-1-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'5278780064438057','eid':'5278780064438057','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1110','sap':'1110','a':'|251|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'16','reft':'tf','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'37','al':'1037','compid':'0','tap':'hotexamples_com-leader-1-5278780064438057','eb_br':'aea15b65f697c2bc2826a2d1d3e3275f','eba':'0','bv':'4','bvm':'0','bvr':'4','shp':'1','ftsn':'3','br1':'300','br2':'160','ezoic':'1','nmau':'0','mau':'0','stl':[83,0,28,38,45,122,0,20,71,30,0,31],'deal1':[21,22,23,24,25,26,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[16]="16";ezslots.push("ezslot_16");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-leader-1-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-leader-1-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_16";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-leader-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-leader-1-0');__ez_fad_fast('16',100,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-leader-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-leader-1-0');__ez_fad_fast('16',240,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-leader-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-leader-1-0');__ez_fad_fast('16',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-banner-1-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-banner-1-0';ezslot_11=googletag.defineSlot('/21732118914/hotexamples_com-banner-1',[[300,250],[360,310],[370,390],[430,390]],'div-gpt-ad-hotexamples_com-banner-1-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'7989946040456405','eid':'7989946040456405','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1108','sap':'1108','a':'|6|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'11','reft':'n','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'30','al':'1030','compid':'0','tap':'hotexamples_com-banner-1-7989946040456405','eb_br':'f63322dda53fb357fc621e718fd4fb87','eba':'0','bv':'2','bvm':'0','bvr':'6','shp':'1','ftsn':'3','br1':'450','br2':'220','ezoic':'1','nmau':'0','mau':'0','stl':[34,3,28,14,45,122,66,20,71,30,0,31],'deal1':[21,22,23,24,25,26,27,815,899,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[11]="11";ezslots.push("ezslot_11");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-banner-1-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-banner-1-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_11";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-banner-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-banner-1-0');__ez_fad_fast('11',140,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-banner-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-banner-1-0');__ez_fad_fast('11',350,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-banner-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-banner-1-0');__ez_fad_fast('11',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-medrectangle-4-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-medrectangle-4-0';ezslot_12=googletag.defineSlot('/21732118914/hotexamples_com-medrectangle-4',[[468,60],[728,90],[320,50],[234,60],[360,310],[350,350],[430,350]],'div-gpt-ad-hotexamples_com-medrectangle-4-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'3555312450428080','eid':'3555312450428080','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1106','sap':'1106','a':'|1|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'12','reft':'tf','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'22','al':'1022','compid':'0','tap':'hotexamples_com-medrectangle-4-3555312450428080','eb_br':'073dd12bd568a53b780a1e7d84a65a39','eba':'0','bv':'2','bvm':'0','bvr':'6','shp':'1','ftsn':'3','br1':'350','br2':'180','ezoic':'1','nmau':'0','mau':'0','stl':[40,168,176,27,47,122,92,20,26,156,143,31],'deal1':[21,22,23,24,25,26,27,815,899,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[12]="12";ezslots.push("ezslot_12");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-medrectangle-4-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-medrectangle-4-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_12";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-medrectangle-4-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-medrectangle-4-0');__ez_fad_fast('12',120,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-medrectangle-4-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-medrectangle-4-0');__ez_fad_fast('12',280,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-medrectangle-4-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-medrectangle-4-0');__ez_fad_fast('12',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-box-3-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-box-3-0';ezslot_15=googletag.defineSlot('/21732118914/hotexamples_com-box-3',[[728,90],[360,310],[310,330],[370,330],[370,340]],'div-gpt-ad-hotexamples_com-box-3-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'3293482734432851','eid':'3293482734432851','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1103','sap':'1103','a':'|251|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'15','reft':'n','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'2','al':'1002','compid':'0','tap':'hotexamples_com-box-3-3293482734432851','eb_br':'bb779436aa3533ea7e00abe462374b80','eba':'0','bv':'0','bvm':'1','bvr':'1','shp':'1','ftsn':'3','br1':'200','br2':'100','ezoic':'1','nmau':'0','mau':'0','stl':[82,25,176,67,51,122,89,20,26,188,143,31],'deal1':[20,21,22,23,24,25,26,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[15]="15";ezslots.push("ezslot_15");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-3-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-3-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_15";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-3-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-3-0');__ez_fad_fast('15',70,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-box-3-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-3-0');__ez_fad_fast('15',160,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-box-3-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-3-0');__ez_fad_fast('15',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-large-leaderboard-2-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-large-leaderboard-2-0';ezslot_14=googletag.defineSlot('/21732118914/hotexamples_com-large-leaderboard-2',[[300,250],[360,310],[350,350],[350,360]],'div-gpt-ad-hotexamples_com-large-leaderboard-2-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'5330720928419751','eid':'5330720928419751','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1109','sap':'1109','a':'|3|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'14','reft':'n','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'36','al':'1036','compid':'0','tap':'hotexamples_com-large-leaderboard-2-5330720928419751','eb_br':'028fd4209634b3f030ec544d795c74ac','eba':'0','bv':'0','bvm':'1','bvr':'1','shp':'1','ftsn':'3','br1':'260','br2':'120','ezoic':'1','nmau':'0','mau':'0','stl':[32,52,120,0,51,0,24,20,71,30,0,31],'deal1':[20,21,22,23,24,25,26,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[14]="14";ezslots.push("ezslot_14");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-2-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-2-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_14";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-2-0');__ez_fad_fast('14',90,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-large-leaderboard-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-2-0');__ez_fad_fast('14',200,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-large-leaderboard-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-2-0');__ez_fad_fast('14',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-box-1-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-box-1-0';ezslot_0=googletag.defineSlot('/21732118914/hotexamples_com-box-1',[[300,250],['fluid'],[360,310],[320,340],[380,390]],'div-gpt-ad-hotexamples_com-box-1-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'5133007984459990','eid':'5133007984459990','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1101','sap':'1101','a':'|5|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'0','reft':'n','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'0','al':'1000','compid':'0','tap':'hotexamples_com-box-1-5133007984459990','eb_br':'f30ba7de9e2a33f0f927ef82759eb3ce','eba':'0','bv':'4','bvm':'0','bvr':'4','shp':'3','ftsn':'3','acptad':'1','br1':'2200','br2':'1100','ezoic':'1','nmau':'4','mau':'0','stl':[32,0,28,30,45,122,66,20,71,30,0,0],'deal1':[22,23,24,25,26,27,28,29,760,761,815,816,817,818,899,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[0]="0";ezslots.push("ezslot_0");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_0";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0');__ez_fad_fast('0',750,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-box-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0');__ez_fad_fast('0',1800,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-box-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0');__ez_fad_fast('0',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-box-1-0_1']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-box-1-0_1';ezslot_1=googletag.defineSlot('/21732118914/hotexamples_com-box-1',[[300,250],['fluid'],[360,310],[320,340],[380,390]],'div-gpt-ad-hotexamples_com-box-1-0_1').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'5133007984459990','eid':'5133007984459990','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1101','sap':'1101','a':'|3|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'1','reft':'n','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'0','al':'1000','compid':'0','tap':'hotexamples_com-box-1-5133007984459990','eb_br':'f30ba7de9e2a33f0f927ef82759eb3ce','eba':'0','bv':'4','bvm':'0','bvr':'4','shp':'3','ftsn':'3','acptad':'1','br1':'2200','br2':'1100','ezoic':'1','nmau':'4','mau':'1','stl':[83,13,120,31,51,0,66,20,71,0,0,30],'deal1':[22,23,24,25,26,27,28,29,760,761,815,816,817,818,899,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[1]="1";ezslots.push("ezslot_1");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0_1']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0_1']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_1";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0_1']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0_1');__ez_fad_fast('1',750,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-box-1-0_1']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0_1');__ez_fad_fast('1',1800,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-box-1-0_1']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0_1');__ez_fad_fast('1',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-box-1-0_2']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-box-1-0_2';ezslot_2=googletag.defineSlot('/21732118914/hotexamples_com-box-1',[[300,250],['fluid'],[360,310],[320,340],[380,390]],'div-gpt-ad-hotexamples_com-box-1-0_2').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'5133007984459990','eid':'5133007984459990','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1101','sap':'1101','a':'|6|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'2','reft':'n','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'0','al':'1000','compid':'0','tap':'hotexamples_com-box-1-5133007984459990','eb_br':'f30ba7de9e2a33f0f927ef82759eb3ce','eba':'0','bv':'4','bvm':'0','bvr':'4','shp':'3','ftsn':'3','acptad':'1','br1':'2200','br2':'1100','ezoic':'1','nmau':'4','mau':'2','stl':[32,0,28,30,45,122,66,20,71,30,0,0],'deal1':[22,23,24,25,26,27,28,29,760,761,815,816,817,818,899,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[2]="2";ezslots.push("ezslot_2");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0_2']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0_2']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_2";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0_2']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0_2');__ez_fad_fast('2',750,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-box-1-0_2']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0_2');__ez_fad_fast('2',1800,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-box-1-0_2']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0_2');__ez_fad_fast('2',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-box-1-0_3']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-box-1-0_3';ezslot_3=googletag.defineSlot('/21732118914/hotexamples_com-box-1',[[300,250],['fluid'],[360,310],[320,340],[380,390]],'div-gpt-ad-hotexamples_com-box-1-0_3').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'5133007984459990','eid':'5133007984459990','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1101','sap':'1101','a':'|6|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'3','reft':'n','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'0','al':'1000','compid':'0','tap':'hotexamples_com-box-1-5133007984459990','eb_br':'f30ba7de9e2a33f0f927ef82759eb3ce','eba':'0','bv':'4','bvm':'0','bvr':'4','shp':'3','ftsn':'3','acptad':'1','br1':'2200','br2':'1100','ezoic':'1','nmau':'4','mau':'3','stl':[83,13,120,31,51,0,66,20,71,0,0,30],'deal1':[22,23,24,25,26,27,28,29,760,761,815,816,817,818,899,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[3]="3";ezslots.push("ezslot_3");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0_3']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0_3']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_3";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-1-0_3']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0_3');__ez_fad_fast('3',750,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-box-1-0_3']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0_3');__ez_fad_fast('3',1800,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-box-1-0_3']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-1-0_3');__ez_fad_fast('3',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-box-2-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-box-2-0';ezslot_13=googletag.defineSlot('/21732118914/hotexamples_com-box-2',[[728,90],[360,310],[340,410],[410,420]],'div-gpt-ad-hotexamples_com-box-2-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'8631717674465085','eid':'8631717674465085','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1141','sap':'1141','a':'|5|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'13','reft':'tf','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'1','al':'1001','compid':'0','tap':'hotexamples_com-box-2-8631717674465085','eb_br':'13817432a186231a2c8afb2cc1bac45d','eba':'0','bv':'0','bvm':'3','bvr':'1','shp':'1','ftsn':'3','acptad':'1','br1':'140','br2':'70','ezoic':'1','nmau':'0','mau':'0','stl':[34,13,28,67,45,43,66,20,32,0,13,0],'deal1':[17,20,21,22,23,24,25,26,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[13]="13";ezslots.push("ezslot_13");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-2-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-2-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_13";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-box-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-2-0');__ez_fad_fast('13',46,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-box-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-2-0');__ez_fad_fast('13',120,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-box-2-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-box-2-0');__ez_fad_fast('13',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-large-leaderboard-1-0']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-large-leaderboard-1-0';ezslot_4=googletag.defineSlot('/21732118914/hotexamples_com-large-leaderboard-1',[[300,250],['fluid'],[360,310],[430,380],[360,420]],'div-gpt-ad-hotexamples_com-large-leaderboard-1-0').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'7281648268464449','eid':'7281648268464449','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1102','sap':'1102','a':'|3|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'4','reft':'tf','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'0','al':'1035','compid':'0','tap':'hotexamples_com-large-leaderboard-1-7281648268464449','eb_br':'3991a6d8703c4b654d6670aa0aa33d85','eba':'0','bv':'13','bvm':'0','bvr':'3','shp':'3','ftsn':'3','br1':'1400','br2':'700','ezoic':'1','nmau':'4','mau':'0','stl':[82,131,207,67,155,122,88,20,71,164,175,31],'deal1':[21,22,23,24,25,26,27,28,760,815,816,817,899,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[4]="4";ezslots.push("ezslot_4");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_4";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0');__ez_fad_fast('4',450,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0');__ez_fad_fast('4',1100,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0');__ez_fad_fast('4',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1';ezslot_5=googletag.defineSlot('/21732118914/hotexamples_com-large-leaderboard-1',[[300,250],['fluid'],[360,310],[430,380],[360,420]],'div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'7281648268464449','eid':'7281648268464449','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1102','sap':'1102','a':'|2|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'5','reft':'tf','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'0','al':'1035','compid':'0','tap':'hotexamples_com-large-leaderboard-1-7281648268464449','eb_br':'3991a6d8703c4b654d6670aa0aa33d85','eba':'0','bv':'13','bvm':'0','bvr':'3','shp':'3','ftsn':'3','br1':'1400','br2':'700','ezoic':'1','nmau':'4','mau':'1','stl':[83,13,120,67,51,0,66,20,71,30,0,31],'deal1':[21,22,23,24,25,26,27,28,760,815,816,817,899,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[5]="5";ezslots.push("ezslot_5");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_5";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1');__ez_fad_fast('5',450,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1');__ez_fad_fast('5',1100,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1');__ez_fad_fast('5',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2';ezslot_6=googletag.defineSlot('/21732118914/hotexamples_com-large-leaderboard-1',[[300,250],['fluid'],[360,310],[430,380],[360,420]],'div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'7281648268464449','eid':'7281648268464449','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1102','sap':'1102','a':'|6|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'6','reft':'tf','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'0','al':'1035','compid':'0','tap':'hotexamples_com-large-leaderboard-1-7281648268464449','eb_br':'3991a6d8703c4b654d6670aa0aa33d85','eba':'0','bv':'13','bvm':'0','bvr':'3','shp':'3','ftsn':'3','br1':'1400','br2':'700','ezoic':'1','nmau':'4','mau':'2','stl':[34,0,28,4,45,122,66,20,71,30,0,31],'deal1':[21,22,23,24,25,26,27,28,760,815,816,817,899,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[6]="6";ezslots.push("ezslot_6");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_6";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2');__ez_fad_fast('6',450,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2');__ez_fad_fast('6',1100,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2');__ez_fad_fast('6',0,0);};__ez_fad_initslot['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3']=function(bvr){googletag.cmd.push(function(){var did='div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3';ezslot_7=googletag.defineSlot('/21732118914/hotexamples_com-large-leaderboard-1',[[300,250],['fluid'],[360,310],[430,380],[360,420]],'div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3').addService(googletag.pubads()).updateTargetingFromMap({'a':'1','iid1':'7281648268464449','eid':'7281648268464449','t':'134','d':'110793','t1':'134','pvc':'0','ap':'1102','sap':'1102','a':'|1|','as':'revenue','plat':'1','bra':'mod31-c','ic':'1','at':'mbf','adr':'399','ezosn':'7','reft':'tf','refs':'30','ga':'5302779','gala':'','rid':'99998','pt':'0','al':'1035','compid':'0','tap':'hotexamples_com-large-leaderboard-1-7281648268464449','eb_br':'3991a6d8703c4b654d6670aa0aa33d85','eba':'0','bv':'13','bvm':'0','bvr':'3','shp':'3','ftsn':'3','br1':'1400','br2':'700','ezoic':'1','nmau':'4','mau':'3','stl':[83,13,120,67,51,0,66,20,71,30,0,31],'deal1':[21,22,23,24,25,26,27,28,760,815,816,817,899,919,774],'ax_ssid':'10082'}).setCollapseEmptyDiv(false);ezrpos[7]="7";ezslots.push("ezslot_7");if(bvr!=null){if(typeof __ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3']=='function'){__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3']();}}
if(typeof ezSlotKVStore!='undefined'&&typeof ezSlotKVStore[did]!='undefined'){for(var name in ezSlotKVStore[did]){if(!ezSlotKVStore.hasOwnProperty(name)){ezSetSlotTargeting(did,name,ezSlotKVStore[did][name]);}}
ezSlotKVStore[did]={};}});return "ezslot_7";};__ez_fad_fastslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3');__ez_fad_fast('7',450,null);};__ez_fad_viewslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3');__ez_fad_fast('7',1100,null);};__ez_fad_instaslots['div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3']=function(){__ez_fad_fastdiv.push('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3');__ez_fad_fast('7',0,0);};</script><script data-dapp-detection="">!function(){let e=!1;function n(){if(!e){const n=document.createElement("meta");n.name="dapp-detected",document.head.appendChild(n),e=!0}}if(window.hasOwnProperty("ethereum")){if(window.__disableDappDetectionInsertion=!0,void 0===window.ethereum)return;n()}else{var t=window.ethereum;Object.defineProperty(window,"ethereum",{configurable:!0,enumerable:!1,set:function(e){window.__disableDappDetectionInsertion||n(),t=e},get:function(){if(!window.__disableDappDetectionInsertion){const e=arguments.callee;e&&e.caller&&e.caller.toString&&-1!==e.caller.toString().indexOf("getOwnPropertyNames")||n()}return t}})}}();</script><script ez-screx="true">(function(){function storageAvailable(type){var storage;try{storage=window[type];var x='__storage_test__';storage.setItem(x,x);storage.removeItem(x);return true;}
catch(e){return e instanceof DOMException&&(e.code===22||e.code===1014||e.name==='QuotaExceededError'||e.name==='NS_ERROR_DOM_QUOTA_REACHED')&&(storage&&storage.length!==0);}}
function remove_ama_config(){if(storageAvailable('localStorage')){localStorage.removeItem("google_ama_config");}}
remove_ama_config()})()</script><script data-ezscrex="false" data-cfasync="false">__ez.ssaf=[17,19,16];__ez.sswp=4;__ez.ssv=116299;__ez.sshsdef=false;</script><script>var ezoicTestActive=true</script><script data-ezscrex="false" data-cfasync="false">var _ezaq={"ad_cache_level":1,"ad_count_adjustment":3,"ad_lazyload_version":4,"ad_load_version":2,"ad_location_ids":"0,0,0,0,35,35,35,35,34,3,31,30,22,1,36,2,37,21,700","ad_transform_level":0,"adx_ad_count":19,"bidder_method":1,"bidder_version":5,"city":"Saint-Denis","country":"FR","days_since_last_visit":-1,"display_ad_count":13,"domain_id":110793,"domain_test_group":20210303,"ds_adsize_opt_id":-1,"engaged_time_visit":0,"ezcache_level":2,"ezcache_skip_code":0,"form_factor_id":1,"framework_id":1,"has_bad_image":0,"has_bad_words":0,"iab_category":"","iab_category_0":"596","is_from_recommended_pages":false,"is_return_visitor":false,"is_sitespeed":1,"last_page_load":"","last_pageview_id":"","lt_cache_level":0,"max_ads":30,"metro_code":0,"optimization_version":1,"page_ad_positions":"1101,1101,1101,1101,1102,1102,1102,1102,1103,1105,1106,1107,1108,1109,1110,1111,1117,1131,1141","page_view_count":0,"page_view_id":"ba6b9e4a-2fe5-4554-4fd2-dd3f475f90e8","position_selection_id":39,"postal_code":"93200","pv_event_count":0,"response_size_orig":215804,"response_time_orig":85,"serverid":"18.185.103.85:29028","state":"93","sub_page_ad_positions":"1101,1101,1101,1101,1102,1102,1102,1102,1103,1105,1106,1107,1108,1109,1110,1111,1117,1131,1141","t_epoch":1628331367,"template_id":134,"time_on_site_visit":0,"url":"https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html","user_id":0,"word_count":10340,"worst_bad_word_level":1};var _ezim_d={"hotexamples_com-banner-1":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-banner-1/2021-08-07/7989946040456405","height":"250","position_id":1108,"sub_position_id":1108,"width":"300"},"hotexamples_com-banner-2":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-banner-2/2021-08-07/4786046734443026","height":"250","position_id":1131,"sub_position_id":1131,"width":"300"},"hotexamples_com-box-1":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-box-1/2021-08-07/5133007984459990","height":"250v4","position_id":1101,"sub_position_id":1101,"width":"300"},"hotexamples_com-box-1_1":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-box-1/2021-08-07/5133007984459990","height":"250v4","position_id":1101,"sub_position_id":1101,"width":"300"},"hotexamples_com-box-1_2":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-box-1/2021-08-07/5133007984459990","height":"250v4","position_id":1101,"sub_position_id":1101,"width":"300"},"hotexamples_com-box-1_3":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-box-1/2021-08-07/5133007984459990","height":"250v4","position_id":1101,"sub_position_id":1101,"width":"300"},"hotexamples_com-box-2":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-box-2/2021-08-07/8631717674465085","height":"90","position_id":1141,"sub_position_id":1141,"width":"728"},"hotexamples_com-box-3":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-box-3/2021-08-07/3293482734432851","height":"90","position_id":1103,"sub_position_id":1103,"width":"728"},"hotexamples_com-box-4":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-box-4/2021-08-07/4276099776420525","height":"250","position_id":1107,"sub_position_id":1107,"width":"300"},"hotexamples_com-large-billboard-2":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-large-billboard-2/2021-08-07/176351068453565","height":"250","position_id":1117,"sub_position_id":1117,"width":"250"},"hotexamples_com-large-leaderboard-1":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-large-leaderboard-1/2021-08-07/7281648268464449","height":"250v4","position_id":1102,"sub_position_id":1102,"width":"300"},"hotexamples_com-large-leaderboard-1_1":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-large-leaderboard-1/2021-08-07/7281648268464449","height":"250v4","position_id":1102,"sub_position_id":1102,"width":"300"},"hotexamples_com-large-leaderboard-1_2":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-large-leaderboard-1/2021-08-07/7281648268464449","height":"250v4","position_id":1102,"sub_position_id":1102,"width":"300"},"hotexamples_com-large-leaderboard-1_3":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-large-leaderboard-1/2021-08-07/7281648268464449","height":"250v4","position_id":1102,"sub_position_id":1102,"width":"300"},"hotexamples_com-large-leaderboard-2":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-large-leaderboard-2/2021-08-07/5330720928419751","height":"250","position_id":1109,"sub_position_id":1109,"width":"300"},"hotexamples_com-large-mobile-banner-1":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-large-mobile-banner-1/2021-08-07/6355456322448089","height":"250","position_id":1111,"sub_position_id":1111,"width":"300"},"hotexamples_com-leader-1":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-leader-1/2021-08-07/5278780064438057","height":"250","position_id":1110,"sub_position_id":1110,"width":"300"},"hotexamples_com-medrectangle-3":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-medrectangle-3/2021-08-07/6652471194481135","height":"400","position_id":1105,"sub_position_id":1105,"width":"580"},"hotexamples_com-medrectangle-4":{"adsense_stat_source_id":5,"adx_ad_count":19,"adx_stat_source_id":35,"full_id":"hotexamples_com-medrectangle-4/2021-08-07/3555312450428080","height":"60","position_id":1106,"sub_position_id":1106,"width":"468"}};var _ezat={"domain_id":110793,"form_factor_id":1,"framework_id":1,"pageview_date":"2021-08-07","pageview_id":"ba6b9e4a-2fe5-4554-4fd2-dd3f475f90e8","template_id":134,"url":"https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html","visit_uuid":"90c9b814-de4a-442c-7d2f-2dd17030f330"};</script><script data-ezscrex="false" data-pagespeed-no-defer="" data-cfasync="false">__ez.queue.addFile('banger.js','/porpoiseant/banger.js?cb=195-2&bv=51&v=51&PageSpeed=off',true,[],true,false,false,true);</script><script src="./C++ (Cpp) poll Exemples - HotExamples_files/banger.js" async=""></script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">__ez.vep=(function(){var pixels=[],pxURL="/detroitchicago/grapefruit.gif";function AddPixel(vID,pixelData){if(__ez.dot.isDefined(vID)&&__ez.dot.isValid(pixelData)){pixels.push({type:'video',video_impression_id:vID,domain_id:__ez.dot.getDID(),t_epoch:__ez.dot.getEpoch(0),data:__ez.dot.dataToStr(pixelData)});}}
function Fire(){if(typeof document.visibilityState!=='undefined'&&document.visibilityState==="prerender"){return;}
if(__ez.dot.isDefined(pixels)&&pixels.length>0){while(pixels.length>0){var j=5;if(j>pixels.length){j=pixels.length;}
var pushPixels=pixels.splice(0,j);var pixelURL=__ez.dot.getURL(pxURL)+"?orig="+(__ez.template.isOrig===true?1:0)+"&v="+btoa(JSON.stringify(pushPixels));__ez.dot.Fire(pixelURL);}}
pixels=[];}
return{Add:AddPixel,Fire:Fire};})();</script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">__ez.pel=(function(){var pixels=[],pxURL="/porpoiseant/army.gif";function AddAndFirePixel(adSlot,pixelData){AddPixel(adSlot,pixelData,0,0,0,0,0);Fire();}
function AddAndFireOrigPixel(adSlot,pixelData){AddPixel(adSlot,pixelData,0,0,0,0,0,true);Fire();}
function GetCurrentPixels(){return pixels;}
function AddPixel(adSlot,pixelData,revenue,est_revenue,bid_floor_filled,bid_floor_prev,stat_source_id,isOrig){if(!__ez.dot.isDefined(adSlot)||__ez.dot.isAnyDefined(adSlot.getSlotElementId,adSlot.ElementId)==false){return;}
var ad_position_id=parseInt(__ez.dot.getTargeting(adSlot,'ap'));var impId=__ez.dot.getSlotIID(adSlot),adUnit=__ez.dot.getAdUnit(adSlot,isOrig);var compId=parseInt(__ez.dot.getTargeting(adSlot,"compid"));var lineItemId=0;var creativeId=0;var ezimData=getEzimData(adSlot);if(typeof ezimData=='object'){if(ezimData.creative_id!==undefined){creativeId=ezimData.creative_id;}
if(ezimData.line_item_id!==undefined){lineItemId=ezimData.line_item_id;}}
if(__ez.dot.isDefined(impId,adUnit)&&__ez.dot.isValid(pixelData)){pixels.push({type:"impression",impression_id:impId,domain_id:__ez.dot.getDID(),unit:adUnit,t_epoch:__ez.dot.getEpoch(0),revenue:revenue,est_revenue:est_revenue,ad_position:ad_position_id,ad_size:"",bid_floor_filled:bid_floor_filled,bid_floor_prev:bid_floor_prev,stat_source_id:stat_source_id,country_code:__ez.dot.getCC(),pageview_id:__ez.dot.getPageviewId(),comp_id:compId,line_item_id:lineItemId,creative_id:creativeId,data:__ez.dot.dataToStr(pixelData),is_orig:isOrig||__ez.template.isOrig,});}}
function AddPixelById(impFullId,pixelData,isOrig){var vals=impFullId.split('/');if(__ez.dot.isDefined(impFullId)&&vals.length===3&&__ez.dot.isValid(pixelData)){var adUnit=vals[0],impId=vals[2];pixels.push({type:"impression",impression_id:impId,domain_id:__ez.dot.getDID(),unit:adUnit,t_epoch:__ez.dot.getEpoch(0),pageview_id:__ez.dot.getPageviewId(),data:__ez.dot.dataToStr(pixelData),is_orig:isOrig||__ez.template.isOrig});}}
function Fire(){if(typeof document.visibilityState!=='undefined'&&document.visibilityState==="prerender")return;if(__ez.dot.isDefined(pixels)&&pixels.length>0){var allPixels=[pixels.filter(function(pixel){return pixel.is_orig}),pixels.filter(function(pixel){return!pixel.is_orig})];allPixels.forEach(function(pixels){while(pixels.length>0){var isOrig=pixels[0].is_orig||false;var j=5;if(j>pixels.length){j=pixels.length;}
var pushPixels=pixels.splice(0,j);var pixelURL=__ez.dot.getURL(pxURL)+"?orig="+(isOrig===true?1:0)+"&sts="+btoa(JSON.stringify(pushPixels));if(typeof window.isAmp!=='undefined'&&isAmp&&typeof window._ezaq!=='undefined'&&_ezaq.hasOwnProperty("domain_id")){pixelURL+="&visit_uuid="+_ezaq['visit_uuid'];}
__ez.dot.Fire(pixelURL);}})}
pixels=[];}
function getEzimData(adSlot){if(typeof _ezim_d=="undefined"){return false}
var adUnitName=__ez.dot.getAdUnitPath(adSlot).split('/').pop();if(typeof _ezim_d==='object'&&_ezim_d.hasOwnProperty(adUnitName)){return _ezim_d[adUnitName];}
for(var ezimKey in _ezim_d){if(ezimKey.split('/').pop()===adUnitName){return _ezim_d[ezimKey];}}
return false;}
return{Add:AddPixel,AddAndFire:AddAndFirePixel,AddAndFireOrig:AddAndFireOrigPixel,AddById:AddPixelById,Fire:Fire,GetPixels:GetCurrentPixels,};})();</script><link rel="preconnect" href="https://c.amazon-adsystem.com/" crossorigin=""><link rel="preconnect" href="https://cpp.hotexamples.com/" crossorigin=""><link rel="preconnect" href="https://csharp.hotexamples.com/" crossorigin=""><link rel="preconnect" href="https://golang.hotexamples.com/" crossorigin=""><link rel="preconnect" href="https://java.hotexamples.com/" crossorigin=""><link rel="preconnect" href="https://python.hotexamples.com/" crossorigin=""><link rel="preconnect" href="https://securepubads.g.doubleclick.net/" crossorigin=""><link rel="preconnect" href="https://ajax.googleapis.com/" crossorigin=""><link rel="preconnect" href="https://typescript.hotexamples.com/" crossorigin=""><link rel="preconnect" href="https://www.googletagmanager.com/" crossorigin=""><link rel="preconnect" href="https://javascript.hotexamples.com/" crossorigin=""><link rel="preconnect" href="https://pagead2.googlesyndication.com/" crossorigin=""><link rel="preconnect" href="https://go.ezoic.net/" crossorigin=""><style class="ezcritcss">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}figure,nav{display:block}a{background-color:initial}strong{font-weight:700}h1{font-size:2em;margin:.67em 0}figure{margin:1em 40px}pre{overflow:auto}pre{font-family:monospace,monospace;font-size:1em}button,input{color:inherit;font:inherit;margin:0}button{overflow:visible}button{text-transform:none}button{-webkit-appearance:button}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}:before,:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}html{font-size:10px}body{font-family:helvetica neue,Helvetica,Arial,sans-serif;font-size:14px;line-height:1.42857143;color:#333;background-color:#fff}input,button{font-family:inherit;font-size:inherit;line-height:inherit}a{color:#337ab7;text-decoration:none}figure{margin:0}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}h1{font-family:inherit;font-weight:500;line-height:1.1;color:inherit}h1{margin-top:20px;margin-bottom:10px}h1{font-size:36px}ul{margin-top:0;margin-bottom:10px}ul ul{margin-bottom:0}.container{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:768px){.container{width:750px}}@media(min-width:992px){.container{width:970px}}@media(min-width:1200px){.container{width:1170px}}.col-sm-9,.col-md-9,.col-lg-9{position:relative;min-height:1px;padding-right:15px;padding-left:15px}@media(min-width:768px){.col-sm-9{float:left}.col-sm-9{width:75%}}@media(min-width:992px){.col-md-9{float:left}.col-md-9{width:75%}}@media(min-width:1200px){.col-lg-9{float:left}.col-lg-9{width:75%}}.form-control{display:block;width:100%;height:34px;padding:6px 12px;font-size:14px;line-height:1.42857143;color:#555;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.form-control:focus{border-color:#66afe9;outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}.form-control::-moz-placeholder{color:#999;opacity:1}.form-control:-ms-input-placeholder{color:#999}.form-control::-webkit-input-placeholder{color:#999}.form-control::-ms-expand{background-color:initial;border:0}.btn{display:inline-block;margin-bottom:0;font-weight:400;text-align:center;white-space:nowrap;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;background-image:none;border:1px solid transparent;padding:6px 12px;font-size:14px;line-height:1.42857143;border-radius:4px}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-primary{color:#fff;background-color:#337ab7;border-color:#2e6da4}.btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.collapse{display:none}.caret{display:inline-block;width:0;height:0;margin-left:2px;vertical-align:middle;border-top:4px dashed;border-top:4px solid \9;border-right:4px solid transparent;border-left:4px solid transparent}.dropdown{position:relative}.dropdown-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;font-size:14px;text-align:left;list-style:none;background-color:#fff;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #ccc;border:1px solid rgba(0,0,0,.15);border-radius:4px;-webkit-box-shadow:0 6px 12px rgba(0,0,0,.175);box-shadow:0 6px 12px rgba(0,0,0,.175)}.dropdown-menu>li>a{display:block;padding:3px 20px;clear:both;font-weight:400;line-height:1.42857143;color:#333;white-space:nowrap}@media(min-width:768px){.navbar-right .dropdown-menu{right:0;left:auto}}.btn .caret{margin-left:0}.input-group{position:relative;display:table;border-collapse:separate}.input-group .form-control{position:relative;z-index:2;float:left;width:100%;margin-bottom:0}.input-group .form-control:focus{z-index:3}.input-group-btn,.input-group .form-control{display:table-cell}.input-group .form-control:not(:first-child):not(:last-child){border-radius:0}.input-group-btn{width:1%;white-space:nowrap;vertical-align:middle}.input-group-btn:first-child>.btn,.input-group-btn:first-child>.dropdown-toggle{border-top-right-radius:0;border-bottom-right-radius:0}.input-group-btn:last-child>.btn{border-top-left-radius:0;border-bottom-left-radius:0}.input-group-btn{position:relative;font-size:0;white-space:nowrap}.input-group-btn>.btn{position:relative}.input-group-btn:first-child>.btn{margin-right:-1px}.input-group-btn:last-child>.btn{z-index:2;margin-left:-1px}.nav{padding-left:0;margin-bottom:0;list-style:none}.nav>li{position:relative;display:block}.nav>li>a{position:relative;display:block;padding:10px 15px}.navbar{position:relative;min-height:50px;margin-bottom:20px;border:1px solid transparent}@media(min-width:768px){.navbar{border-radius:4px}}@media(min-width:768px){.navbar-header{float:left}}.navbar-collapse{padding-right:15px;padding-left:15px;overflow-x:visible;border-top:1px solid transparent;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.1);box-shadow:inset 0 1px rgba(255,255,255,.1);-webkit-overflow-scrolling:touch}@media(min-width:768px){.navbar-collapse{width:auto;border-top:0;-webkit-box-shadow:none;box-shadow:0 0}.navbar-collapse.collapse{display:block!important;height:auto!important;padding-bottom:0;overflow:visible!important}.navbar-fixed-top .navbar-collapse{padding-right:0;padding-left:0}}.navbar-fixed-top{position:fixed;right:0;left:0;z-index:1030}.navbar-fixed-top .navbar-collapse{max-height:340px}@media(min-width:768px){.navbar-fixed-top{border-radius:0}}.navbar-fixed-top{top:0;border-width:0 0 1px}.container>.navbar-header,.container>.navbar-collapse{margin-right:-15px;margin-left:-15px}@media(min-width:768px){.container>.navbar-header,.container>.navbar-collapse{margin-right:0;margin-left:0}}.navbar-brand{float:left;height:50px;padding:15px;font-size:18px;line-height:20px}@media(min-width:768px){.navbar>.container .navbar-brand{margin-left:-15px}}.navbar-toggle{position:relative;float:right;padding:9px 10px;margin-right:15px;margin-top:8px;margin-bottom:8px;background-color:initial;background-image:none;border:1px solid transparent;border-radius:4px}.navbar-toggle .icon-bar{display:block;width:22px;height:2px;border-radius:1px}.navbar-toggle .icon-bar+.icon-bar{margin-top:4px}@media(min-width:768px){.navbar-toggle{display:none}}.navbar-nav{margin:7.5px -15px}.navbar-nav>li>a{padding-top:10px;padding-bottom:10px;line-height:20px}@media(min-width:768px){.navbar-nav{float:left;margin:0}.navbar-nav>li{float:left}.navbar-nav>li>a{padding-top:15px;padding-bottom:15px}}.navbar-form{padding:10px 15px;margin-right:-15px;margin-left:-15px;border-top:1px solid transparent;border-bottom:1px solid transparent;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.1),0 1px 0 rgba(255,255,255,.1);box-shadow:inset 0 1px 0 rgba(255,255,255,.1),0 1px 0 rgba(255,255,255,.1);margin-top:8px;margin-bottom:8px}@media(min-width:768px){.navbar-form .form-control{display:inline-block;width:auto;vertical-align:middle}.navbar-form .input-group{display:inline-table;vertical-align:middle}.navbar-form .input-group .input-group-btn,.navbar-form .input-group .form-control{width:auto}.navbar-form .input-group>.form-control{width:100%}}@media(min-width:768px){.navbar-form{width:auto;padding-top:0;padding-bottom:0;margin-right:0;margin-left:0;border:0;-webkit-box-shadow:none;box-shadow:0 0}}.navbar-nav>li>.dropdown-menu{margin-top:0;border-top-left-radius:0;border-top-right-radius:0}@media(min-width:768px){.navbar-right{float:right!important;margin-right:-15px}}.navbar-inverse{background-color:#222;border-color:#080808}.navbar-inverse .navbar-brand{color:#9d9d9d}.navbar-inverse .navbar-nav>li>a{color:#9d9d9d}.navbar-inverse .navbar-toggle{border-color:#333}.navbar-inverse .navbar-toggle .icon-bar{background-color:#fff}.navbar-inverse .navbar-collapse,.navbar-inverse .navbar-form{border-color:#101010}.panel{margin-bottom:20px;background-color:#fff;border:1px solid transparent;border-radius:4px;-webkit-box-shadow:0 1px 1px rgba(0,0,0,5%);box-shadow:0 1px 1px rgba(0,0,0,5%)}.container:before,.container:after,.nav:before,.nav:after,.navbar:before,.navbar:after,.navbar-header:before,.navbar-header:after,.navbar-collapse:before,.navbar-collapse:after{display:table;content:" "}.container:after,.nav:after,.navbar:after,.navbar-header:after,.navbar-collapse:after{clear:both}@-ms-viewport{width:device-width}@media(max-width:767px){.hidden-xs{display:none!important}}@media(min-width:768px) and (max-width:991px){.hidden-sm{display:none!important}}@media(min-width:992px) and (max-width:1199px){.hidden-md{display:none!important}}@media(min-width:1440px){.page-container-with-fixed-sidebar300px{width:1095px}}figure.panel{text-overflow:ellipsis;white-space:nowrap}@media(max-width:767px){h1{font-size:26px;overflow:hidden;text-overflow:ellipsis}}.example-info-table{margin-top:10px}.example-info-table span{font-weight:700}.example-info-table>div{margin-bottom:5px;overflow-x:hidden;text-overflow:ellipsis}.examples-description-container{display:flex}.examples-description-container>div{margin-right:10px}.page-container{overflow:auto}.page-content-container{display:flex}.page-content-container>div{margin-right:10px}.page-content-container>div:last-child{margin-right:0}@media(max-width:1199px){.page-content-container>div{margin-right:0}}.main-content{width:100%;overflow:hidden}.sidebar{min-width:160px;flex-shrink:0}.page-side-banner{flex-shrink:0;margin-left:15px;margin-right:0;display:none}@media(min-width:1330px){.container{width:1330px}}@media(min-width:1440px){.container{width:1440px}.page-side-banner{display:block}}html,body{height:100%}.wrap{min-height:100%;height:auto;margin:0 auto -60px;padding:0 0 60px}.wrap>.container{padding:70px 15px 20px}.examples-description{text-overflow:ellipsis;overflow:hidden}.bs-example{border-color:#e5e5e5 #eee #eee;border-style:solid;border-width:1px 0;box-shadow:0 3px 6px rgba(0,0,0,5%)inset;margin-left:0;margin-right:0;margin-bottom:15px;padding:45px 15px 15px;position:relative;background-color:#f0f0f0;border:1px #ddd}.bs-example-title{color:#959595;font-size:12px;font-weight:700;left:15px;letter-spacing:1px;position:absolute;text-transform:uppercase;top:15px}.bs-example+.highlight{margin:-15px -15px 15px;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-width:1px;margin-left:0;margin-right:0}.example-project-info{display:block;margin:5px 0;overflow-x:hidden}.example-project-info span{font-weight:700}.example-project-info nobr{display:inline-block}.example-project-info nobr:nth-child(1){padding-top:10px;padding-bottom:10px;margin-right:10px}@media(min-width:768px){.example-project-info{display:inline-block}.example-project-info nobr{margin-right:10px}.bs-example{background-color:#f0f0f0;border-radius:4px 4px 0 0;border:1px #ddd;box-shadow:0 0;margin-left:0;margin-right:0}.bs-example+.highlight{border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-width:1px;margin-left:0;margin-right:0}}.bs-example.thin{padding-top:30px;display:block}.highlight{background-color:#f7f7f9;border:1px solid #e1e1e8;border-radius:4px;margin-bottom:14px}.container:before{display:block!important}.highlight.panel{padding:5px 10px}.example-item{margin-top:15px}.example-item .rating-amount{vertical-align:middle;display:inline-block;font-size:1.5em;width:30px;text-align:center}.navbar{margin-bottom:0!important}.clear{width:1px!important}.navbar-form .input-group{width:100%}.navbar-collapse{max-height:100%!important}.icon-button{display:inline-block;width:16px;height:20px;vertical-align:middle}.highlight.panel{border:1px solid #e1e1e8;border-radius:4px}.example pre{border:0;border-radius:0;margin:0;background:#fff!important}pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,andale mono,ubuntu mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;overflow:auto}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}</style><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="" src="./C++ (Cpp) poll Exemples - HotExamples_files/cash.js"></script><link rel="preload" href="./C++ (Cpp) poll Exemples - HotExamples_files/gpt.js" as="script"><link rel="preload" href="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" as="script"><link rel="preload" href="./C++ (Cpp) poll Exemples - HotExamples_files/apstag.js" as="script"><script async="" src="./C++ (Cpp) poll Exemples - HotExamples_files/js"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-140811786-1');</script><meta name="yandex-verification" content="20304c916f21f7f7"><meta name="viewport" content="width=device-width,initial-scale=1"><title>C++ (Cpp) poll Exemples - HotExamples</title><meta name="keywords" content="C++ (Cpp),code,examples,,,,,poll,0"><meta name="description" content="C++ (Cpp) poll - 30 exemples trouvés. Ce sont les exemples réels les mieux notés de poll extraits de projets open source. Vous pouvez noter les exemples pour nous aider à en améliorer la qualité."><link href="./C++ (Cpp) poll Exemples - HotExamples_files/0d59035a7b51a27bb7256ffc19791588f9efb496.css" rel="stylesheet" as="style" onload="this.onload=null;this.rel=&#39;stylesheet&#39;"><noscript><link href="https://cdn-0.hotexamples.com/assets/0d59035a7b51a27bb7256ffc19791588f9efb496.css?ff=1&wps=true" rel=stylesheet></noscript><link rel="alternate" hreflang="en" href="https://cpp.hotexamples.com/examples/-/-/poll/cpp-poll-function-examples.html"><link rel="canonical" href="https://cpp.hotexamples.com/examples/-/-/poll/cpp-poll-function-examples.html"><link rel="alternate" hreflang="ru" href="https://cpp.hotexamples.com/ru/examples/-/-/poll/cpp-poll-function-examples.html"><link rel="alternate" hreflang="de" href="https://cpp.hotexamples.com/de/examples/-/-/poll/cpp-poll-function-examples.html"><link rel="alternate" hreflang="es" href="https://cpp.hotexamples.com/es/examples/-/-/poll/cpp-poll-function-examples.html"><link rel="alternate" hreflang="pt" href="https://cpp.hotexamples.com/pt/examples/-/-/poll/cpp-poll-function-examples.html"><link rel="alternate" hreflang="it" href="https://cpp.hotexamples.com/it/examples/-/-/poll/cpp-poll-function-examples.html"><link rel="alternate" hreflang="jp" href="https://cpp.hotexamples.com/jp/examples/-/-/poll/cpp-poll-function-examples.html"><link rel="alternate" hreflang="zh" href="https://cpp.hotexamples.com/zh/examples/-/-/poll/cpp-poll-function-examples.html"><link rel="apple-touch-icon" sizes="180x180" href="https://cpp.hotexamples.com/images/cpp/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://cpp.hotexamples.com/images/cpp/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://cpp.hotexamples.com/images/cpp/favicon-16x16.png"><link rel="manifest" href="https://cpp.hotexamples.com/images/cpp/site.webmanifest"><link rel="mask-icon" href="https://cpp.hotexamples.com/images/cpp/safari-pinned-tab.svg" color="#5bbad5"><link rel="shortcut icon" href="https://cpp.hotexamples.com/images/cpp/favicon.ico"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-config" content="/images/cpp/browserconfig.xml"><meta name="theme-color" content="#ffffff"><style>.ezoic-ad.box-2141{display:block!important;float:none;line-height:0;margin-bottom:15px!important;margin-left:0!important;margin-right:0!important;margin-top:15px!important;min-height:90px;min-width:728px;padding:0;text-align:center!important}.ezoic-ad.box-3103{display:block!important;float:none!important;line-height:0;margin-bottom:20px!important;margin-left:0!important;margin-right:0!important;margin-top:20px!important;min-height:90px;min-width:728px;padding:0;text-align:center!important}.ezoic-ad.medrectangle-3105{display:block!important;float:none!important;line-height:0;margin-bottom:2px!important;margin-left:0!important;margin-right:0!important;margin-top:2px!important;min-height:400px;min-width:580px;padding:0;text-align:center!important}.ezoic-ad.box-1{border:none!important;display:inline-block;float:none;line-height:0;margin-bottom:0!important;margin-left:0!important;margin-right:0!important;margin-top:0!important;min-height:250px;min-width:300px;padding:0}.ezoic-ad.box-1{border:none!important;display:inline-block;float:none;line-height:0;margin-bottom:0!important;margin-left:0!important;margin-right:0!important;margin-top:0!important;min-height:250px;min-width:300px;padding:0}.ezoic-ad.box-1{border:none!important;display:inline-block;float:none;line-height:0;margin-bottom:0!important;margin-left:0!important;margin-right:0!important;margin-top:0!important;min-height:250px;min-width:300px;padding:0}.ezoic-ad.box-1{border:none!important;display:inline-block;float:none;line-height:0;margin-bottom:0!important;margin-left:0!important;margin-right:0!important;margin-top:0!important;min-height:250px;min-width:300px;padding:0}.ezoic-ad.box-1101{background:0 0!important;display:block!important;float:none;line-height:0;margin-left:0!important;margin-right:0!important;min-width:300px;padding:0;width:300px}.ezoic-ad.large-leaderboard-1{border:none!important;display:inline-block;float:none!important;line-height:0;margin-bottom:0!important;margin-left:0!important;margin-right:0!important;margin-top:0!important;min-height:250px;min-width:300px;padding:0}.ezoic-ad.large-leaderboard-1{border:none!important;display:inline-block;float:none!important;line-height:0;margin-bottom:0!important;margin-left:0!important;margin-right:0!important;margin-top:0!important;min-height:250px;min-width:300px;padding:0}.ezoic-ad.large-leaderboard-1{border:none!important;display:inline-block;float:none!important;line-height:0;margin-bottom:0!important;margin-left:0!important;margin-right:0!important;margin-top:0!important;min-height:250px;min-width:300px;padding:0}.ezoic-ad.large-leaderboard-1{border:none!important;display:inline-block;float:none!important;line-height:0;margin-bottom:0!important;margin-left:0!important;margin-right:0!important;margin-top:0!important;min-height:250px;min-width:300px;padding:0}.ezoic-ad.large-leaderboard-1102{background:0 0!important;display:block!important;float:none!important;line-height:0;margin-left:0!important;margin-right:0!important;min-width:300px;padding:0;width:300px}.ezoic-ad.large-billboard-2117{display:inline-block;float:none!important;line-height:0;margin-bottom:2px!important;margin-left:0!important;margin-right:0!important;margin-top:2px!important;min-height:600px;min-width:300px;padding:0}.ezoic-ad.medrectangle-4106{display:block!important;float:none;line-height:0;margin-bottom:30px!important;margin-left:0!important;margin-right:0!important;margin-top:30px!important;min-height:90px;min-width:728px;padding:0;text-align:center!important}.ezoic-ad.box-4107{display:block!important;float:none!important;line-height:0;margin-bottom:15px!important;margin-left:0!important;margin-right:0!important;margin-top:15px!important;min-height:250px;min-width:300px;padding:0;text-align:center!important}.ezoic-ad.banner-1108{display:block!important;float:none;line-height:0;margin-bottom:15px!important;margin-left:0!important;margin-right:0!important;margin-top:15px!important;min-height:250px;min-width:300px;padding:0;text-align:center!important}.ezoic-ad.large-leaderboard-2109{display:block!important;float:none;line-height:0;margin-bottom:15px!important;margin-left:0!important;margin-right:0!important;margin-top:15px!important;min-height:250px;min-width:300px;padding:0;text-align:center!important}.ezoic-ad.leader-1110{display:block!important;float:none!important;line-height:0;margin-bottom:15px!important;margin-left:0!important;margin-right:0!important;margin-top:15px!important;min-height:250px;min-width:300px;padding:0;text-align:center!important}.ezoic-ad.large-mobile-banner-1111{display:block!important;float:none;line-height:0;margin-bottom:15px!important;margin-left:0!important;margin-right:0!important;margin-top:15px!important;min-height:250px;min-width:300px;padding:0;text-align:center!important}.ezoic-ad.banner-2131{display:inline-block;float:none!important;line-height:0;margin-bottom:2px!important;margin-left:0!important;margin-right:0!important;margin-top:2px!important;min-height:250px;min-width:300px;padding:0}.ezoic-ad{display:inline-block;border:0}.ezoic-ad>div>iframe{margin:0!important;padding:0!important}.adtester-container-119,.adtester-container-144,.adtester-container-145,.adtester-container-139,.adtester-container-155,.adtester-container-123,.adtester-container-113,.adtester-container-142,.adtester-container-150,.adtester-container-128,.adtester-container-120,.adtester-container-124,.adtester-container-114,.adtester-container-126,.adtester-container-122,.adtester-container-143,.adtester-container-146,.adtester-container-121,.adtester-container-118,.adtester-container-115,.adtester-container-149,.adtester-container-133,.adtester-container-137,.adtester-container-104,.adtester-container-127,.adtester-container-148,.adtester-container-140,.adtester-container-132,.adtester-container-130,.adtester-container-154,.adtester-container-125,.adtester-container-134,.adtester-container-151,.adtester-container-116,.adtester-container-112,.adtester-container-147,.adtester-container-138,.adtester-container-152,.adtester-container-129,.adtester-container-135,.adtester-container-100{display:none!important}.ezoic-floating-bottom{display:none!important}@media(min-width:900px){.ez-sticky{position:sticky;position:-webkit-sticky;top:80px;z-index:10}}</style><script>(adsbygoogle=window.adsbygoogle||[]).pauseAdRequests=1;var __ez_conestreq=true;</script><script>var ezouid="1";</script><!--<base href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html">--><base href="."><script>var ezoTemplate='pub_site';if(typeof ezouid=='undefined')
{var ezouid='none';}
var ezoFormfactor='1';var ezo_elements_to_check=Array();</script><script data-ezscrex="false">var soc_app_id='0';var did=110793;var ezdomain='hotexamples.com';var ezoicSearchable=1;</script><script data-ezscrex="false" data-pagespeed-no-defer="" data-cfasync="false">function create_ezolpl(pvID,rv){var d=new Date();d.setTime(d.getTime()+(365*24*60*60*1000));var expires="expires="+d.toUTCString();__ez.ck.setByCat("ezux_lpl_110793="+new Date().getTime()+"|"+pvID+"|"+rv+"; "+expires,3);}
function attach_ezolpl(pvID,rv){if(document.readyState==="complete"){create_ezolpl(pvID,rv);}
if(window.attachEvent){window.attachEvent("onload",create_ezolpl,pvID,rv);}else{if(window.onload){var curronload=window.onload;var newonload=function(evt){curronload(evt);create_ezolpl(pvID,rv);};window.onload=newonload;}else{window.onload=create_ezolpl.bind(null,pvID,rv);}}}
__ez.queue.addFunc("attach_ezolpl","attach_ezolpl",["ba6b9e4a-2fe5-4554-4fd2-dd3f475f90e8","false"],false,['/detroitchicago/boise.js'],true,false,false,false);</script><script>__ez.queue.addFile('/detroitchicago/cmbv2.js','/detroitchicago/cmbv2.js?gcb=195-2&cb=04-1y02-4y06-12y07-1y19-5y0b-5y0d-10y13-3y17-3y1a-2y1b-1y1d-2y1f-2y1e-4y20-3y33-15y5a-19&cmbcb=20&sj=x04x02x06x07x19x0bx0dx13x17x1ax1bx1dx1fx1ex20x33x5a',true,[],true,false,true,false);</script><script src="./C++ (Cpp) poll Exemples - HotExamples_files/cmbv2.js" async=""></script><script defer="">__ez.queue.addFile('/detroitchicago/cmbdv2.js','/detroitchicago/cmbdv2.js?gcb=195-2&cb=03-4y0c-5y18-3y34-15y5b-19&cmbcb=20&sj=x03x0cx18x34x5b',true,['/detroitchicago/cmbv2.js'],true,false,true,false);</script>
<script>
    (function(window, document) {
		if (typeof window.__tcfapi !== "undefined") {
			function _ezAllowed(tcdata, purpose) {
				return tcdata.purpose.consents[purpose] || tcdata.purpose.legitimateInterests[purpose];
			};
			function _reloadAds() {
				if (typeof window.ezorefgsl === "function" && typeof window.ezslots === "object") {
					if(typeof __ezapsFetchBids == "function"){
						ezapsFetchBids(__ezaps);
					}
					var slots = [];
					for (var i=0;i<window.ezslots.length;i++) {
						if (window[window.ezslots[i]] && typeof window[window.ezslots[i]] === "object") {
							slots.push(window[window.ezslots[i]])
						}
						else {
							setTimeout(_reloadAds, 50);
							return false;
						}
					}
					for (var i=0;i<slots.length;i++) {
						window.ezorefgsl(slots[i]);
					}
				}
				else {
					setTimeout(_reloadAds, 50);
				}
			};
			function _clearEzConsentCookie() {
				document.cookie = 'ezCMPCookieConsent=tcf2;Domain=.hotexamples.com;Path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT';
			};
			__tcfapi('addEventListener', 2, function(tcdata, success){
				if (success) {
					if (tcdata.eventStatus === "useractioncomplete" || tcdata.eventStatus === "tcloaded") {
						var ezConsentCategories = window.ezConsentCategories ? window.ezConsentCategories : {};
						ezConsentCategories.preferences = false;
						ezConsentCategories.statistics = false;
						ezConsentCategories.marketing = false;
						if ((tcdata.vendor.consents["347"] !== false) || (tcdata.vendor.legitimateInterests["347"] !== false)) {
							if (tcdata.purpose.consents["1"] === true) {
								ezConsentCategories.preferences = true;
							}
							if ((tcdata.purpose.consents["1"] === true) && _ezAllowed(tcdata, "10") && _ezAllowed(tcdata, "7") && _ezAllowed(tcdata, "8")) {
								ezConsentCategories.statistics = true;
							}
							if ((tcdata.purpose.consents["1"] === true) && _ezAllowed(tcdata, "2") && _ezAllowed(tcdata, "3") && _ezAllowed(tcdata, "4")) {
								ezConsentCategories.marketing = true;
							}
						}
						if ((tcdata.purpose.consents["1"] === true) && (tcdata.vendor.consents["755"] !== false)) {
							(adsbygoogle=window.adsbygoogle||[]).pauseAdRequests=0;
							_reloadAds();
						}
						if (window.__ezconsent) {
							__ezconsent.setEzoicConsentSettings(ezConsentCategories);
						}
						window.addEventListener("beforeunload", _clearEzConsentCookie);
						__tcfapi("removeEventListener", 2, function(success){return null;}, tcdata.listenerId);
						if (!((tcdata.purpose.consents["1"] === true) && _ezAllowed(tcdata, "2") && _ezAllowed(tcdata, "3") && _ezAllowed(tcdata, "4"))) {
							if(typeof __ez == 'object' && typeof __ez.bit == 'object' && typeof window["_ezaq"] == 'object' && typeof window["_ezaq"]["page_view_id"] == 'string') {
								__ez.bit.AddAndFire(window["_ezaq"]["page_view_id"], [(new __ezDotData('non_personalized_ads', true))]);
							}
						}
					}
				}
			});
		}
	})(window, document);
</script>
<script type="text/javascript">var cmpIsOn = true;</script>
<script type="text/javascript" src="./C++ (Cpp) poll Exemples - HotExamples_files/consentsettings.js"></script><script src="./C++ (Cpp) poll Exemples - HotExamples_files/cmbdv2.js" async=""></script><script src="./C++ (Cpp) poll Exemples - HotExamples_files/denver.js" async=""></script><script src="./C++ (Cpp) poll Exemples - HotExamples_files/cmp.js" data-cfasync="false"></script><script type="text/javascript" src="./C++ (Cpp) poll Exemples - HotExamples_files/addthis_widget.js"></script></head><body><div class="wrap"><nav id="w0" class="navbar-inverse navbar-fixed-top navbar"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w0-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="https://cpp.hotexamples.com/fr/">Hot Examples</a></div><div id="w0-collapse" class="collapse navbar-collapse"><ul id="w1" class="navbar-nav navbar-right nav"><li class="dropdown"><a class="dropdown-toggle" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#" data-toggle="dropdown">FR <span class="caret"></span></a><ul id="w2" class="dropdown-menu"><li><a href="https://cpp.hotexamples.com/examples/-/-/poll/cpp-poll-function-examples.html" tabindex="-1">EN</a></li><li><a href="https://cpp.hotexamples.com/ru/examples/-/-/poll/cpp-poll-function-examples.html" tabindex="-1">RU</a></li><li><a href="https://cpp.hotexamples.com/de/examples/-/-/poll/cpp-poll-function-examples.html" tabindex="-1">DE</a></li><li><a href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html" tabindex="-1">FR</a></li><li><a href="https://cpp.hotexamples.com/es/examples/-/-/poll/cpp-poll-function-examples.html" tabindex="-1">ES</a></li><li><a href="https://cpp.hotexamples.com/pt/examples/-/-/poll/cpp-poll-function-examples.html" tabindex="-1">PT</a></li><li><a href="https://cpp.hotexamples.com/it/examples/-/-/poll/cpp-poll-function-examples.html" tabindex="-1">IT</a></li><li><a href="https://cpp.hotexamples.com/jp/examples/-/-/poll/cpp-poll-function-examples.html" tabindex="-1">JP</a></li><li><a href="https://cpp.hotexamples.com/zh/examples/-/-/poll/cpp-poll-function-examples.html" tabindex="-1">ZH</a></li></ul></li></ul><div class="col-sm-9 col-md-9 col-lg-9"><form id="search-form" class="navbar-form" action="https://cpp.hotexamples.com/fr/search" method="post" role="search"><input type="hidden" id="searchform-lang" class="form-control" name="SearchForm[lang]" value="cpp"><div class="input-group"><div class="input-group-btn clear"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<span class="search-language-name">C++</span><span class="caret"></span></button><ul class="dropdown-menu"><li><a href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html" class="search-language-item" data-action="https://hotexamples.com/fr/search" data-value="php" data-example="Exemple : Zend_Json::decode">PHP</a></li><li><a href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html" class="search-language-item" data-action="https://csharp.hotexamples.com/fr/search" data-value="csharp" data-example="Exemple : DateTime.Now">C#</a></li><li><a href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html" class="search-language-item" data-action="https://java.hotexamples.com/fr/search" data-value="java" data-example="Exemple : Collections.binarySearch">Java</a></li><li><a href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html" class="search-language-item" data-action="https://golang.hotexamples.com/fr/search" data-value="go" data-example="Exemple : Sprintf">Go</a></li><li><a href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html" class="search-language-item" data-action="https://cpp.hotexamples.com/fr/search" data-value="cpp" data-example="Exemple : QList.isEmpty">C++</a></li><li><a href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html" class="search-language-item" data-action="https://python.hotexamples.com/fr/search" data-value="python" data-example="Exemple : OrderedDict.iteritems">Python</a></li><li><a href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html" class="search-language-item" data-action="https://javascript.hotexamples.com/fr/search" data-value="javascript" data-example="Exemple : AsyncStorage">JS</a></li><li><a href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html" class="search-language-item" data-action="https://typescript.hotexamples.com/fr/search" data-value="typescript" data-example="Exemple : AsyncStorage">TS</a></li></ul></div><input id="searchform-search" class="form-control" name="SearchForm[search]" autofocus="" placeholder="Exemple : QList.isEmpty" aria-required="true" aria-invalid="true">
<span class="input-group-btn clear"><button class="btn btn-primary" name="search">Rechercher</button></span></div></form></div></div></div></nav><div class="container" style="display:flex"><div class="page-container page-container-with-fixed-sidebar300px"><span id="ezoic-pub-ad-placeholder-141" class="ezoic-adpicker-ad"></span><span class="ezoic-ad box-2 box-2141 adtester-container adtester-container-141" data-ez-name="hotexamples_com-box-2"><span id="div-gpt-ad-hotexamples_com-box-2-0" ezaw="728" ezah="90" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:90px;min-width:728px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-box-2-0')};</script></span></span><div style="margin-bottom:10px"><h1>C++ (Cpp) poll Exemples</h1><span id="ezoic-pub-ad-placeholder-103"></span><span class="ezoic-ad box-3 box-3103 adtester-container adtester-container-103" data-ez-name="hotexamples_com-box-3"><span id="div-gpt-ad-hotexamples_com-box-3-0" ezaw="728" ezah="90" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:90px;min-width:728px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-box-3-0')};</script></span></span><div class="examples-description-container"><div class="hidden-xs"><span id="ezoic-pub-ad-placeholder-129"></span></div><div class="examples-description"><strong><strong>C++ (Cpp) poll - 30 exemples trouvés</strong>. Ce sont les exemples réels les mieux notés de <strong>poll</strong> extraits de projets open source. Vous pouvez noter les exemples pour nous aider à en améliorer la qualité.<div class="example-info-table"><div><span>Langage de programmation:</span> C++ (Cpp)</div><div><span>Méthode/Fonction:</span> poll</div><div><span>Exemples au hotexamples.com:</span> 30</div></div></strong></div><strong><div class="hidden-xs"><span id="ezoic-pub-ad-placeholder-130"></span></div></strong></div><strong><span id="ezoic-pub-ad-placeholder-105"></span><span class="ezoic-ad medrectangle-3 medrectangle-3105 adtester-container adtester-container-105" data-ez-name="hotexamples_com-medrectangle-3"><span id="div-gpt-ad-hotexamples_com-medrectangle-3-0" ezaw="580" ezah="400" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:400px;min-width:580px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-medrectangle-3-0')};</script></span></span></strong></div><strong><div class="page-content-container"><div class="sidebar hidden-xs hidden-sm hidden-md" style="width:300px"><span id="ezoic-pub-ad-placeholder-101"></span><span class="ezoic-ad box-1 box-1101 adtester-container adtester-container-101 ezoic-ad-adaptive" data-ez-name="hotexamples_com-box-1"><span class="ezoic-ad box-1 box-1-multi-101 adtester-container adtester-container-101" data-ez-name="hotexamples_com-box-1"><span id="div-gpt-ad-hotexamples_com-box-1-0" ezaw="300" ezah="262" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:262px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-box-1-0')};</script></span></span><span class="ezoic-ad box-1 box-1-multi-101 adtester-container adtester-container-101" data-ez-name="hotexamples_com-box-1"><span id="div-gpt-ad-hotexamples_com-box-1-0_1" ezaw="300" ezah="262" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:262px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-box-1-0_1')};</script></span></span><span class="ezoic-ad box-1 box-1-multi-101 adtester-container adtester-container-101" data-ez-name="hotexamples_com-box-1"><span id="div-gpt-ad-hotexamples_com-box-1-0_2" ezaw="300" ezah="262" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:262px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-box-1-0_2')};</script></span></span><span class="ezoic-ad box-1 box-1-multi-101 adtester-container adtester-container-101" data-ez-name="hotexamples_com-box-1"><span id="div-gpt-ad-hotexamples_com-box-1-0_3" ezaw="300" ezah="262" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:262px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-box-1-0_3')};</script></span></span><style>.box-1-multi-101{border:none!important;display:inline-block;float:none;line-height:0;margin-bottom:0!important;margin-left:0!important;margin-right:0!important;margin-top:0!important;min-height:250px;min-width:300px;padding:0}</style></span><div class="hidden-xs hidden-sm"><div class="bs-example thin"><div class="bs-example-title">Related</div></div><figure class="highlight panel"><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://cpp.hotexamples.com/fr/examples/-/-/new_string/cpp-new_string-function-examples.html">new_string</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://cpp.hotexamples.com/fr/examples/-/-/do_QueryReferent/cpp-do_queryreferent-function-examples.html">do_QueryReferent</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://cpp.hotexamples.com/fr/examples/-/-/createReferenceError/cpp-createreferenceerror-function-examples.html">createReferenceError</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://cpp.hotexamples.com/fr/examples/-/-/rtnl_lock/cpp-rtnl_lock-function-examples.html">rtnl_lock</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://cpp.hotexamples.com/fr/examples/-/-/SSL_get_version/cpp-ssl_get_version-function-examples.html">SSL_get_version</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://cpp.hotexamples.com/fr/examples/-/-/for_each/cpp-for_each-function-examples.html">for_each</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://cpp.hotexamples.com/fr/examples/-/-/CertFindRDNAttr/cpp-certfindrdnattr-function-examples.html">CertFindRDNAttr</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://cpp.hotexamples.com/fr/examples/-/-/cimag/cpp-cimag-function-examples.html">cimag</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://cpp.hotexamples.com/fr/examples/-/-/SDL_GetClipRect/cpp-sdl_getcliprect-function-examples.html">SDL_GetClipRect</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://cpp.hotexamples.com/fr/examples/-/-/AJ_InfoPrintf/cpp-aj_infoprintf-function-examples.html">AJ_InfoPrintf</a></div></figure></div><span id="ezoic-pub-ad-placeholder-102"></span><span class="ezoic-ad large-leaderboard-1 large-leaderboard-1102 adtester-container adtester-container-102 ezoic-ad-adaptive" data-ez-name="hotexamples_com-large-leaderboard-1"><span class="ezoic-ad large-leaderboard-1 large-leaderboard-1-multi-102 adtester-container adtester-container-102" data-ez-name="hotexamples_com-large-leaderboard-1"><span id="div-gpt-ad-hotexamples_com-large-leaderboard-1-0" ezaw="300" ezah="262" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:262px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-large-leaderboard-1-0')};</script></span></span><span class="ezoic-ad large-leaderboard-1 large-leaderboard-1-multi-102 adtester-container adtester-container-102" data-ez-name="hotexamples_com-large-leaderboard-1"><span id="div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1" ezaw="300" ezah="262" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:262px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1')};</script></span></span><span class="ezoic-ad large-leaderboard-1 large-leaderboard-1-multi-102 adtester-container adtester-container-102" data-ez-name="hotexamples_com-large-leaderboard-1"><span id="div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2" ezaw="300" ezah="262" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:262px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2')};</script></span></span><span class="ezoic-ad large-leaderboard-1 large-leaderboard-1-multi-102 adtester-container adtester-container-102" data-ez-name="hotexamples_com-large-leaderboard-1"><span id="div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3" ezaw="300" ezah="262" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:262px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3')};</script></span></span><style>.large-leaderboard-1-multi-102{border:none!important;display:inline-block;float:none!important;line-height:0;margin-bottom:0!important;margin-left:0!important;margin-right:0!important;margin-top:0!important;min-height:250px;min-width:300px;padding:0}</style></span><div class="hidden-xs hidden-sm"><div class="bs-example thin"><div class="bs-example-title">Related in langs</div></div><figure class="highlight panel"><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://hotexamples.com/fr/examples/-/-/get_user_locale/php-get_user_locale-function-examples.html">get_user_locale (PHP)</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://hotexamples.com/fr/examples/-/-/wpPostsByType/php-wppostsbytype-function-examples.html">wpPostsByType (PHP)</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://csharp.hotexamples.com/fr/examples/SeriesInfoGrabber/Staffel/-/php-staffel-class-examples.html">Staffel (C#)</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://csharp.hotexamples.com/fr/examples/-/ISyncCommandDispatcher/-/php-isynccommanddispatcher-class-examples.html">ISyncCommandDispatcher (C#)</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://golang.hotexamples.com/fr/examples/github.com.zach-klippenstein.goadb.util/-/HasErrCode/golang-haserrcode-function-examples.html">HasErrCode (Go)</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://golang.hotexamples.com/fr/examples/github.com.square.p2.pkg.roll.fields/Update/-/golang-update-class-examples.html">Update (Go)</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://java.hotexamples.com/fr/examples/org.hl7.fhir.dstu3.model/IdType/-/java-idtype-class-examples.html">IdType (Java)</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://java.hotexamples.com/fr/examples/-/RotatingPanel/-/java-rotatingpanel-class-examples.html">RotatingPanel (Java)</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://python.hotexamples.com/fr/examples/pele.gui.ui.rate_gui/Ui_Form/-/python-ui_form-class-examples.html">Ui_Form (Python)</a></div><div style="overflow:hidden;text-overflow:ellipsis"><a href="https://python.hotexamples.com/fr/examples/-/Bank/-/python-bank-class-examples.html">Bank (Python)</a></div></figure></div><span id="ezoic-pub-ad-placeholder-117"></span><span class="ezoic-ad large-billboard-2 large-billboard-2117 adtester-container adtester-container-117" data-ez-name="hotexamples_com-large-billboard-2"><span id="div-gpt-ad-hotexamples_com-large-billboard-2-0" ezaw="250" ezah="250" style="position:relative;z-index:0;display:inline-block;padding:0;width:100%;max-width:1200px;margin-left:auto!important;margin-right:auto!important;min-height:600px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-large-billboard-2-0')};</script></span><span style="width:250px;display:block;height:14px;margin:auto" class="reportline"><span style="text-align:center;font-size:smaller;float:left;line-height:normal"><a href="https://www.ezoic.com/what-is-ezoic/" target="_blank" rel="noopener noreferrer nofollow" style="cursor:pointer"><img src="./C++ (Cpp) poll Exemples - HotExamples_files/ezoic.png" alt="Ezoic" style="height:12px!important;padding:2px!important;border:0!important;cursor:pointer!important;width:58px!important;margin:0!important;box-sizing:content-box!important"></a></span><span class="ez-report-ad-button" name="?pageview_id=ba6b9e4a-2fe5-4554-4fd2-dd3f475f90e8&amp;ad_position_id=117&amp;impression_group_id=hotexamples_com-large-billboard-2/2021-08-07/176351068453565&amp;ad_size=250x250&amp;domain_id=110793&amp;url=https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html" style="cursor:pointer!important;font-size:12px!important;color:#a5a5a5;float:right;text-decoration:none!important;font-family:arial!important;line-height:normal">report this ad</span></span></span></div><div class="main-content"><div class="addthis_inline_share_toolbox_o6yp"></div><span id="ezoic-pub-ad-placeholder-106"></span><span class="ezoic-ad medrectangle-4 medrectangle-4106 adtester-container adtester-container-106" data-ez-name="hotexamples_com-medrectangle-4"><span id="div-gpt-ad-hotexamples_com-medrectangle-4-0" ezaw="468" ezah="60" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:90px;min-width:728px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-medrectangle-4-0')};</script></span></span><div class="example-item" id="0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef-228,,300,"><div class="bs-example"><div><div class="bs-example-title">Exemple #1</div><div style="position:absolute;right:15px;top:10px" id="rating_1" data-hash="0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef" data-area="228,,300,"><div class="rating-amount">42</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;1&#39;)" class="rating-up btn btn-success" data-id="rating_1"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;1&#39;)" class="rating-down btn btn-danger" data-id="rating_1"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef-228,,300,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef&amp;fullName=main.cpp&amp;project=kevintrinh%2Fsoftserver&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevintrinh%2Fsoftserver%2Fblob%2Fmaster%2Fmain.cpp">main.cpp</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevintrinh%2Fsoftserver">kevintrinh/softserver</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="1"><pre class="line-numbers  language-cpp" data-end="300" data-start="229" data-highlight="293"><span class="token keyword">void</span><span class="token operator">*</span> <span class="token function">console_thread_func</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">/*Start logs*/</span>

    <span class="token keyword">while</span><span class="token punctuation">(</span>bConsoleActive<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>qConsoleMessages<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>

            console_msg front_msg <span class="token operator">=</span> qConsoleMessages<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">gdk_threads_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            GtkTextIter console_end_iter<span class="token punctuation">;</span>
            <span class="token function">gtk_text_buffer_get_end_iter</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*Get end of console*/</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>front_msg<span class="token punctuation">.</span>type <span class="token operator">!=</span> important_online <span class="token operator">&amp;&amp;</span> front_msg<span class="token punctuation">.</span>type <span class="token operator">!=</span> important_offline <span class="token operator">&amp;&amp;</span> front_msg<span class="token punctuation">.</span>type <span class="token operator">!=</span> motd<span class="token punctuation">)</span><span class="token punctuation">{</span>

                <span class="token function">gtk_text_buffer_insert_with_tags</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">,</span> front_msg<span class="token punctuation">.</span>from_who<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>front_msg<span class="token punctuation">.</span>from_who<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> console_format_normal<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">gtk_text_buffer_get_end_iter</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*Get end again*/</span>

                <span class="token function">gtk_text_buffer_insert_with_tags</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">,</span> <span class="token string">": "</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">": "</span><span class="token punctuation">)</span><span class="token punctuation">,</span> console_format_normal<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*Formating*/</span>
                <span class="token function">gtk_text_buffer_get_end_iter</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">switch</span><span class="token punctuation">(</span>front_msg<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//from_who uses console_format_normal</span>

                <span class="token keyword">case</span> notification<span class="token operator">:</span>
                    <span class="token function">gtk_text_buffer_insert_with_tags</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">,</span> front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> console_format_notification<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

                <span class="token keyword">case</span> error<span class="token operator">:</span>
                    <span class="token function">gtk_text_buffer_insert_with_tags</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">,</span> front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> console_format_error<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

                <span class="token keyword">case</span> warning<span class="token operator">:</span>
                    <span class="token function">gtk_text_buffer_insert_with_tags</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">,</span> front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> console_format_warning<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

                <span class="token keyword">case</span> important_online<span class="token operator">:</span>

                    <span class="token function">gtk_text_buffer_insert_with_tags</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">,</span> front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> console_format_important_online<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">break</span><span class="token punctuation">;</span>

                <span class="token keyword">case</span> important_offline<span class="token operator">:</span>

                    <span class="token function">gtk_text_buffer_insert_with_tags</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">,</span> front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> console_format_important_offline<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">break</span><span class="token punctuation">;</span>

                <span class="token keyword">case</span> motd<span class="token operator">:</span>

                    <span class="token function">gtk_text_buffer_insert_with_tags</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">,</span> front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>front_msg<span class="token punctuation">.</span>strMessage<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> console_format_motd<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">gtk_text_buffer_get_end_iter</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     <span class="token function">gtk_text_buffer_insert</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>


            <span class="token function">gtk_text_buffer_get_end_iter</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">gtk_text_buffer_insert</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">gtk_text_buffer_get_end_iter</span><span class="token punctuation">(</span>console_buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">gtk_text_view_scroll_to_iter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>GtkTextView<span class="token operator">*</span><span class="token punctuation">)</span>console_text<span class="token punctuation">,</span> <span class="token operator">&amp;</span>console_end_iter<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">gdk_threads_leave</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            qConsoleMessages<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//pop 'em</span>
                    <span class="token function">poll</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> CONSOLE_DELAY<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*Don't want it to spout all out and shit*/</span>
        <span class="token punctuation">}</span>


    <span class="token punctuation">}</span>

    <span class="token comment">/*Clean up and save logs here*/</span>
    <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:1344px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 228;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><span id="ezoic-pub-ad-placeholder-107"></span><span class="ezoic-ad box-4 box-4107 adtester-container adtester-container-107" data-ez-name="hotexamples_com-box-4"><span id="div-gpt-ad-hotexamples_com-box-4-0" ezaw="300" ezah="250" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:250px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-box-4-0')};</script></span></span><div class="example-item" id="0x10ae9dfb23912d0f304d29fad48586dfa03f81e4cfc3e2f70cc8af75f176d7c4-1252,,1330,"><div class="bs-example"><div><div class="bs-example-title">Exemple #2</div><div style="position:absolute;right:15px;top:10px" id="rating_2" data-hash="0x10ae9dfb23912d0f304d29fad48586dfa03f81e4cfc3e2f70cc8af75f176d7c4" data-area="1252,,1330,"><div class="rating-amount">1</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;2&#39;)" class="rating-up btn btn-success" data-id="rating_2"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;2&#39;)" class="rating-down btn btn-danger" data-id="rating_2"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x10ae9dfb23912d0f304d29fad48586dfa03f81e4cfc3e2f70cc8af75f176d7c4-1252,,1330,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x10ae9dfb23912d0f304d29fad48586dfa03f81e4cfc3e2f70cc8af75f176d7c4&amp;fullName=uclinux-2-master%2Flib%2FDirectFB%2FDirectFB-1.2.7%2Flib%2Fmanager.c&amp;project=kizukukoto%2FWDN900_GPL&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkizukukoto%2FWDN900_GPL%2Fblob%2Fmaster%2Fuclinux-2-master%2Flib%2FDirectFB%2FDirectFB-1.2.7%2Flib%2Fmanager.c">manager.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkizukukoto%2FWDN900_GPL">kizukukoto/WDN900_GPL</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="2"><pre class="line-numbers  language-cpp" data-end="1330" data-start="1253" data-highlight="1266"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token operator">*</span>
<span class="token function">manager_output_loop</span><span class="token punctuation">(</span> DirectThread <span class="token operator">*</span>thread<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>arg <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
     <span class="token keyword">int</span>            len<span class="token punctuation">;</span>
     <span class="token keyword">struct</span> pollfd  pf<span class="token punctuation">;</span>
     VoodooManager <span class="token operator">*</span>manager <span class="token operator">=</span> arg<span class="token punctuation">;</span>

     <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>manager<span class="token operator">-&gt;</span>quit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">D_MAGIC_ASSERT</span><span class="token punctuation">(</span> manager<span class="token punctuation">,</span> VoodooManager <span class="token punctuation">)</span><span class="token punctuation">;</span>

          pf<span class="token punctuation">.</span>fd     <span class="token operator">=</span> manager<span class="token operator">-&gt;</span>fd<span class="token punctuation">;</span>
          pf<span class="token punctuation">.</span>events <span class="token operator">=</span> POLLOUT<span class="token punctuation">;</span>

          <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">poll</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>pf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>errno <span class="token operator">!=</span> EINTR<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                         <span class="token function">D_PERROR</span><span class="token punctuation">(</span> <span class="token string">"Voodoo/Output: Could not poll() the socket!\n"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                         <span class="token function">usleep</span><span class="token punctuation">(</span> <span class="token number">200000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token comment">/* fall through */</span>

               <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                    <span class="token keyword">continue</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>

          <span class="token function">pthread_mutex_lock</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>lock <span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token keyword">while</span> <span class="token punctuation">(</span>manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>start <span class="token operator">==</span> manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">struct</span> timeval  now<span class="token punctuation">;</span>
               <span class="token keyword">struct</span> timespec timeout<span class="token punctuation">;</span>

               <span class="token function">D_ASSUME</span><span class="token punctuation">(</span> manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>start <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token function">D_ASSUME</span><span class="token punctuation">(</span> manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>end <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

               <span class="token function">gettimeofday</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>now<span class="token punctuation">,</span> <span class="token constant">NULL</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

               timeout<span class="token punctuation">.</span>tv_sec  <span class="token operator">=</span> now<span class="token punctuation">.</span>tv_sec<span class="token punctuation">;</span>
               timeout<span class="token punctuation">.</span>tv_nsec <span class="token operator">=</span> <span class="token punctuation">(</span>now<span class="token punctuation">.</span>tv_usec <span class="token operator">+</span> <span class="token number">50000</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>

               timeout<span class="token punctuation">.</span>tv_sec  <span class="token operator">+=</span> timeout<span class="token punctuation">.</span>tv_nsec <span class="token operator">/</span> <span class="token number">1000000000</span><span class="token punctuation">;</span>
               timeout<span class="token punctuation">.</span>tv_nsec <span class="token operator">%=</span> <span class="token number">1000000000</span><span class="token punctuation">;</span>

               <span class="token function">pthread_cond_timedwait</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>wait<span class="token punctuation">,</span> <span class="token operator">&amp;</span>manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>lock<span class="token punctuation">,</span> <span class="token operator">&amp;</span>timeout <span class="token punctuation">)</span><span class="token punctuation">;</span>

               <span class="token keyword">if</span> <span class="token punctuation">(</span>manager<span class="token operator">-&gt;</span>quit<span class="token punctuation">)</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>

          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>manager<span class="token operator">-&gt;</span>quit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               len <span class="token operator">=</span> <span class="token function">send</span><span class="token punctuation">(</span> manager<span class="token operator">-&gt;</span>fd<span class="token punctuation">,</span> manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>buffer <span class="token operator">+</span> manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>start<span class="token punctuation">,</span>
                           manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>end <span class="token operator">-</span> manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>start<span class="token punctuation">,</span> MSG_DONTWAIT <span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">switch</span> <span class="token punctuation">(</span>errno<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                         <span class="token keyword">case</span> EINTR<span class="token operator">:</span>
                         <span class="token keyword">case</span> EAGAIN<span class="token operator">:</span>
                              <span class="token keyword">break</span><span class="token punctuation">;</span>
                         <span class="token keyword">default</span><span class="token operator">:</span>
                              <span class="token function">D_PERROR</span><span class="token punctuation">(</span> <span class="token string">"Voodoo/Output: Could not send() data!\n"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                              <span class="token function">usleep</span><span class="token punctuation">(</span> <span class="token number">200000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
               <span class="token punctuation">}</span>
               <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token function">D_DEBUG</span><span class="token punctuation">(</span> <span class="token string">"Voodoo/Output: Sent %d/%d bytes...\n"</span><span class="token punctuation">,</span> len<span class="token punctuation">,</span> manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>end <span class="token operator">-</span> manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>start <span class="token punctuation">)</span><span class="token punctuation">;</span>

                    manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>start <span class="token operator">+=</span> len<span class="token punctuation">;</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span>manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>start <span class="token operator">==</span> manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                         manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>start <span class="token operator">=</span> manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

                         <span class="token function">pthread_cond_broadcast</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>wait <span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
               <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>

          <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>manager<span class="token operator">-&gt;</span>output<span class="token punctuation">.</span>lock <span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:273px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 1252;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><span id="ezoic-pub-ad-placeholder-108"></span><span class="ezoic-ad banner-1 banner-1108 adtester-container adtester-container-108" data-ez-name="hotexamples_com-banner-1"><span id="div-gpt-ad-hotexamples_com-banner-1-0" ezaw="300" ezah="250" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:250px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-banner-1-0')};</script></span></span><div class="example-item" id="0x11d4b0ff7c5d14414b4f7d180cfbdab90af3c84eb5a7c2cdde794ebe721b8b6a-877,,1097,"><div class="bs-example"><div><div class="bs-example-title">Exemple #3</div><div style="position:absolute;right:15px;top:10px" id="rating_3" data-hash="0x11d4b0ff7c5d14414b4f7d180cfbdab90af3c84eb5a7c2cdde794ebe721b8b6a" data-area="877,,1097,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;3&#39;)" class="rating-up btn btn-success" data-id="rating_3"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;3&#39;)" class="rating-down btn btn-danger" data-id="rating_3"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x11d4b0ff7c5d14414b4f7d180cfbdab90af3c84eb5a7c2cdde794ebe721b8b6a-877,,1097,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x11d4b0ff7c5d14414b4f7d180cfbdab90af3c84eb5a7c2cdde794ebe721b8b6a&amp;fullName=smcp-master%2Fsrc%2Fsmcp-plat-bsd.c&amp;project=paulobrizolara%2Fsmcp&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fpaulobrizolara%2Fsmcp%2Fblob%2Fmaster%2Fsmcp-master%2Fsrc%2Fsmcp-plat-bsd.c">smcp-plat-bsd.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fpaulobrizolara%2Fsmcp">paulobrizolara/smcp</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="3"><pre class="line-numbers  language-cpp" data-end="1097" data-start="878" data-highlight="897">smcp_status_t
<span class="token function">smcp_plat_process</span><span class="token punctuation">(</span>
	smcp_t self
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	SMCP_EMBEDDED_SELF_HOOK<span class="token punctuation">;</span>
	smcp_status_t ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> tmp<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> pollfd polls<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> poll_count<span class="token punctuation">;</span>

	poll_count <span class="token operator">=</span> <span class="token function">smcp_plat_update_pollfds</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> polls<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>polls<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>polls<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>poll_count <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>polls<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>polls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		poll_count <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>polls<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>polls<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	errno <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	tmp <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>polls<span class="token punctuation">,</span> poll_count<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Ensure that poll did not fail with an error.</span>
	<span class="token function">require_action_string</span><span class="token punctuation">(</span>
		errno <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span>
		bail<span class="token punctuation">,</span>
		ret <span class="token operator">=</span> SMCP_STATUS_ERRNO<span class="token punctuation">,</span>
		<span class="token function">strerror</span><span class="token punctuation">(</span>errno<span class="token punctuation">)</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span>tmp <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>tmp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> tmp <span class="token operator">&lt;</span> poll_count<span class="token punctuation">;</span> tmp<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>polls<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span><span class="token punctuation">.</span>revents<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token keyword">char</span> packet<span class="token punctuation">[</span>SMCP_MAX_PACKET_LENGTH<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				smcp_sockaddr_t remote_saddr <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
				smcp_sockaddr_t local_saddr <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
				ssize_t packet_len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				<span class="token keyword">char</span> cmbuf<span class="token punctuation">[</span><span class="token number">0x100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token keyword">struct</span> iovec iov <span class="token operator">=</span> <span class="token punctuation">{</span> packet<span class="token punctuation">,</span> SMCP_MAX_PACKET_LENGTH <span class="token punctuation">}</span><span class="token punctuation">;</span>
				<span class="token keyword">struct</span> msghdr msg <span class="token operator">=</span> <span class="token punctuation">{</span>
					<span class="token punctuation">.</span>msg_name <span class="token operator">=</span> <span class="token operator">&amp;</span>remote_saddr<span class="token punctuation">,</span>
					<span class="token punctuation">.</span>msg_namelen <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>remote_saddr<span class="token punctuation">)</span><span class="token punctuation">,</span>
					<span class="token punctuation">.</span>msg_iov <span class="token operator">=</span> <span class="token operator">&amp;</span>iov<span class="token punctuation">,</span>
					<span class="token punctuation">.</span>msg_iovlen <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
					<span class="token punctuation">.</span>msg_control <span class="token operator">=</span> cmbuf<span class="token punctuation">,</span>
					<span class="token punctuation">.</span>msg_controllen <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>cmbuf<span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token punctuation">}</span><span class="token punctuation">;</span>
				<span class="token keyword">struct</span> cmsghdr <span class="token operator">*</span>cmsg<span class="token punctuation">;</span>

				packet_len <span class="token operator">=</span> <span class="token function">recvmsg</span><span class="token punctuation">(</span>polls<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>msg<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token function">require_action</span><span class="token punctuation">(</span>packet_len <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> bail<span class="token punctuation">,</span> ret <span class="token operator">=</span> SMCP_STATUS_ERRNO<span class="token punctuation">)</span><span class="token punctuation">;</span>

				packet<span class="token punctuation">[</span>packet_len<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

				<span class="token keyword">for</span> <span class="token punctuation">(</span>
					cmsg <span class="token operator">=</span> <span class="token function">CMSG_FIRSTHDR</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
					cmsg <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
					cmsg <span class="token operator">=</span> <span class="token function">CMSG_NXTHDR</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">,</span> cmsg<span class="token punctuation">)</span>
				<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>cmsg<span class="token operator">-&gt;</span>cmsg_level <span class="token operator">!=</span> SMCP_IPPROTO
						<span class="token operator">||</span> cmsg<span class="token operator">-&gt;</span>cmsg_type <span class="token operator">!=</span> SMCP_PKTINFO
					<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">continue</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token comment">// Preinitialize some of the fields.</span>
					local_saddr <span class="token operator">=</span> remote_saddr<span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">if</span> SMCP_BSD_SOCKETS_NET_FAMILY==AF_INET6</span>
					<span class="token keyword">struct</span> in6_pktinfo <span class="token operator">*</span>pi <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> in6_pktinfo <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">CMSG_DATA</span><span class="token punctuation">(</span>cmsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
					local_saddr<span class="token punctuation">.</span>smcp_addr <span class="token operator">=</span> pi<span class="token operator">-&gt;</span>ipi6_addr<span class="token punctuation">;</span>
					local_saddr<span class="token punctuation">.</span>sin6_scope_id <span class="token operator">=</span> pi<span class="token operator">-&gt;</span>ipi6_ifindex<span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">elif</span> SMCP_BSD_SOCKETS_NET_FAMILY==AF_INET</span>
					<span class="token keyword">struct</span> in_pktinfo <span class="token operator">*</span>pi <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> in_pktinfo <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">CMSG_DATA</span><span class="token punctuation">(</span>cmsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
					local_saddr<span class="token punctuation">.</span>smcp_addr <span class="token operator">=</span> pi<span class="token operator">-&gt;</span>ipi_addr<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

					local_saddr<span class="token punctuation">.</span>smcp_port <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span><span class="token function">get_port_for_fd</span><span class="token punctuation">(</span>polls<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

					self<span class="token operator">-&gt;</span>plat<span class="token punctuation">.</span>pktinfo <span class="token operator">=</span> <span class="token operator">*</span>pi<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token function">smcp_set_current_instance</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">smcp_plat_set_remote_sockaddr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>remote_saddr<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">smcp_plat_set_local_sockaddr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>local_saddr<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token operator">-&gt;</span>plat<span class="token punctuation">.</span>fd_udp <span class="token operator">==</span> polls<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">smcp_plat_set_session_type</span><span class="token punctuation">(</span>SMCP_SESSION_TYPE_UDP<span class="token punctuation">)</span><span class="token punctuation">;</span>

					ret <span class="token operator">=</span> <span class="token function">smcp_inbound_packet_process</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> packet<span class="token punctuation">,</span> <span class="token punctuation">(</span>coap_size_t<span class="token punctuation">)</span>packet_len<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token function">require_noerr</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> bail<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">if</span> SMCP_DTLS</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token operator">-&gt;</span>plat<span class="token punctuation">.</span>fd_dtls <span class="token operator">==</span> polls<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">smcp_plat_set_session_type</span><span class="token punctuation">(</span>SMCP_SESSION_TYPE_DTLS<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token function">smcp_plat_ssl_inbound_packet_process</span><span class="token punctuation">(</span>
						self<span class="token punctuation">,</span>
						packet<span class="token punctuation">,</span>
						<span class="token punctuation">(</span>coap_size_t<span class="token punctuation">)</span>packet_len
					<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token function">smcp_handle_timers</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">;</span>

bail<span class="token operator">:</span>
	<span class="token function">smcp_set_current_instance</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	self<span class="token operator">-&gt;</span>is_responding <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

smcp_status_t
<span class="token function">smcp_plat_lookup_hostname</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> hostname<span class="token punctuation">,</span> smcp_sockaddr_t<span class="token operator">*</span> saddr<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	smcp_status_t ret<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> addrinfo hint <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token punctuation">.</span>ai_flags		<span class="token operator">=</span> AI_ADDRCONFIG<span class="token punctuation">,</span>
		<span class="token punctuation">.</span>ai_family		<span class="token operator">=</span> AF_UNSPEC<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword">struct</span> addrinfo <span class="token operator">*</span>results <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">struct</span> addrinfo <span class="token operator">*</span>iter <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">if</span> SMCP_BSD_SOCKETS_NET_FAMILY != AF_INET6</span>
	hint<span class="token punctuation">.</span>ai_family <span class="token operator">=</span> SMCP_BSD_SOCKETS_NET_FAMILY<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> <span class="token punctuation">(</span>SMCP_LOOKUP_HOSTNAME_FLAG_IPV4_ONLY<span class="token operator">|</span>SMCP_LOOKUP_HOSTNAME_FLAG_IPV6_ONLY<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span>SMCP_LOOKUP_HOSTNAME_FLAG_IPV4_ONLY<span class="token operator">|</span>SMCP_LOOKUP_HOSTNAME_FLAG_IPV6_ONLY<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ret <span class="token operator">=</span> SMCP_STATUS_INVALID_ARGUMENT<span class="token punctuation">;</span>
		<span class="token keyword">goto</span> bail<span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> SMCP_LOOKUP_HOSTNAME_FLAG_IPV4_ONLY<span class="token punctuation">)</span> <span class="token operator">==</span> SMCP_LOOKUP_HOSTNAME_FLAG_IPV4_ONLY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		hint<span class="token punctuation">.</span>ai_family <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> SMCP_LOOKUP_HOSTNAME_FLAG_IPV6_ONLY<span class="token punctuation">)</span> <span class="token operator">==</span> SMCP_LOOKUP_HOSTNAME_FLAG_IPV6_ONLY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		hint<span class="token punctuation">.</span>ai_family <span class="token operator">=</span> AF_INET6<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">memset</span><span class="token punctuation">(</span>saddr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>saddr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	saddr<span class="token operator">-&gt;</span>___smcp_family <span class="token operator">=</span> SMCP_BSD_SOCKETS_NET_FAMILY<span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">if</span> SOCKADDR_HAS_LENGTH_FIELD</span>
	saddr<span class="token operator">-&gt;</span>___smcp_len <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>saddr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

	<span class="token keyword">int</span> error <span class="token operator">=</span> <span class="token function">getaddrinfo</span><span class="token punctuation">(</span>hostname<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>hint<span class="token punctuation">,</span> <span class="token operator">&amp;</span>results<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">if</span> SMCP_BSD_SOCKETS_NET_FAMILY==AF_INET6</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>error <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">inet_addr</span><span class="token punctuation">(</span>hostname<span class="token punctuation">)</span> <span class="token operator">!=</span> INADDR_NONE<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">char</span> addr_v4mapped_str<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span>hostname<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		hint<span class="token punctuation">.</span>ai_family <span class="token operator">=</span> AF_INET6<span class="token punctuation">;</span>
		hint<span class="token punctuation">.</span>ai_flags <span class="token operator">=</span> AI_ALL <span class="token operator">|</span> AI_V4MAPPED<span class="token punctuation">,</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>addr_v4mapped_str<span class="token punctuation">,</span><span class="token string">"::ffff:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcat</span><span class="token punctuation">(</span>addr_v4mapped_str<span class="token punctuation">,</span>hostname<span class="token punctuation">)</span><span class="token punctuation">;</span>
		error <span class="token operator">=</span> <span class="token function">getaddrinfo</span><span class="token punctuation">(</span>addr_v4mapped_str<span class="token punctuation">,</span>
			<span class="token constant">NULL</span><span class="token punctuation">,</span>
			<span class="token operator">&amp;</span>hint<span class="token punctuation">,</span>
			<span class="token operator">&amp;</span>results
		<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>EAI_AGAIN <span class="token operator">==</span> error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ret <span class="token operator">=</span> SMCP_STATUS_WAIT_FOR_DNS<span class="token punctuation">;</span>
		<span class="token keyword">goto</span> bail<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">ifdef</span> TM_EWOULDBLOCK</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>TM_EWOULDBLOCK <span class="token operator">==</span> error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ret <span class="token operator">=</span> SMCP_STATUS_WAIT_FOR_DNS<span class="token punctuation">;</span>
		<span class="token keyword">goto</span> bail<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

	<span class="token function">require_action_string</span><span class="token punctuation">(</span>
		<span class="token operator">!</span>error<span class="token punctuation">,</span>
		bail<span class="token punctuation">,</span>
		ret <span class="token operator">=</span> SMCP_STATUS_HOST_LOOKUP_FAILURE<span class="token punctuation">,</span>
		<span class="token function">gai_strerror</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Move to the first recognized result</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>iter <span class="token operator">=</span> results<span class="token punctuation">;</span>iter <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>iter<span class="token operator">-&gt;</span>ai_family<span class="token operator">!=</span>AF_INET6 <span class="token operator">&amp;&amp;</span> iter<span class="token operator">-&gt;</span>ai_family<span class="token operator">!=</span>AF_INET<span class="token punctuation">)</span><span class="token punctuation">;</span>iter<span class="token operator">=</span>iter<span class="token operator">-&gt;</span>ai_next<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">require_action</span><span class="token punctuation">(</span>
		iter<span class="token punctuation">,</span>
		bail<span class="token punctuation">,</span>
		ret <span class="token operator">=</span> SMCP_STATUS_HOST_LOOKUP_FAILURE
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">if</span> SMCP_BSD_SOCKETS_NET_FAMILY==AF_INET6</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>iter<span class="token operator">-&gt;</span>ai_family <span class="token operator">==</span> AF_INET<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">struct</span> sockaddr_in <span class="token operator">*</span>v4addr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span>iter<span class="token operator">-&gt;</span>ai_addr<span class="token punctuation">;</span>
		saddr<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>s6_addr<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>
		saddr<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>s6_addr<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>
		<span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>saddr<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>s6_addr<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v4addr<span class="token operator">-&gt;</span>sin_addr<span class="token punctuation">.</span>s_addr<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>iter<span class="token operator">-&gt;</span>ai_family <span class="token operator">==</span> SMCP_BSD_SOCKETS_NET_FAMILY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">memcpy</span><span class="token punctuation">(</span>saddr<span class="token punctuation">,</span> iter<span class="token operator">-&gt;</span>ai_addr<span class="token punctuation">,</span> iter<span class="token operator">-&gt;</span>ai_addrlen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">SMCP_IS_ADDR_MULTICAST</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>saddr<span class="token operator">-&gt;</span>smcp_addr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		smcp_t <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token function">smcp_get_current_instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">check</span><span class="token punctuation">(</span>self<span class="token operator">-&gt;</span>outbound<span class="token punctuation">.</span>packet<span class="token operator">-&gt;</span>tt <span class="token operator">!=</span> COAP_TRANS_TYPE_CONFIRMABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token operator">-&gt;</span>outbound<span class="token punctuation">.</span>packet<span class="token operator">-&gt;</span>tt <span class="token operator">==</span> COAP_TRANS_TYPE_CONFIRMABLE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			self<span class="token operator">-&gt;</span>outbound<span class="token punctuation">.</span>packet<span class="token operator">-&gt;</span>tt <span class="token operator">=</span> COAP_TRANS_TYPE_NONCONFIRMABLE<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	ret <span class="token operator">=</span> SMCP_STATUS_OK<span class="token punctuation">;</span>

bail<span class="token operator">:</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>
		<span class="token function">freeaddrinfo</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:399px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 877;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><span id="ezoic-pub-ad-placeholder-109"></span><span class="ezoic-ad large-leaderboard-2 large-leaderboard-2109 adtester-container adtester-container-109" data-ez-name="hotexamples_com-large-leaderboard-2"><span id="div-gpt-ad-hotexamples_com-large-leaderboard-2-0" ezaw="300" ezah="250" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:250px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-large-leaderboard-2-0')};</script></span></span><div class="example-item" id="0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef-380,,521,"><div class="bs-example"><div><div class="bs-example-title">Exemple #4</div><div style="position:absolute;right:15px;top:10px" id="rating_4" data-hash="0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef" data-area="380,,521,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;4&#39;)" class="rating-up btn btn-success" data-id="rating_4"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;4&#39;)" class="rating-down btn btn-danger" data-id="rating_4"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef-380,,521,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef&amp;fullName=main.cpp&amp;project=kevintrinh%2Fsoftserver&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevintrinh%2Fsoftserver%2Fblob%2Fmaster%2Fmain.cpp">main.cpp</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevintrinh%2Fsoftserver">kevintrinh/softserver</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="4"><pre class="line-numbers  language-cpp" data-end="521" data-start="381" data-highlight="514,427"><span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">listen_thread_func</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span> args<span class="token punctuation">)</span>  <span class="token comment">//TCP's thread</span>
<span class="token punctuation">{</span>
    bThreadActive<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    thread_args<span class="token operator">*</span> my_args <span class="token operator">=</span> <span class="token punctuation">(</span>thread_args<span class="token operator">*</span><span class="token punctuation">)</span> args<span class="token punctuation">;</span>
    <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Listen]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span> <span class="token string">"Thread has started"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Listen]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span> <span class="token string">"Doing safe cleanup of Sockets and Clients"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>rgSockets<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        rgSockets<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>rgClients<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        rgClients<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>rgAccounts<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        rgAccounts<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    pollfd MasterSocket<span class="token punctuation">;</span>
    MasterSocket<span class="token punctuation">.</span>fd <span class="token operator">=</span> uiMasterSocketTCP<span class="token punctuation">;</span>
    MasterSocket<span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>
    rgSockets<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>MasterSocket<span class="token punctuation">)</span><span class="token punctuation">;</span>

    soft_client <span class="token function">MasterClient</span><span class="token punctuation">(</span>server_fill<span class="token punctuation">,</span> uiMasterSocketTCP<span class="token punctuation">,</span> uiMasterSocketUDP<span class="token punctuation">)</span><span class="token punctuation">;</span>
    rgClients<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>MasterClient<span class="token punctuation">)</span><span class="token punctuation">;</span>

    soft_account MasterAccount<span class="token punctuation">;</span>
    MasterClient<span class="token punctuation">.</span><span class="token function">set_account</span><span class="token punctuation">(</span>MasterAccount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    rgAccounts<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>MasterAccount<span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token keyword">int</span> PollActivity<span class="token punctuation">;</span>
    pollfd<span class="token operator">*</span> ptrPollSockets<span class="token punctuation">;</span>
    <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Listen]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span> <span class="token string">"Poll is ready to read incoming connections"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span><span class="token punctuation">(</span>bServerOnline<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>

        ptrPollSockets <span class="token operator">=</span> <span class="token operator">&amp;</span>rgSockets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>bServerOnline<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            PollActivity <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>ptrPollSockets<span class="token punctuation">,</span> rgSockets<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> POLL_DELAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>PollActivity <span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>PollActivity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"tcp-poll"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Listen]"</span><span class="token punctuation">,</span>warning<span class="token punctuation">,</span> <span class="token string">"Could not poll sockets"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>rgSockets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span>  <span class="token comment">//Server received a connection</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">unsigned</span> <span class="token keyword">int</span> uiNewSocket<span class="token punctuation">;</span>
            <span class="token keyword">struct</span> sockaddr_storage SNewClientAddr<span class="token punctuation">;</span>
            socklen_t iNewClientAddr_Size <span class="token operator">=</span> <span class="token keyword">sizeof</span> SNewClientAddr<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>uiNewSocket <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span>uiMasterSocketTCP<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>SNewClientAddr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iNewClientAddr_Size<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"tcp-accept"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Listen]"</span><span class="token punctuation">,</span> warning<span class="token punctuation">,</span> <span class="token string">"Failed to accept client"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{</span>

                <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Listen]"</span><span class="token punctuation">,</span> notification<span class="token punctuation">,</span> <span class="token string">"A client has successfully connected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Remove this later</span>

                <span class="token comment">/*Create a pollfd for new socket*/</span>
                pollfd NewSocket<span class="token punctuation">;</span>
                NewSocket<span class="token punctuation">.</span>fd <span class="token operator">=</span> uiNewSocket<span class="token punctuation">;</span>
                NewSocket<span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>
                rgSockets<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>NewSocket<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">/*Create a new client for socket*/</span>
                soft_client <span class="token function">NewClient</span><span class="token punctuation">(</span>uiNewSocket<span class="token punctuation">,</span> SNewClientAddr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//takes TCP socket and udp address and port</span>

                soft_account InactiveAccount<span class="token punctuation">;</span> <span class="token comment">//Creates a blank account with inactivityand databaseID equals to 0</span>
                NewClient<span class="token punctuation">.</span><span class="token function">set_account</span><span class="token punctuation">(</span>InactiveAccount<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//This does not increment accounts logged in. You must LOG in to do so.</span>
                rgClients<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>NewClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
                rgAccounts<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>InactiveAccount<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">change_status_msg</span><span class="token punctuation">(</span><span class="token string">"&lt;span foreground='green'&gt;&lt;b&gt;Online&lt;/b&gt;&lt;/span&gt; &lt;b&gt;"</span><span class="token operator">+</span><span class="token function">convert_to_str</span><span class="token punctuation">(</span>rgSockets<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"&lt;/b&gt; user(s) connected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">/*Add to Address Watchlist*/</span>
                rgAddressWatch<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>SNewClientAddr<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>rgSockets<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">!=</span> rgClients<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>uiPosition<span class="token punctuation">)</span> rgClients<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>uiPosition <span class="token operator">=</span> i<span class="token punctuation">;</span> <span class="token comment">//Take uiPosition</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>rgSockets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">int</span> read_val<span class="token punctuation">;</span>
                <span class="token keyword">char</span> chBuffer<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>read_val <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">recv</span><span class="token punctuation">(</span>rgSockets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> chBuffer<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>



                    <span class="token comment">/*Players get linked to an account here*/</span>

                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{</span>

                    <span class="token comment">/*Client has disconnected*/</span>
                    <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Listen]"</span><span class="token punctuation">,</span> notification<span class="token punctuation">,</span> <span class="token string">"A client has disconnected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    rgClients<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>status <span class="token operator">=</span> offline<span class="token punctuation">;</span> <span class="token comment">//He will be taken care of in the next step. To keep order</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">/*Sweep disconnected players*/</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>rgClients<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>rgClients<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>status <span class="token operator">==</span> offline<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>rgClients<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>AccountInfo<span class="token punctuation">.</span>status <span class="token operator">==</span> active<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token comment">/*Save the account so far*/</span>
                    <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Listen]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span> <span class="token string">"Client's account was pushed to the save queue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    qSaveAccounts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>rgAccounts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Put in save queue</span>
                <span class="token punctuation">}</span>

                <span class="token function">close</span><span class="token punctuation">(</span>rgClients<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>uiSocketTCP<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Closes their TCP socket</span>

                rgSockets<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>rgSockets<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                rgClients<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>rgClients<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// then remove</span>
                rgAccounts<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>rgAccounts<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//remove accounts whether inactive or not</span>

                <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Listen]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span> <span class="token string">"Client and socket have been removed from polling"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">change_status_msg</span><span class="token punctuation">(</span><span class="token string">"&lt;span foreground='green'&gt;&lt;b&gt;Online&lt;/b&gt;&lt;/span&gt; &lt;b&gt;"</span><span class="token operator">+</span><span class="token function">convert_to_str</span><span class="token punctuation">(</span>rgSockets<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"&lt;/b&gt; user(s) connected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
        <span class="token function">poll</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>CPU_DELAY<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Reduce CPU usage</span>

    <span class="token punctuation">}</span>
    ptrPollSockets <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    my_args <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Listen]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span> <span class="token string">"Thread has exited successfully"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bThreadActive<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 380;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><span id="ezoic-pub-ad-placeholder-110"></span><span class="ezoic-ad leader-1 leader-1110 adtester-container adtester-container-110" data-ez-name="hotexamples_com-leader-1"><span id="div-gpt-ad-hotexamples_com-leader-1-0" ezaw="300" ezah="250" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:250px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-leader-1-0')};</script></span></span><div class="example-item" id="0x12c67e460d3cbe89f208c787dba6db89abd1c9637fd6e0ba60865eec720728f4-184,,245,"><div class="bs-example"><div><div class="bs-example-title">Exemple #5</div><div style="position:absolute;right:15px;top:10px" id="rating_5" data-hash="0x12c67e460d3cbe89f208c787dba6db89abd1c9637fd6e0ba60865eec720728f4" data-area="184,,245,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;5&#39;)" class="rating-up btn btn-success" data-id="rating_5"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;5&#39;)" class="rating-down btn btn-danger" data-id="rating_5"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x12c67e460d3cbe89f208c787dba6db89abd1c9637fd6e0ba60865eec720728f4-184,,245,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x12c67e460d3cbe89f208c787dba6db89abd1c9637fd6e0ba60865eec720728f4&amp;fullName=rgb_cube-master%2Fapps%2Fmtk.c&amp;project=aqakulov%2FFirmware&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Faqakulov%2FFirmware%2Fblob%2Fmaster%2Frgb_cube-master%2Fapps%2Fmtk.c">mtk.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Faqakulov%2FFirmware">aqakulov/Firmware</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="5"><pre class="line-numbers  language-cpp" data-end="245" data-start="185" data-highlight="210"><span class="token keyword">int</span> <span class="token function">read_gps_mtk</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>fd<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>gps_rx_buffer<span class="token punctuation">,</span> <span class="token keyword">int</span> buffer_size<span class="token punctuation">)</span>  <span class="token comment">// returns 1 if the thread should terminate</span>
<span class="token punctuation">{</span>
<span class="token comment">//	printf("in read_gps_mtk\n");</span>
	<span class="token keyword">uint8_t</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">uint8_t</span> c<span class="token punctuation">;</span>

	<span class="token keyword">int</span> rx_count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> gpsRxOverflow <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">struct</span> pollfd fds<span class="token punctuation">;</span>
	fds<span class="token punctuation">.</span>fd <span class="token operator">=</span> <span class="token operator">*</span>fd<span class="token punctuation">;</span>
	fds<span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>

	<span class="token comment">// This blocks the task until there is something on the buffer</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//check if the thread should terminate</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>terminate_gps_thread <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//			printf("terminate_gps_thread=%u ", terminate_gps_thread);</span>
<span class="token comment">//			printf("exiting mtk thread\n");</span>
<span class="token comment">//			fflush(stdout);</span>
			ret <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fds<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token operator">*</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>c<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//				printf("Read %x\n",c);</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>rx_count <span class="token operator">&gt;=</span> buffer_size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// The buffer is already full and we haven't found a valid NMEA sentence.</span>
					<span class="token comment">// Flush the buffer and note the overflow event.</span>
					gpsRxOverflow<span class="token operator">++</span><span class="token punctuation">;</span>
					rx_count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
					<span class="token function">mtk_decode_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

					<span class="token keyword">if</span> <span class="token punctuation">(</span>gps_verbose<span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[gps] Buffer full\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token comment">//gps_rx_buffer[rx_count] = c;</span>
					rx_count<span class="token operator">++</span><span class="token punctuation">;</span>

				<span class="token punctuation">}</span>

				<span class="token keyword">int</span> msg_read <span class="token operator">=</span> <span class="token function">mtk_parse</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> gps_rx_buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>msg_read <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">//			printf("Found sequence\n");</span>
					<span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:525px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 184;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><span id="ezoic-pub-ad-placeholder-111"></span><span class="ezoic-ad large-mobile-banner-1 large-mobile-banner-1111 adtester-container adtester-container-111" data-ez-name="hotexamples_com-large-mobile-banner-1"><span id="div-gpt-ad-hotexamples_com-large-mobile-banner-1-0" ezaw="300" ezah="250" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:250px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-large-mobile-banner-1-0')};</script></span></span><div class="example-item" id="0x126fb4045c7d75e8855a91a5b64493101a28322dc4348b9f105566a3caff195e-606,,946,"><div class="bs-example"><div><div class="bs-example-title">Exemple #6</div><div style="position:absolute;right:15px;top:10px" id="rating_6" data-hash="0x126fb4045c7d75e8855a91a5b64493101a28322dc4348b9f105566a3caff195e" data-area="606,,946,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;6&#39;)" class="rating-up btn btn-success" data-id="rating_6"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;6&#39;)" class="rating-down btn btn-danger" data-id="rating_6"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x126fb4045c7d75e8855a91a5b64493101a28322dc4348b9f105566a3caff195e-606,,946,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x126fb4045c7d75e8855a91a5b64493101a28322dc4348b9f105566a3caff195e&amp;fullName=ofxZmq-master%2Flibs%2Fzmq%2Fzmq.cpp&amp;project=DeadZen%2FCloudI&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FDeadZen%2FCloudI%2Fblob%2Fmaster%2FofxZmq-master%2Flibs%2Fzmq%2Fzmq.cpp">zmq.cpp</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FDeadZen%2FCloudI">DeadZen/CloudI</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="6"><pre class="line-numbers  language-cpp" data-end="946" data-start="607" data-highlight="678"><span class="token keyword">int</span> zmq_poll <span class="token punctuation">(</span>zmq_pollitem_t <span class="token operator">*</span>items_<span class="token punctuation">,</span> <span class="token keyword">int</span> nitems_<span class="token punctuation">,</span> <span class="token keyword">long</span> timeout_<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>items_<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        errno <span class="token operator">=</span> EFAULT<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">if</span> defined ZMQ_POLL_BASED_ON_POLL</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>unlikely <span class="token punctuation">(</span>nitems_ <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        errno <span class="token operator">=</span> EINVAL<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>unlikely <span class="token punctuation">(</span>nitems_ <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout_ <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">if</span> defined ZMQ_HAVE_WINDOWS</span>
        Sleep <span class="token punctuation">(</span>timeout_ <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> timeout_ <span class="token operator">:</span> INFINITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">elif</span> defined ZMQ_HAVE_ANDROID</span>
        usleep <span class="token punctuation">(</span>timeout_ <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
        <span class="token keyword">return</span> usleep <span class="token punctuation">(</span>timeout_ <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
    <span class="token punctuation">}</span>
    zmq<span class="token operator">::</span>clock_t clock<span class="token punctuation">;</span>
    <span class="token keyword">uint64_t</span> now <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">uint64_t</span> end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    pollfd <span class="token operator">*</span>pollfds <span class="token operator">=</span> <span class="token punctuation">(</span>pollfd<span class="token operator">*</span><span class="token punctuation">)</span> malloc <span class="token punctuation">(</span>nitems_ <span class="token operator">*</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span>pollfd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    alloc_assert <span class="token punctuation">(</span>pollfds<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//  Build pollset for poll () system call.</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> nitems_<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">//  If the poll item is a 0MQ socket, we poll on the file descriptor</span>
        <span class="token comment">//  retrieved by the ZMQ_FD socket option.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>socket<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            size_t zmq_fd_size <span class="token operator">=</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span>zmq<span class="token operator">::</span>fd_t<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>zmq_getsockopt <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>socket<span class="token punctuation">,</span> ZMQ_FD<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pollfds <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span>
                <span class="token operator">&amp;</span>zmq_fd_size<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                free <span class="token punctuation">(</span>pollfds<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            pollfds <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">?</span> POLLIN <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//  Else, the poll item is a raw file descriptor. Just convert the</span>
        <span class="token comment">//  events to normal POLLIN/POLLOUT for poll ().</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            pollfds <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">;</span>
            pollfds <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span>
                <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> ZMQ_POLLIN <span class="token operator">?</span> POLLIN <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> ZMQ_POLLOUT <span class="token operator">?</span> POLLOUT <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">bool</span> first_pass <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> nevents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

         <span class="token comment">//  Compute the timeout for the subsequent poll.</span>
         <span class="token keyword">int</span> timeout<span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>first_pass<span class="token punctuation">)</span>
             timeout <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
         <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout_ <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
             timeout <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">else</span>
             timeout <span class="token operator">=</span> end <span class="token operator">-</span> now<span class="token punctuation">;</span>

        <span class="token comment">//  Wait for events.</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> rc <span class="token operator">=</span> poll <span class="token punctuation">(</span>pollfds<span class="token punctuation">,</span> nitems_<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rc <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> errno <span class="token operator">==</span> EINTR<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                free <span class="token punctuation">(</span>pollfds<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            errno_assert <span class="token punctuation">(</span>rc <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//  Check for the events.</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> nitems_<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token comment">//  The poll item is a 0MQ socket. Retrieve pending events</span>
            <span class="token comment">//  using the ZMQ_EVENTS socket option.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>socket<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                size_t zmq_events_size <span class="token operator">=</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">uint32_t</span> zmq_events<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>zmq_getsockopt <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>socket<span class="token punctuation">,</span> ZMQ_EVENTS<span class="token punctuation">,</span> <span class="token operator">&amp;</span>zmq_events<span class="token punctuation">,</span>
                    <span class="token operator">&amp;</span>zmq_events_size<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    free <span class="token punctuation">(</span>pollfds<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> ZMQ_POLLOUT<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                      <span class="token punctuation">(</span>zmq_events <span class="token operator">&amp;</span> ZMQ_POLLOUT<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> ZMQ_POLLOUT<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> ZMQ_POLLIN<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                      <span class="token punctuation">(</span>zmq_events <span class="token operator">&amp;</span> ZMQ_POLLIN<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> ZMQ_POLLIN<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//  Else, the poll item is a raw file descriptor, simply convert</span>
            <span class="token comment">//  the events to zmq_pollitem_t-style format.</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>pollfds <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span>
                    items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> ZMQ_POLLIN<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>pollfds <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLOUT<span class="token punctuation">)</span>
                    items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> ZMQ_POLLOUT<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>pollfds <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> <span class="token operator">~</span><span class="token punctuation">(</span>POLLIN <span class="token operator">|</span> POLLOUT<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> ZMQ_POLLERR<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents<span class="token punctuation">)</span>
                nevents<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//  If timout is zero, exit immediately whether there are events or not.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout_ <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token comment">//  If there are events to return, we can exit immediately.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nevents<span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token comment">//  At this point we are meant to wait for events but there are none.</span>
        <span class="token comment">//  If timeout is infinite we can just loop until we get some events.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout_ <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>first_pass<span class="token punctuation">)</span>
                first_pass <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//  The timeout is finite and there are no events. In the first pass</span>
        <span class="token comment">//  we get a timestamp of when the polling have begun. (We assume that</span>
        <span class="token comment">//  first pass have taken negligible time). We also compute the time</span>
        <span class="token comment">//  when the polling should time out.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>first_pass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            now <span class="token operator">=</span> clock<span class="token punctuation">.</span>now_ms <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            end <span class="token operator">=</span> now <span class="token operator">+</span> timeout_<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">==</span> end<span class="token punctuation">)</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            first_pass <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//  Find out whether timeout have expired.</span>
        now <span class="token operator">=</span> clock<span class="token punctuation">.</span>now_ms <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">&gt;=</span> end<span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    free <span class="token punctuation">(</span>pollfds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> nevents<span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">elif</span> defined ZMQ_POLL_BASED_ON_SELECT</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>unlikely <span class="token punctuation">(</span>nitems_ <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        errno <span class="token operator">=</span> EINVAL<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>unlikely <span class="token punctuation">(</span>nitems_ <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout_ <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">if</span> defined ZMQ_HAVE_WINDOWS</span>
        Sleep <span class="token punctuation">(</span>timeout_ <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> timeout_ <span class="token operator">:</span> INFINITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
        <span class="token keyword">return</span> usleep <span class="token punctuation">(</span>timeout_ <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
    <span class="token punctuation">}</span>
    zmq<span class="token operator">::</span>clock_t clock<span class="token punctuation">;</span>
    <span class="token keyword">uint64_t</span> now <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">uint64_t</span> end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//  Ensure we do not attempt to select () on more than FD_SETSIZE</span>
    <span class="token comment">//  file descriptors.</span>
    zmq_assert <span class="token punctuation">(</span>nitems_ <span class="token operator">&lt;=</span> FD_SETSIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>

    fd_set pollset_in<span class="token punctuation">;</span>
    FD_ZERO <span class="token punctuation">(</span><span class="token operator">&amp;</span>pollset_in<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fd_set pollset_out<span class="token punctuation">;</span>
    FD_ZERO <span class="token punctuation">(</span><span class="token operator">&amp;</span>pollset_out<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fd_set pollset_err<span class="token punctuation">;</span>
    FD_ZERO <span class="token punctuation">(</span><span class="token operator">&amp;</span>pollset_err<span class="token punctuation">)</span><span class="token punctuation">;</span>

    zmq<span class="token operator">::</span>fd_t maxfd <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//  Build the fd_sets for passing to select ().</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> nitems_<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">//  If the poll item is a 0MQ socket we are interested in input on the</span>
        <span class="token comment">//  notification file descriptor retrieved by the ZMQ_FD socket option.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>socket<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            size_t zmq_fd_size <span class="token operator">=</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span>zmq<span class="token operator">::</span>fd_t<span class="token punctuation">)</span><span class="token punctuation">;</span>
            zmq<span class="token operator">::</span>fd_t notify_fd<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>zmq_getsockopt <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>socket<span class="token punctuation">,</span> ZMQ_FD<span class="token punctuation">,</span> <span class="token operator">&amp;</span>notify_fd<span class="token punctuation">,</span>
                <span class="token operator">&amp;</span>zmq_fd_size<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                FD_SET <span class="token punctuation">(</span>notify_fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pollset_in<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>maxfd <span class="token operator">&lt;</span> notify_fd<span class="token punctuation">)</span>
                    maxfd <span class="token operator">=</span> notify_fd<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//  Else, the poll item is a raw file descriptor. Convert the poll item</span>
        <span class="token comment">//  events to the appropriate fd_sets.</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> ZMQ_POLLIN<span class="token punctuation">)</span>
                FD_SET <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pollset_in<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> ZMQ_POLLOUT<span class="token punctuation">)</span>
                FD_SET <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pollset_out<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> ZMQ_POLLERR<span class="token punctuation">)</span>
                FD_SET <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pollset_err<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>maxfd <span class="token operator">&lt;</span> items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">)</span>
                maxfd <span class="token operator">=</span> items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">bool</span> first_pass <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> nevents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    fd_set inset<span class="token punctuation">,</span> outset<span class="token punctuation">,</span> errset<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">//  Compute the timeout for the subsequent poll.</span>
        timeval timeout<span class="token punctuation">;</span>
        timeval <span class="token operator">*</span>ptimeout<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>first_pass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            timeout<span class="token punctuation">.</span>tv_sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            timeout<span class="token punctuation">.</span>tv_usec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            ptimeout <span class="token operator">=</span> <span class="token operator">&amp;</span>timeout<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout_ <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            ptimeout <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            timeout<span class="token punctuation">.</span>tv_sec <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> now<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            timeout<span class="token punctuation">.</span>tv_usec <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> now<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ptimeout <span class="token operator">=</span> <span class="token operator">&amp;</span>timeout<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//  Wait for events. Ignore interrupts if there's infinite timeout.</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            memcpy <span class="token punctuation">(</span><span class="token operator">&amp;</span>inset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pollset_in<span class="token punctuation">,</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span>fd_set<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            memcpy <span class="token punctuation">(</span><span class="token operator">&amp;</span>outset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pollset_out<span class="token punctuation">,</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span>fd_set<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            memcpy <span class="token punctuation">(</span><span class="token operator">&amp;</span>errset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pollset_err<span class="token punctuation">,</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span>fd_set<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">if</span> defined ZMQ_HAVE_WINDOWS</span>
            <span class="token keyword">int</span> rc <span class="token operator">=</span> select <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>inset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>outset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>errset<span class="token punctuation">,</span> ptimeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>unlikely <span class="token punctuation">(</span>rc <span class="token operator">==</span> SOCKET_ERROR<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                errno <span class="token operator">=</span> zmq<span class="token operator">::</span>wsa_error_to_errno <span class="token punctuation">(</span>WSAGetLastError <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                wsa_assert <span class="token punctuation">(</span>errno <span class="token operator">==</span> ENOTSOCK<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
            <span class="token keyword">int</span> rc <span class="token operator">=</span> select <span class="token punctuation">(</span>maxfd <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>inset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>outset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>errset<span class="token punctuation">,</span> ptimeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>unlikely <span class="token punctuation">(</span>rc <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                errno_assert <span class="token punctuation">(</span>errno <span class="token operator">==</span> EINTR <span class="token operator">||</span> errno <span class="token operator">==</span> EBADF<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//  Check for the events.</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> nitems_<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token comment">//  The poll item is a 0MQ socket. Retrieve pending events</span>
            <span class="token comment">//  using the ZMQ_EVENTS socket option.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>socket<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                size_t zmq_events_size <span class="token operator">=</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">uint32_t</span> zmq_events<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>zmq_getsockopt <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>socket<span class="token punctuation">,</span> ZMQ_EVENTS<span class="token punctuation">,</span> <span class="token operator">&amp;</span>zmq_events<span class="token punctuation">,</span>
                      <span class="token operator">&amp;</span>zmq_events_size<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> ZMQ_POLLOUT<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                      <span class="token punctuation">(</span>zmq_events <span class="token operator">&amp;</span> ZMQ_POLLOUT<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> ZMQ_POLLOUT<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> ZMQ_POLLIN<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                      <span class="token punctuation">(</span>zmq_events <span class="token operator">&amp;</span> ZMQ_POLLIN<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> ZMQ_POLLIN<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//  Else, the poll item is a raw file descriptor, simply convert</span>
            <span class="token comment">//  the events to zmq_pollitem_t-style format.</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>FD_ISSET <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>inset<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> ZMQ_POLLIN<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>FD_ISSET <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>outset<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> ZMQ_POLLOUT<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>FD_ISSET <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>errset<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> ZMQ_POLLERR<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>items_ <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents<span class="token punctuation">)</span>
                nevents<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//  If timout is zero, exit immediately whether there are events or not.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout_ <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token comment">//  If there are events to return, we can exit immediately.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nevents<span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token comment">//  At this point we are meant to wait for events but there are none.</span>
        <span class="token comment">//  If timeout is infinite we can just loop until we get some events.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout_ <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>first_pass<span class="token punctuation">)</span>
                first_pass <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//  The timeout is finite and there are no events. In the first pass</span>
        <span class="token comment">//  we get a timestamp of when the polling have begun. (We assume that</span>
        <span class="token comment">//  first pass have taken negligible time). We also compute the time</span>
        <span class="token comment">//  when the polling should time out.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>first_pass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            now <span class="token operator">=</span> clock<span class="token punctuation">.</span>now_ms <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            end <span class="token operator">=</span> now <span class="token operator">+</span> timeout_<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">==</span> end<span class="token punctuation">)</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            first_pass <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//  Find out whether timeout have expired.</span>
        now <span class="token operator">=</span> clock<span class="token punctuation">.</span>now_ms <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">&gt;=</span> end<span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> nevents<span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">else</span></span>
    <span class="token comment">//  Exotic platforms that support neither poll() nor select().</span>
    errno <span class="token operator">=</span> ENOTSUP<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:1491px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 606;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x1262fb0b3bdb987dbbb3c4a09484cbeb0f2f5789e1dc325053a2f1947549d4e6-615,,716,"><div class="bs-example"><div><div class="bs-example-title">Exemple #7</div><div style="position:absolute;right:15px;top:10px" id="rating_7" data-hash="0x1262fb0b3bdb987dbbb3c4a09484cbeb0f2f5789e1dc325053a2f1947549d4e6" data-area="615,,716,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;7&#39;)" class="rating-up btn btn-success" data-id="rating_7"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;7&#39;)" class="rating-down btn btn-danger" data-id="rating_7"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x1262fb0b3bdb987dbbb3c4a09484cbeb0f2f5789e1dc325053a2f1947549d4e6-615,,716,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x1262fb0b3bdb987dbbb3c4a09484cbeb0f2f5789e1dc325053a2f1947549d4e6&amp;fullName=FreeRDP-master%2Flibfreerdp%2Ftls.c&amp;project=MrRecovery%2FFreeRDP&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FMrRecovery%2FFreeRDP%2Fblob%2Fmaster%2FFreeRDP-master%2Flibfreerdp%2Ftls.c">tls.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FMrRecovery%2FFreeRDP">MrRecovery/FreeRDP</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="7"><pre class="line-numbers  language-cpp" data-end="716" data-start="616" data-highlight="656"><span class="token keyword">int</span> <span class="token function">tls_do_handshake</span><span class="token punctuation">(</span>rdpTls<span class="token operator">*</span> tls<span class="token punctuation">,</span> BOOL clientMode<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	CryptoCert cert<span class="token punctuation">;</span>
	<span class="token keyword">int</span> verify_status<span class="token punctuation">,</span> status<span class="token punctuation">;</span>

	<span class="token keyword">do</span>
	<span class="token punctuation">{</span>
<span class="token macro property">#<span class="token directive keyword">ifdef</span> HAVE_POLL_H</span>
		<span class="token keyword">struct</span> pollfd pollfds<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
		<span class="token keyword">struct</span> timeval tv<span class="token punctuation">;</span>
		fd_set rset<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
		<span class="token keyword">int</span> fd<span class="token punctuation">;</span>

		status <span class="token operator">=</span> <span class="token function">BIO_do_handshake</span><span class="token punctuation">(</span>tls<span class="token operator">-&gt;</span>bio<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">BIO_should_retry</span><span class="token punctuation">(</span>tls<span class="token operator">-&gt;</span>bio<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

		<span class="token comment">/* we select() only for read even if we should test both read and write
		 * depending of what have blocked */</span>
		fd <span class="token operator">=</span> <span class="token function">BIO_get_fd</span><span class="token punctuation">(</span>tls<span class="token operator">-&gt;</span>bio<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>fd <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">WLog_ERR</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span>  <span class="token string">"unable to retrieve BIO fd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">ifdef</span> HAVE_POLL_H</span>
		pollfds<span class="token punctuation">.</span>fd <span class="token operator">=</span> fd<span class="token punctuation">;</span>
		pollfds<span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>
		pollfds<span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			status <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pollfds<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>status <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>errno <span class="token operator">==</span> EINTR<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
		<span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rset<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">FD_SET</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rset<span class="token punctuation">)</span><span class="token punctuation">;</span>
		tv<span class="token punctuation">.</span>tv_sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		tv<span class="token punctuation">.</span>tv_usec <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span> <span class="token comment">/* 10ms */</span>

		status <span class="token operator">=</span> <span class="token function">_select</span><span class="token punctuation">(</span>fd <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>rset<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>tv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">WLog_ERR</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span>  <span class="token string">"error during select()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	cert <span class="token operator">=</span> <span class="token function">tls_get_certificate</span><span class="token punctuation">(</span>tls<span class="token punctuation">,</span> clientMode<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cert<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">WLog_ERR</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span>  <span class="token string">"tls_get_certificate failed to return the server certificate."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	tls<span class="token operator">-&gt;</span>Bindings <span class="token operator">=</span> <span class="token function">tls_get_channel_bindings</span><span class="token punctuation">(</span>cert<span class="token operator">-&gt;</span>px509<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tls<span class="token operator">-&gt;</span>Bindings<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">WLog_ERR</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span>  <span class="token string">"unable to retrieve bindings"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		verify_status <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> out<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">crypto_cert_get_public_key</span><span class="token punctuation">(</span>cert<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tls<span class="token operator">-&gt;</span>PublicKey<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tls<span class="token operator">-&gt;</span>PublicKeyLength<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">WLog_ERR</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span>  <span class="token string">"crypto_cert_get_public_key failed to return the server public key."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		verify_status <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> out<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/* Note: server-side NLA needs public keys (keys from us, the server) but no
	 * 		certificate verify
	 */</span>
	verify_status <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>clientMode<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		verify_status <span class="token operator">=</span> <span class="token function">tls_verify_certificate</span><span class="token punctuation">(</span>tls<span class="token punctuation">,</span> cert<span class="token punctuation">,</span> tls<span class="token operator">-&gt;</span>hostname<span class="token punctuation">,</span> tls<span class="token operator">-&gt;</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>verify_status <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">WLog_ERR</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span>  <span class="token string">"certificate not trusted, aborting."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">tls_disconnect</span><span class="token punctuation">(</span>tls<span class="token punctuation">)</span><span class="token punctuation">;</span>
			verify_status <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

out<span class="token operator">:</span>
	<span class="token function">tls_free_certificate</span><span class="token punctuation">(</span>cert<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> verify_status<span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:840px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 615;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x1227e442675cc6ed468d85e6894a7cb889bf5e9a84f0861166392b6f0eb6ceb0-97,,166,"><div class="bs-example"><div><div class="bs-example-title">Exemple #8</div><div style="position:absolute;right:15px;top:10px" id="rating_8" data-hash="0x1227e442675cc6ed468d85e6894a7cb889bf5e9a84f0861166392b6f0eb6ceb0" data-area="97,,166,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;8&#39;)" class="rating-up btn btn-success" data-id="rating_8"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;8&#39;)" class="rating-down btn btn-danger" data-id="rating_8"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x1227e442675cc6ed468d85e6894a7cb889bf5e9a84f0861166392b6f0eb6ceb0-97,,166,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x1227e442675cc6ed468d85e6894a7cb889bf5e9a84f0861166392b6f0eb6ceb0&amp;fullName=lustre-release-master%2Flustre%2Futils%2Fgssd_main_loop.c&amp;project=Xyratex%2Flustre-stable&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FXyratex%2Flustre-stable%2Fblob%2Fmaster%2Flustre-release-master%2Flustre%2Futils%2Fgssd_main_loop.c">gssd_main_loop.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FXyratex%2Flustre-stable">Xyratex/lustre-stable</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="8"><pre class="line-numbers  language-cpp" data-end="166" data-start="98" data-highlight="153"><span class="token keyword">void</span>
<span class="token function">lgssd_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span>			ret<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> sigaction	dn_act<span class="token punctuation">;</span>
	<span class="token keyword">int</span>			fd<span class="token punctuation">;</span>
	time_t			child_check <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	pid_t			child_pid<span class="token punctuation">;</span>

	<span class="token comment">/* Taken from linux/Documentation/dnotify.txt: */</span>
	dn_act<span class="token punctuation">.</span>sa_sigaction <span class="token operator">=</span> dir_notify_handler<span class="token punctuation">;</span>
	<span class="token function">sigemptyset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>dn_act<span class="token punctuation">.</span>sa_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>
	dn_act<span class="token punctuation">.</span>sa_flags <span class="token operator">=</span> SA_SIGINFO<span class="token punctuation">;</span>
	<span class="token function">sigaction</span><span class="token punctuation">(</span>DNOTIFY_SIGNAL<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dn_act<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>pipefs_dir<span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">printerr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"ERROR: failed to open %s: %s\n"</span><span class="token punctuation">,</span>
			 pipefs_dir<span class="token punctuation">,</span> <span class="token function">strerror</span><span class="token punctuation">(</span>errno<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> F_SETSIG<span class="token punctuation">,</span> DNOTIFY_SIGNAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> F_NOTIFY<span class="token punctuation">,</span> DN_CREATE<span class="token operator">|</span>DN_DELETE<span class="token operator">|</span>DN_MODIFY<span class="token operator">|</span>DN_MULTISHOT<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">init_client_list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>dir_changed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			dir_changed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token function">printerr</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"pipefs root dir changed\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">update_client_list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">printerr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"ERROR: couldn't update "</span>
					 <span class="token string">"client list\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">goto</span> out<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token comment">/* every 5s cleanup possible zombies of child processes */</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">-</span> child_check <span class="token operator">&gt;=</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">printerr</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"check zombie children...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				child_pid <span class="token operator">=</span> <span class="token function">waitpid</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> WNOHANG<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>child_pid <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
					<span class="token keyword">break</span><span class="token punctuation">;</span>

				<span class="token function">printerr</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"terminate zombie child: %d\n"</span><span class="token punctuation">,</span>
					 child_pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			child_check <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">/* race condition here: dir_changed could be set before we
		 * enter the poll, and we'd never notice if it weren't for the
		 * timeout. */</span>
		ret <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>pollarray<span class="token punctuation">,</span> pollsize<span class="token punctuation">,</span> POLL_MILLISECS<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>errno <span class="token operator">!=</span> EINTR<span class="token punctuation">)</span>
				<span class="token function">printerr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>
					 <span class="token string">"WARNING: error return from poll\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">/* timeout */</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">/* ret &gt; 0 */</span>
			<span class="token function">scan_poll_results</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
out<span class="token operator">:</span>
	<span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:1155px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 97;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x12235d664eedeef666730c5bd0f62f25a27bdc2bd7350268c9fff9bfec56bead-130,,190,"><div class="bs-example"><div><div class="bs-example-title">Exemple #9</div><div style="position:absolute;right:15px;top:10px" id="rating_9" data-hash="0x12235d664eedeef666730c5bd0f62f25a27bdc2bd7350268c9fff9bfec56bead" data-area="130,,190,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;9&#39;)" class="rating-up btn btn-success" data-id="rating_9"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;9&#39;)" class="rating-down btn btn-danger" data-id="rating_9"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x12235d664eedeef666730c5bd0f62f25a27bdc2bd7350268c9fff9bfec56bead-130,,190,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x12235d664eedeef666730c5bd0f62f25a27bdc2bd7350268c9fff9bfec56bead&amp;fullName=android_device_motorola_msm8960-common-master%2Fmodules%2Fevents.c&amp;project=5idaidai%2Fandroid_device_xiaomi_qcom-common&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2F5idaidai%2Fandroid_device_xiaomi_qcom-common%2Fblob%2Fmaster%2Fandroid_device_motorola_msm8960-common-master%2Fmodules%2Fevents.c">events.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2F5idaidai%2Fandroid_device_xiaomi_qcom-common">5idaidai/android_device_xiaomi_qcom-common</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="9"><pre class="line-numbers  language-cpp" data-end="190" data-start="131" data-highlight="135"><span class="token keyword">int</span> <span class="token function">ev_get</span><span class="token punctuation">(</span><span class="token keyword">int</span> timeout_ms<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> r<span class="token punctuation">,</span> i<span class="token punctuation">;</span>

	r <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>ev_fds<span class="token punctuation">,</span> ev_count<span class="token punctuation">,</span> timeout_ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>ev_count<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ev_fds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token keyword">continue</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>ev_type<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> EV_TYPE_KEYBOARD<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">struct</span> input_event ev<span class="token punctuation">;</span>
			r <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>ev_fds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ev<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"keyboard event: (%x,%x,%x)\n"</span><span class="token punctuation">,</span> ev<span class="token punctuation">.</span>type<span class="token punctuation">,</span> ev<span class="token punctuation">.</span>code<span class="token punctuation">,</span> ev<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

				<span class="token comment">/* POWER key */</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>type <span class="token operator">==</span> EV_KEY<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>code <span class="token operator">==</span> EV_POWER_KEY_CODE<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>value <span class="token operator">==</span> EV_KEY_VALUE_DOWN<span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token keyword">return</span> EVENT_POWER_KEY_DOWN<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>type <span class="token operator">==</span> EV_KEY<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>code <span class="token operator">==</span> EV_POWER_KEY_CODE<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>value <span class="token operator">==</span> EV_KEY_VALUE_UP<span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token keyword">return</span> EVENT_POWER_KEY_UP<span class="token punctuation">;</span>

				<span class="token comment">/* VOLUMEDOWN key */</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>type <span class="token operator">==</span> EV_KEY<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>code <span class="token operator">==</span> EV_VOLUMEDOWN_KEY_CODE<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>value <span class="token operator">==</span> EV_KEY_VALUE_DOWN<span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token keyword">return</span> EVENT_VOLUMEDOWN_KEY_DOWN<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>type <span class="token operator">==</span> EV_KEY<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>code <span class="token operator">==</span> EV_VOLUMEDOWN_KEY_CODE<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>value <span class="token operator">==</span> EV_KEY_VALUE_UP<span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token keyword">return</span> EVENT_VOLUMEDOWN_KEY_UP<span class="token punctuation">;</span>

				<span class="token comment">/* VOLUMEUP key */</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>type <span class="token operator">==</span> EV_KEY<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>code <span class="token operator">==</span> EV_VOLUMEUP_KEY_CODE<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>value <span class="token operator">==</span> EV_KEY_VALUE_DOWN<span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token keyword">return</span> EVENT_VOLUMEUP_KEY_DOWN<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>type <span class="token operator">==</span> EV_KEY<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>code <span class="token operator">==</span> EV_VOLUMEUP_KEY_CODE<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>value <span class="token operator">==</span> EV_KEY_VALUE_UP<span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token keyword">return</span> EVENT_VOLUMEUP_KEY_UP<span class="token punctuation">;</span>

				<span class="token comment">/* CAMERA key */</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>type <span class="token operator">==</span> EV_KEY<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>code <span class="token operator">==</span> EV_CAMERA_KEY_CODE<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>value <span class="token operator">==</span> EV_KEY_VALUE_DOWN<span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token keyword">return</span> EVENT_CAMERA_KEY_DOWN<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>type <span class="token operator">==</span> EV_KEY<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>code <span class="token operator">==</span> EV_CAMERA_KEY_CODE<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ev<span class="token punctuation">.</span>value <span class="token operator">==</span> EV_KEY_VALUE_UP<span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token keyword">return</span> EVENT_CAMERA_KEY_UP<span class="token punctuation">;</span>

				<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ev_type<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> EV_TYPE_UEVENT<span class="token punctuation">)</span> <span class="token punctuation">{</span>

			<span class="token keyword">char</span> msg<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token function">recv</span><span class="token punctuation">(</span>ev_fds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
				<span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> CHARGER_DRIVER<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token function">ALOGD</span><span class="token punctuation">(</span><span class="token string">"pm8921_battery UEVENT msg : %s\n"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> EVENT_BATTERY<span class="token punctuation">;</span>

			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:84px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 130;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x115b09148f8222ad526251ff20753cbb0d82745063ae03c6f53a2358b94bd0cc-143,,322,"><div class="bs-example"><div><div class="bs-example-title">Exemple #10</div><div style="position:absolute;right:15px;top:10px" id="rating_10" data-hash="0x115b09148f8222ad526251ff20753cbb0d82745063ae03c6f53a2358b94bd0cc" data-area="143,,322,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;10&#39;)" class="rating-up btn btn-success" data-id="rating_10"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;10&#39;)" class="rating-down btn btn-danger" data-id="rating_10"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x115b09148f8222ad526251ff20753cbb0d82745063ae03c6f53a2358b94bd0cc-143,,322,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x115b09148f8222ad526251ff20753cbb0d82745063ae03c6f53a2358b94bd0cc&amp;fullName=curl-master%2Fselect.c&amp;project=kevinw%2Fcurl&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevinw%2Fcurl%2Fblob%2Fmaster%2Fcurl-master%2Fselect.c">select.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevinw%2Fcurl">kevinw/curl</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="10"><pre class="line-numbers  language-cpp" data-end="322" data-start="144" data-highlight="218"><span class="token comment">/*
 * This is an internal function used for waiting for read or write
 * events on a pair of file descriptors.  It uses poll() when a fine
 * poll() is available, in order to avoid limits with FD_SETSIZE,
 * otherwise select() is used.  An error is returned if select() is
 * being used and a file descriptor is too large for FD_SETSIZE.
 * A negative timeout value makes this function wait indefinitely,
 * unles no valid file descriptor is given, when this happens the
 * negative timeout is ignored and the function times out immediately.
 * When compiled with CURL_ACKNOWLEDGE_EINTR defined, EINTR condition
 * is honored and function might exit early without awaiting timeout,
 * otherwise EINTR will be ignored.
 *
 * Return values:
 *   -1 = system call error or fd &gt;= FD_SETSIZE
 *    0 = timeout
 *    CURL_CSELECT_IN | CURL_CSELECT_OUT | CURL_CSELECT_ERR
 */</span>
<span class="token keyword">int</span> <span class="token function">Curl_socket_ready</span><span class="token punctuation">(</span>curl_socket_t readfd<span class="token punctuation">,</span> curl_socket_t writefd<span class="token punctuation">,</span>
                      <span class="token keyword">int</span> timeout_ms<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token macro property">#<span class="token directive keyword">ifdef</span> HAVE_POLL_FINE</span>
  <span class="token keyword">struct</span> pollfd pfd<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> num<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
  <span class="token keyword">struct</span> timeval pending_tv<span class="token punctuation">;</span>
  <span class="token keyword">struct</span> timeval <span class="token operator">*</span>ptimeout<span class="token punctuation">;</span>
  fd_set fds_read<span class="token punctuation">;</span>
  fd_set fds_write<span class="token punctuation">;</span>
  fd_set fds_err<span class="token punctuation">;</span>
  curl_socket_t maxfd<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
  <span class="token keyword">struct</span> timeval initial_tv <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> pending_ms <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> error<span class="token punctuation">;</span>
  <span class="token keyword">int</span> r<span class="token punctuation">;</span>
  <span class="token keyword">int</span> ret<span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>readfd <span class="token operator">==</span> CURL_SOCKET_BAD<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>writefd <span class="token operator">==</span> CURL_SOCKET_BAD<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r <span class="token operator">=</span> <span class="token function">wait_ms</span><span class="token punctuation">(</span>timeout_ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> r<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/* Avoid initial timestamp, avoid gettimeofday() call, when elapsed
     time in this function does not need to be measured. This happens
     when function is called with a zero timeout or a negative timeout
     value indicating a blocking call should be performed. */</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>timeout_ms <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pending_ms <span class="token operator">=</span> timeout_ms<span class="token punctuation">;</span>
    initial_tv <span class="token operator">=</span> <span class="token function">curlx_tvnow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">ifdef</span> HAVE_POLL_FINE</span>

  num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>readfd <span class="token operator">!=</span> CURL_SOCKET_BAD<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pfd<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> readfd<span class="token punctuation">;</span>
    pfd<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLRDNORM<span class="token operator">|</span>POLLIN<span class="token operator">|</span>POLLRDBAND<span class="token operator">|</span>POLLPRI<span class="token punctuation">;</span>
    pfd<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    num<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>writefd <span class="token operator">!=</span> CURL_SOCKET_BAD<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pfd<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> writefd<span class="token punctuation">;</span>
    pfd<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLWRNORM<span class="token operator">|</span>POLLOUT<span class="token punctuation">;</span>
    pfd<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    num<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timeout_ms <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
      pending_ms <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>timeout_ms<span class="token punctuation">)</span>
      pending_ms <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    r <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>pfd<span class="token punctuation">,</span> num<span class="token punctuation">,</span> pending_ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    error <span class="token operator">=</span> SOCKERRNO<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error <span class="token operator">&amp;&amp;</span> error_not_EINTR<span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timeout_ms <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pending_ms <span class="token operator">=</span> timeout_ms <span class="token operator">-</span> elapsed_ms<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>pending_ms <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

  ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>readfd <span class="token operator">!=</span> CURL_SOCKET_BAD<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>pfd<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> <span class="token punctuation">(</span>POLLRDNORM<span class="token operator">|</span>POLLIN<span class="token operator">|</span>POLLERR<span class="token operator">|</span>POLLHUP<span class="token punctuation">)</span><span class="token punctuation">)</span>
      ret <span class="token operator">|=</span> CURL_CSELECT_IN<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>pfd<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> <span class="token punctuation">(</span>POLLRDBAND<span class="token operator">|</span>POLLPRI<span class="token operator">|</span>POLLNVAL<span class="token punctuation">)</span><span class="token punctuation">)</span>
      ret <span class="token operator">|=</span> CURL_CSELECT_ERR<span class="token punctuation">;</span>
    num<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>writefd <span class="token operator">!=</span> CURL_SOCKET_BAD<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>pfd<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> <span class="token punctuation">(</span>POLLWRNORM<span class="token operator">|</span>POLLOUT<span class="token punctuation">)</span><span class="token punctuation">)</span>
      ret <span class="token operator">|=</span> CURL_CSELECT_OUT<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>pfd<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> <span class="token punctuation">(</span>POLLERR<span class="token operator">|</span>POLLHUP<span class="token operator">|</span>POLLNVAL<span class="token punctuation">)</span><span class="token punctuation">)</span>
      ret <span class="token operator">|=</span> CURL_CSELECT_ERR<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> ret<span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">else</span>  </span><span class="token comment">/* HAVE_POLL_FINE */</span>

  <span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fds_err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  maxfd <span class="token operator">=</span> <span class="token punctuation">(</span>curl_socket_t<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fds_read<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>readfd <span class="token operator">!=</span> CURL_SOCKET_BAD<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">VERIFY_SOCK</span><span class="token punctuation">(</span>readfd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">FD_SET</span><span class="token punctuation">(</span>readfd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_read<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">FD_SET</span><span class="token punctuation">(</span>readfd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    maxfd <span class="token operator">=</span> readfd<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fds_write<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>writefd <span class="token operator">!=</span> CURL_SOCKET_BAD<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">VERIFY_SOCK</span><span class="token punctuation">(</span>writefd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">FD_SET</span><span class="token punctuation">(</span>writefd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_write<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">FD_SET</span><span class="token punctuation">(</span>writefd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>writefd <span class="token operator">&gt;</span> maxfd<span class="token punctuation">)</span>
      maxfd <span class="token operator">=</span> writefd<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  ptimeout <span class="token operator">=</span> <span class="token punctuation">(</span>timeout_ms <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant">NULL</span> <span class="token operator">:</span> <span class="token operator">&amp;</span>pending_tv<span class="token punctuation">;</span>

  <span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timeout_ms <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pending_tv<span class="token punctuation">.</span>tv_sec <span class="token operator">=</span> pending_ms <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">;</span>
      pending_tv<span class="token punctuation">.</span>tv_usec <span class="token operator">=</span> <span class="token punctuation">(</span>pending_ms <span class="token operator">%</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>timeout_ms<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pending_tv<span class="token punctuation">.</span>tv_sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      pending_tv<span class="token punctuation">.</span>tv_usec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    r <span class="token operator">=</span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>maxfd <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_read<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_write<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_err<span class="token punctuation">,</span> ptimeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    error <span class="token operator">=</span> SOCKERRNO<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error <span class="token operator">&amp;&amp;</span> error_not_EINTR<span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timeout_ms <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pending_ms <span class="token operator">=</span> timeout_ms <span class="token operator">-</span> elapsed_ms<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>pending_ms <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

  ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>readfd <span class="token operator">!=</span> CURL_SOCKET_BAD<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>readfd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_read<span class="token punctuation">)</span><span class="token punctuation">)</span>
      ret <span class="token operator">|=</span> CURL_CSELECT_IN<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>readfd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_err<span class="token punctuation">)</span><span class="token punctuation">)</span>
      ret <span class="token operator">|=</span> CURL_CSELECT_ERR<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>writefd <span class="token operator">!=</span> CURL_SOCKET_BAD<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>writefd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_write<span class="token punctuation">)</span><span class="token punctuation">)</span>
      ret <span class="token operator">|=</span> CURL_CSELECT_OUT<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>writefd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_err<span class="token punctuation">)</span><span class="token punctuation">)</span>
      ret <span class="token operator">|=</span> CURL_CSELECT_ERR<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> ret<span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">endif</span>  </span><span class="token comment">/* HAVE_POLL_FINE */</span>

<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:1554px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 143;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x1117bfdcb7246d2a1af1e233a04d2ccd06df20df12e7445d7a2ddbbef627b93c-312,,315,"><div class="bs-example"><div><div class="bs-example-title">Exemple #11</div><div style="position:absolute;right:15px;top:10px" id="rating_11" data-hash="0x1117bfdcb7246d2a1af1e233a04d2ccd06df20df12e7445d7a2ddbbef627b93c" data-area="312,,315,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;11&#39;)" class="rating-up btn btn-success" data-id="rating_11"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;11&#39;)" class="rating-down btn btn-danger" data-id="rating_11"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x1117bfdcb7246d2a1af1e233a04d2ccd06df20df12e7445d7a2ddbbef627b93c-312,,315,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x1117bfdcb7246d2a1af1e233a04d2ccd06df20df12e7445d7a2ddbbef627b93c&amp;fullName=engine%2Flib%2Fbgfx%2Fcommon%2Fentry.cpp&amp;project=JimmyBenKlieve%2FTorque6&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FJimmyBenKlieve%2FTorque6%2Fblob%2Fmaster%2Fengine%2Flib%2Fbgfx%2Fcommon%2Fentry.cpp">entry.cpp</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FJimmyBenKlieve%2FTorque6">JimmyBenKlieve/Torque6</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="11"><pre class="line-numbers  language-cpp" data-end="315" data-start="313" data-highlight="314">				<span class="token function">SE</span><span class="token punctuation">(</span>WindowHandle _handle<span class="token punctuation">)</span>
					<span class="token operator">:</span> <span class="token function">m_ev</span><span class="token punctuation">(</span><span class="token function">poll</span><span class="token punctuation">(</span>_handle<span class="token punctuation">)</span> <span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
				<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:21px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 312;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x1117bfdcb7246d2a1af1e233a04d2ccd06df20df12e7445d7a2ddbbef627b93c-190,,190,"><div class="bs-example"><div><div class="bs-example-title">Exemple #12</div><div style="position:absolute;right:15px;top:10px" id="rating_12" data-hash="0x1117bfdcb7246d2a1af1e233a04d2ccd06df20df12e7445d7a2ddbbef627b93c" data-area="190,,190,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;12&#39;)" class="rating-up btn btn-success" data-id="rating_12"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;12&#39;)" class="rating-down btn btn-danger" data-id="rating_12"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x1117bfdcb7246d2a1af1e233a04d2ccd06df20df12e7445d7a2ddbbef627b93c-190,,190,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x1117bfdcb7246d2a1af1e233a04d2ccd06df20df12e7445d7a2ddbbef627b93c&amp;fullName=engine%2Flib%2Fbgfx%2Fcommon%2Fentry.cpp&amp;project=JimmyBenKlieve%2FTorque6&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FJimmyBenKlieve%2FTorque6%2Fblob%2Fmaster%2Fengine%2Flib%2Fbgfx%2Fcommon%2Fentry.cpp">entry.cpp</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FJimmyBenKlieve%2FTorque6">JimmyBenKlieve/Torque6</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="12"><pre class="line-numbers  language-cpp" data-end="190" data-start="191" data-highlight="191">			<span class="token keyword">struct</span> SE <span class="token punctuation">{</span> <span class="token keyword">const</span> Event<span class="token operator">*</span> m_ev<span class="token punctuation">;</span> <span class="token function">SE</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_ev</span><span class="token punctuation">(</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">~</span><span class="token function">SE</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">!=</span> m_ev<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">release</span><span class="token punctuation">(</span>m_ev<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> scopeEvent<span class="token punctuation">;</span><div class="line-highlight" style="height: 21px;top:0px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 190;padding-top: 14px;line-height: 21px"><span></span></span></pre></div></figure></div><div class="example-item" id="0x11069ef2b5667b6db31ec1f7d68b2cb3e94f0d9ce3762ba752a65ef3484c1a49-17,,121,"><div class="bs-example"><div><div class="bs-example-title">Exemple #13</div><div style="position:absolute;right:15px;top:10px" id="rating_13" data-hash="0x11069ef2b5667b6db31ec1f7d68b2cb3e94f0d9ce3762ba752a65ef3484c1a49" data-area="17,,121,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;13&#39;)" class="rating-up btn btn-success" data-id="rating_13"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;13&#39;)" class="rating-down btn btn-danger" data-id="rating_13"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x11069ef2b5667b6db31ec1f7d68b2cb3e94f0d9ce3762ba752a65ef3484c1a49-17,,121,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x11069ef2b5667b6db31ec1f7d68b2cb3e94f0d9ce3762ba752a65ef3484c1a49&amp;fullName=test-chat.c&amp;project=adhideguchi%2Fkdbus&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fadhideguchi%2Fkdbus%2Fblob%2Fmaster%2Ftest-chat.c">test-chat.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fadhideguchi%2Fkdbus">adhideguchi/kdbus</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="13"><pre class="line-numbers  language-cpp" data-end="121" data-start="18" data-highlight="83"><span class="token keyword">int</span> <span class="token function">kdbus_test_chat</span><span class="token punctuation">(</span><span class="token keyword">struct</span> kdbus_test_env <span class="token operator">*</span>env<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> ret<span class="token punctuation">,</span> cookie<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> kdbus_conn <span class="token operator">*</span>conn_a<span class="token punctuation">,</span> <span class="token operator">*</span>conn_b<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> pollfd fds<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">uint64_t</span> flags<span class="token punctuation">;</span>
	<span class="token keyword">int</span> count<span class="token punctuation">;</span>

	conn_a <span class="token operator">=</span> <span class="token function">kdbus_hello</span><span class="token punctuation">(</span>env<span class="token operator">-&gt;</span>buspath<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	conn_b <span class="token operator">=</span> <span class="token function">kdbus_hello</span><span class="token punctuation">(</span>env<span class="token operator">-&gt;</span>buspath<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>conn_a <span class="token operator">&amp;&amp;</span> conn_b<span class="token punctuation">)</span><span class="token punctuation">;</span>

	flags <span class="token operator">=</span> KDBUS_NAME_ALLOW_REPLACEMENT<span class="token punctuation">;</span>
	ret <span class="token operator">=</span> <span class="token function">kdbus_name_acquire</span><span class="token punctuation">(</span>conn_a<span class="token punctuation">,</span> <span class="token string">"foo.bar.test"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">kdbus_name_acquire</span><span class="token punctuation">(</span>conn_a<span class="token punctuation">,</span> <span class="token string">"foo.bar.baz"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	flags <span class="token operator">=</span> KDBUS_NAME_QUEUE<span class="token punctuation">;</span>
	ret <span class="token operator">=</span> <span class="token function">kdbus_name_acquire</span><span class="token punctuation">(</span>conn_b<span class="token punctuation">,</span> <span class="token string">"foo.bar.baz"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">kdbus_name_acquire</span><span class="token punctuation">(</span>conn_a<span class="token punctuation">,</span> <span class="token string">"foo.bar.double"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">kdbus_name_acquire</span><span class="token punctuation">(</span>conn_a<span class="token punctuation">,</span> <span class="token string">"foo.bar.double"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token operator">-</span>EALREADY<span class="token punctuation">)</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">kdbus_name_release</span><span class="token punctuation">(</span>conn_a<span class="token punctuation">,</span> <span class="token string">"foo.bar.double"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">kdbus_name_release</span><span class="token punctuation">(</span>conn_a<span class="token punctuation">,</span> <span class="token string">"foo.bar.double"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token operator">-</span>ESRCH<span class="token punctuation">)</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">kdbus_list</span><span class="token punctuation">(</span>conn_b<span class="token punctuation">,</span> KDBUS_LIST_UNIQUE <span class="token operator">|</span>
				 KDBUS_LIST_NAMES  <span class="token operator">|</span>
				 KDBUS_LIST_QUEUED <span class="token operator">|</span>
				 KDBUS_LIST_ACTIVATORS<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">kdbus_add_match_empty</span><span class="token punctuation">(</span>conn_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">kdbus_add_match_empty</span><span class="token punctuation">(</span>conn_b<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	cookie <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	ret <span class="token operator">=</span> <span class="token function">kdbus_msg_send</span><span class="token punctuation">(</span>conn_b<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0xc0000000</span> <span class="token operator">|</span> cookie<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
			     KDBUS_DST_ID_BROADCAST<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	fds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> conn_a<span class="token operator">-&gt;</span>fd<span class="token punctuation">;</span>
	fds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> conn_b<span class="token operator">-&gt;</span>fd<span class="token punctuation">;</span>

	<span class="token function">kdbus_printf</span><span class="token punctuation">(</span><span class="token string">"-- entering poll loop ...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">;</span> count<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">int</span> i<span class="token punctuation">,</span> nfds <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>fds<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>fds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nfds<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			fds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN <span class="token operator">|</span> POLLPRI <span class="token operator">|</span> POLLHUP<span class="token punctuation">;</span>
			fds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		ret <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>fds<span class="token punctuation">,</span> nfds<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>fds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span>
				<span class="token function">kdbus_name_release</span><span class="token punctuation">(</span>conn_a<span class="token punctuation">,</span> <span class="token string">"foo.bar.baz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			ret <span class="token operator">=</span> <span class="token function">kdbus_msg_recv</span><span class="token punctuation">(</span>conn_a<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			ret <span class="token operator">=</span> <span class="token function">kdbus_msg_send</span><span class="token punctuation">(</span>conn_a<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
					     <span class="token number">0xc0000000</span> <span class="token operator">|</span> cookie<span class="token operator">++</span><span class="token punctuation">,</span>
					     <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> conn_b<span class="token operator">-&gt;</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>fds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			ret <span class="token operator">=</span> <span class="token function">kdbus_msg_recv</span><span class="token punctuation">(</span>conn_b<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			ret <span class="token operator">=</span> <span class="token function">kdbus_msg_send</span><span class="token punctuation">(</span>conn_b<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
					     <span class="token number">0xc0000000</span> <span class="token operator">|</span> cookie<span class="token operator">++</span><span class="token punctuation">,</span>
					     <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> conn_a<span class="token operator">-&gt;</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		ret <span class="token operator">=</span> <span class="token function">kdbus_list</span><span class="token punctuation">(</span>conn_b<span class="token punctuation">,</span> KDBUS_LIST_UNIQUE <span class="token operator">|</span>
					 KDBUS_LIST_NAMES  <span class="token operator">|</span>
					 KDBUS_LIST_QUEUED <span class="token operator">|</span>
					 KDBUS_LIST_ACTIVATORS<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">ASSERT_RETURN</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">kdbus_printf</span><span class="token punctuation">(</span><span class="token string">"-- closing bus connections\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">kdbus_conn_free</span><span class="token punctuation">(</span>conn_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">kdbus_conn_free</span><span class="token punctuation">(</span>conn_b<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> TEST_OK<span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:1365px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 17;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x1104b40013f0a9be52ff16e50ad5387f8c7e8c9d8f6b4df790f40dc8490683f8-724,,789,"><div class="bs-example"><div><div class="bs-example-title">Exemple #14</div><div style="position:absolute;right:15px;top:10px" id="rating_14" data-hash="0x1104b40013f0a9be52ff16e50ad5387f8c7e8c9d8f6b4df790f40dc8490683f8" data-area="724,,789,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;14&#39;)" class="rating-up btn btn-success" data-id="rating_14"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;14&#39;)" class="rating-down btn btn-danger" data-id="rating_14"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x1104b40013f0a9be52ff16e50ad5387f8c7e8c9d8f6b4df790f40dc8490683f8-724,,789,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x1104b40013f0a9be52ff16e50ad5387f8c7e8c9d8f6b4df790f40dc8490683f8&amp;fullName=PX4Firmware-master%2Fsrc%2Fdrivers%2Fmb12xx.cpp&amp;project=30rasheed%2Fx-VTOLdrone&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2F30rasheed%2Fx-VTOLdrone%2Fblob%2Fmaster%2FPX4Firmware-master%2Fsrc%2Fdrivers%2Fmb12xx.cpp">mb12xx.cpp</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2F30rasheed%2Fx-VTOLdrone">30rasheed/x-VTOLdrone</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="14"><pre class="line-numbers  language-cpp" data-end="789" data-start="725" data-highlight="766"><span class="token comment">/**
 * Perform some basic functional tests on the driver;
 * make sure we can collect data from the sensor in polled
 * and automatic modes.
 */</span>
<span class="token keyword">void</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> range_finder_report report<span class="token punctuation">;</span>
	ssize_t sz<span class="token punctuation">;</span>
	<span class="token keyword">int</span> ret<span class="token punctuation">;</span>

	<span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>MB12XX_DEVICE_PATH<span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>fd <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">err</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"%s open failed (try 'mb12xx start' if the driver is not running"</span><span class="token punctuation">,</span> MB12XX_DEVICE_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/* do a simple demand read */</span>
	sz <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>report<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>report<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>sz <span class="token operator">!=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>report<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">err</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"immediate read failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">warnx</span><span class="token punctuation">(</span><span class="token string">"single read"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">warnx</span><span class="token punctuation">(</span><span class="token string">"measurement: %0.2f m"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>report<span class="token punctuation">.</span>distance<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">warnx</span><span class="token punctuation">(</span><span class="token string">"time:        %lld"</span><span class="token punctuation">,</span> report<span class="token punctuation">.</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/* start the sensor polling at 2Hz */</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>OK <span class="token operator">!=</span> <span class="token function">ioctl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> SENSORIOCSPOLLRATE<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">errx</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"failed to set 2Hz poll rate"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/* read the sensor 5x and report each value */</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">struct</span> pollfd fds<span class="token punctuation">;</span>

		<span class="token comment">/* wait for data to be ready */</span>
		fds<span class="token punctuation">.</span>fd <span class="token operator">=</span> fd<span class="token punctuation">;</span>
		fds<span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>
		ret <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fds<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">errx</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"timed out waiting for sensor data"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">/* now go get it */</span>
		sz <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>report<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>report<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>sz <span class="token operator">!=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>report<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">err</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"periodic read failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">warnx</span><span class="token punctuation">(</span><span class="token string">"periodic read %u"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">warnx</span><span class="token punctuation">(</span><span class="token string">"measurement: %0.3f"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>report<span class="token punctuation">.</span>distance<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">warnx</span><span class="token punctuation">(</span><span class="token string">"time:        %lld"</span><span class="token punctuation">,</span> report<span class="token punctuation">.</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/* reset the sensor polling to default rate */</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>OK <span class="token operator">!=</span> <span class="token function">ioctl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> SENSORIOCSPOLLRATE<span class="token punctuation">,</span> SENSOR_POLLRATE_DEFAULT<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">errx</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"failed to set default poll rate"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">errx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"PASS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:861px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 724;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x10b6548bc907c06614aa997db5bbf3712658b6e2cba47c2f61491c520cbe26ec-32,,114,"><div class="bs-example"><div><div class="bs-example-title">Exemple #15</div><div style="position:absolute;right:15px;top:10px" id="rating_15" data-hash="0x10b6548bc907c06614aa997db5bbf3712658b6e2cba47c2f61491c520cbe26ec" data-area="32,,114,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;15&#39;)" class="rating-up btn btn-success" data-id="rating_15"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;15&#39;)" class="rating-down btn btn-danger" data-id="rating_15"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x10b6548bc907c06614aa997db5bbf3712658b6e2cba47c2f61491c520cbe26ec-32,,114,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x10b6548bc907c06614aa997db5bbf3712658b6e2cba47c2f61491c520cbe26ec&amp;fullName=erydb-master%2Fsrc%2Fasync_example.c&amp;project=hans511002%2Ferydb&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fhans511002%2Ferydb%2Fblob%2Fmaster%2Ferydb-master%2Fsrc%2Fasync_example.c">async_example.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fhans511002%2Ferydb">hans511002/erydb</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="15"><pre class="line-numbers  language-cpp" data-end="114" data-start="33" data-highlight="93"><span class="token keyword">static</span> <span class="token keyword">int</span>
<span class="token function">wait_for_mysql</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>mysql<span class="token punctuation">,</span> <span class="token keyword">int</span> status<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token macro property">#<span class="token directive keyword">ifdef</span> __WIN__</span>
  fd_set rs<span class="token punctuation">,</span> ws<span class="token punctuation">,</span> es<span class="token punctuation">;</span>
  <span class="token keyword">int</span> res<span class="token punctuation">;</span>
  <span class="token keyword">struct</span> timeval tv<span class="token punctuation">,</span> <span class="token operator">*</span>timeout<span class="token punctuation">;</span>
  my_socket s<span class="token operator">=</span> <span class="token function">mysql_get_socket</span><span class="token punctuation">(</span>mysql<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ws<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>es<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&amp;</span> MYSQL_WAIT_READ<span class="token punctuation">)</span>
    <span class="token function">FD_SET</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&amp;</span> MYSQL_WAIT_WRITE<span class="token punctuation">)</span>
    <span class="token function">FD_SET</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ws<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&amp;</span> MYSQL_WAIT_EXCEPT<span class="token punctuation">)</span>
    <span class="token function">FD_SET</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>es<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&amp;</span> MYSQL_WAIT_TIMEOUT<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    tv<span class="token punctuation">.</span>tv_sec<span class="token operator">=</span> <span class="token function">mysql_get_timeout_value</span><span class="token punctuation">(</span>mysql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    tv<span class="token punctuation">.</span>tv_usec<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    timeout<span class="token operator">=</span> <span class="token operator">&amp;</span>tv<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
    timeout<span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
  res<span class="token operator">=</span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>rs<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ws<span class="token punctuation">,</span> <span class="token operator">&amp;</span>es<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> MYSQL_WAIT_TIMEOUT<span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> SOCKET_ERROR<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token comment">/*
      In a real event framework, we should handle errors and re-try the select.
    */</span>
    <span class="token keyword">return</span> MYSQL_WAIT_TIMEOUT<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">int</span> status<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rs<span class="token punctuation">)</span><span class="token punctuation">)</span>
      status<span class="token operator">|=</span> MYSQL_WAIT_READ<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ws<span class="token punctuation">)</span><span class="token punctuation">)</span>
      status<span class="token operator">|=</span> MYSQL_WAIT_WRITE<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>es<span class="token punctuation">)</span><span class="token punctuation">)</span>
      status<span class="token operator">|=</span> MYSQL_WAIT_EXCEPT<span class="token punctuation">;</span>
    <span class="token keyword">return</span> status<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
  <span class="token keyword">struct</span> pollfd pfd<span class="token punctuation">;</span>
  <span class="token keyword">int</span> timeout<span class="token punctuation">;</span>
  <span class="token keyword">int</span> res<span class="token punctuation">;</span>

  pfd<span class="token punctuation">.</span>fd<span class="token operator">=</span> <span class="token function">mysql_get_socket</span><span class="token punctuation">(</span>mysql<span class="token punctuation">)</span><span class="token punctuation">;</span>
  pfd<span class="token punctuation">.</span>events<span class="token operator">=</span>
    <span class="token punctuation">(</span>status <span class="token operator">&amp;</span> MYSQL_WAIT_READ <span class="token operator">?</span> POLLIN <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">|</span>
    <span class="token punctuation">(</span>status <span class="token operator">&amp;</span> MYSQL_WAIT_WRITE <span class="token operator">?</span> POLLOUT <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">|</span>
    <span class="token punctuation">(</span>status <span class="token operator">&amp;</span> MYSQL_WAIT_EXCEPT <span class="token operator">?</span> POLLPRI <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&amp;</span> MYSQL_WAIT_TIMEOUT<span class="token punctuation">)</span>
    timeout<span class="token operator">=</span> <span class="token number">1000</span><span class="token operator">*</span><span class="token function">mysql_get_timeout_value</span><span class="token punctuation">(</span>mysql<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    timeout<span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  res<span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pfd<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> MYSQL_WAIT_TIMEOUT<span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token comment">/*
      In a real event framework, we should handle EINTR and re-try the poll.
    */</span>
    <span class="token keyword">return</span> MYSQL_WAIT_TIMEOUT<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">int</span> status<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pfd<span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span>
      status<span class="token operator">|=</span> MYSQL_WAIT_READ<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pfd<span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLOUT<span class="token punctuation">)</span>
      status<span class="token operator">|=</span> MYSQL_WAIT_WRITE<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pfd<span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLPRI<span class="token punctuation">)</span>
      status<span class="token operator">|=</span> MYSQL_WAIT_EXCEPT<span class="token punctuation">;</span>
    <span class="token keyword">return</span> status<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:1260px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 32;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x11f27ba14235bb981f73768972bf4dd31a83dfa24e47ef7059e705be387c715e-86,,168,"><div class="bs-example"><div><div class="bs-example-title">Exemple #16</div><div style="position:absolute;right:15px;top:10px" id="rating_16" data-hash="0x11f27ba14235bb981f73768972bf4dd31a83dfa24e47ef7059e705be387c715e" data-area="86,,168,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;16&#39;)" class="rating-up btn btn-success" data-id="rating_16"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;16&#39;)" class="rating-down btn btn-danger" data-id="rating_16"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x11f27ba14235bb981f73768972bf4dd31a83dfa24e47ef7059e705be387c715e-86,,168,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x11f27ba14235bb981f73768972bf4dd31a83dfa24e47ef7059e705be387c715e&amp;fullName=Varnish-Cache-master%2Fbin%2Fvarnishd%2Fcache_http1_fsm.c&amp;project=Open-Party%2FVarnish-Cache&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FOpen-Party%2FVarnish-Cache%2Fblob%2Fmaster%2FVarnish-Cache-master%2Fbin%2Fvarnishd%2Fcache_http1_fsm.c">cache_http1_fsm.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FOpen-Party%2FVarnish-Cache">Open-Party/Varnish-Cache</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="16"><pre class="line-numbers  language-cpp" data-end="168" data-start="87" data-highlight="114"><span class="token keyword">static</span> <span class="token keyword">enum</span> req_fsm_nxt
<span class="token function">http1_wait</span><span class="token punctuation">(</span><span class="token keyword">struct</span> sess <span class="token operator">*</span>sp<span class="token punctuation">,</span> <span class="token keyword">struct</span> worker <span class="token operator">*</span>wrk<span class="token punctuation">,</span> <span class="token keyword">struct</span> req <span class="token operator">*</span>req<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> j<span class="token punctuation">,</span> tmo<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> pollfd pfd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> now<span class="token punctuation">,</span> when<span class="token punctuation">;</span>
	<span class="token keyword">enum</span> sess_close why <span class="token operator">=</span> SC_NULL<span class="token punctuation">;</span>
	<span class="token keyword">enum</span> http1_status_e hs<span class="token punctuation">;</span>

	<span class="token function">CHECK_OBJ_NOTNULL</span><span class="token punctuation">(</span>sp<span class="token punctuation">,</span> SESS_MAGIC<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">CHECK_OBJ_NOTNULL</span><span class="token punctuation">(</span>wrk<span class="token punctuation">,</span> WORKER_MAGIC<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">CHECK_OBJ_NOTNULL</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> REQ_MAGIC<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">assert</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>sp <span class="token operator">==</span> sp<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">AZ</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>vcl<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">AZ</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>esi_level<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">AZ</span><span class="token punctuation">(</span><span class="token function">isnan</span><span class="token punctuation">(</span>sp<span class="token operator">-&gt;</span>t_idle<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">isnan</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>t_first<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">isnan</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>t_prev<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">isnan</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>t_req<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	tmo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1e3</span> <span class="token operator">*</span> cache_param<span class="token operator">-&gt;</span>timeout_linger<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		pfd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> sp<span class="token operator">-&gt;</span>fd<span class="token punctuation">;</span>
		pfd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>
		pfd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		j <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>pfd<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> tmo<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">assert</span><span class="token punctuation">(</span>j <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		now <span class="token operator">=</span> <span class="token function">VTIM_real</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
			hs <span class="token operator">=</span> <span class="token function">HTTP1_Rx</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>htc<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>
			hs <span class="token operator">=</span> <span class="token function">HTTP1_Complete</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>htc<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>hs <span class="token operator">==</span> HTTP1_COMPLETE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">/* Got it, run with it */</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isnan</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>t_first<span class="token punctuation">)</span><span class="token punctuation">)</span>
				req<span class="token operator">-&gt;</span>t_first <span class="token operator">=</span> now<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isnan</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>t_req<span class="token punctuation">)</span><span class="token punctuation">)</span>
				req<span class="token operator">-&gt;</span>t_req <span class="token operator">=</span> now<span class="token punctuation">;</span>
			req<span class="token operator">-&gt;</span>acct<span class="token punctuation">.</span>req_hdrbytes <span class="token operator">+=</span> <span class="token function">Tlen</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>htc<span class="token operator">-&gt;</span>rxbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token punctuation">(</span>REQ_FSM_MORE<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>hs <span class="token operator">==</span> HTTP1_ERROR_EOF<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			why <span class="token operator">=</span> SC_REM_CLOSE<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>hs <span class="token operator">==</span> HTTP1_OVERFLOW<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			why <span class="token operator">=</span> SC_RX_OVERFLOW<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>hs <span class="token operator">==</span> HTTP1_ALL_WHITESPACE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">/* Nothing but whitespace */</span>
			when <span class="token operator">=</span> sp<span class="token operator">-&gt;</span>t_idle <span class="token operator">+</span> cache_param<span class="token operator">-&gt;</span>timeout_idle<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>when <span class="token operator">&lt;</span> now<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				why <span class="token operator">=</span> SC_RX_TIMEOUT<span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			when <span class="token operator">=</span> sp<span class="token operator">-&gt;</span>t_idle <span class="token operator">+</span> cache_param<span class="token operator">-&gt;</span>timeout_linger<span class="token punctuation">;</span>
			tmo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1e3</span> <span class="token operator">*</span> <span class="token punctuation">(</span>when <span class="token operator">-</span> now<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>when <span class="token operator">&lt;</span> now <span class="token operator">||</span> tmo <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				wrk<span class="token operator">-&gt;</span>stats<span class="token operator">-&gt;</span>sess_herd<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token function">SES_ReleaseReq</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">WAIT_Enter</span><span class="token punctuation">(</span>sp<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> <span class="token punctuation">(</span>REQ_FSM_DONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">/* Working on it */</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isnan</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>t_first<span class="token punctuation">)</span><span class="token punctuation">)</span>
				<span class="token comment">/* Record first byte received time stamp */</span>
				req<span class="token operator">-&gt;</span>t_first <span class="token operator">=</span> now<span class="token punctuation">;</span>
			when <span class="token operator">=</span> sp<span class="token operator">-&gt;</span>t_idle <span class="token operator">+</span> cache_param<span class="token operator">-&gt;</span>timeout_req<span class="token punctuation">;</span>
			tmo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1e3</span> <span class="token operator">*</span> <span class="token punctuation">(</span>when <span class="token operator">-</span> now<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>when <span class="token operator">&lt;</span> now <span class="token operator">||</span> tmo <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				why <span class="token operator">=</span> SC_RX_TIMEOUT<span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	req<span class="token operator">-&gt;</span>acct<span class="token punctuation">.</span>req_hdrbytes <span class="token operator">+=</span> <span class="token function">Tlen</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>htc<span class="token operator">-&gt;</span>rxbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">CNT_AcctLogCharge</span><span class="token punctuation">(</span>wrk<span class="token operator">-&gt;</span>stats<span class="token punctuation">,</span> req<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SES_ReleaseReq</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">assert</span><span class="token punctuation">(</span>why <span class="token operator">!=</span> SC_NULL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SES_Delete</span><span class="token punctuation">(</span>sp<span class="token punctuation">,</span> why<span class="token punctuation">,</span> now<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>REQ_FSM_DONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:567px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 86;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x115b09148f8222ad526251ff20753cbb0d82745063ae03c6f53a2358b94bd0cc-324,,472,"><div class="bs-example"><div><div class="bs-example-title">Exemple #17</div><div style="position:absolute;right:15px;top:10px" id="rating_17" data-hash="0x115b09148f8222ad526251ff20753cbb0d82745063ae03c6f53a2358b94bd0cc" data-area="324,,472,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;17&#39;)" class="rating-up btn btn-success" data-id="rating_17"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;17&#39;)" class="rating-down btn btn-danger" data-id="rating_17"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x115b09148f8222ad526251ff20753cbb0d82745063ae03c6f53a2358b94bd0cc-324,,472,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x115b09148f8222ad526251ff20753cbb0d82745063ae03c6f53a2358b94bd0cc&amp;fullName=curl-master%2Fselect.c&amp;project=kevinw%2Fcurl&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevinw%2Fcurl%2Fblob%2Fmaster%2Fcurl-master%2Fselect.c">select.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevinw%2Fcurl">kevinw/curl</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="17"><pre class="line-numbers  language-cpp" data-end="472" data-start="325" data-highlight="388"><span class="token comment">/*
 * This is a wrapper around poll().  If poll() does not exist, then
 * select() is used instead.  An error is returned if select() is
 * being used and a file descriptor is too large for FD_SETSIZE.
 * A negative timeout value makes this function wait indefinitely,
 * unles no valid file descriptor is given, when this happens the
 * negative timeout is ignored and the function times out immediately.
 * When compiled with CURL_ACKNOWLEDGE_EINTR defined, EINTR condition
 * is honored and function might exit early without awaiting timeout,
 * otherwise EINTR will be ignored.
 *
 * Return values:
 *   -1 = system call error or fd &gt;= FD_SETSIZE
 *    0 = timeout
 *    N = number of structures with non zero revent fields
 */</span>
<span class="token keyword">int</span> <span class="token function">Curl_poll</span><span class="token punctuation">(</span><span class="token keyword">struct</span> pollfd ufds<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> nfds<span class="token punctuation">,</span> <span class="token keyword">int</span> timeout_ms<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token macro property">#<span class="token directive keyword">ifndef</span> HAVE_POLL_FINE</span>
  <span class="token keyword">struct</span> timeval pending_tv<span class="token punctuation">;</span>
  <span class="token keyword">struct</span> timeval <span class="token operator">*</span>ptimeout<span class="token punctuation">;</span>
  fd_set fds_read<span class="token punctuation">;</span>
  fd_set fds_write<span class="token punctuation">;</span>
  fd_set fds_err<span class="token punctuation">;</span>
  curl_socket_t maxfd<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
  <span class="token keyword">struct</span> timeval initial_tv <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">bool</span> fds_none <span class="token operator">=</span> TRUE<span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>
  <span class="token keyword">int</span> pending_ms <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> error<span class="token punctuation">;</span>
  <span class="token keyword">int</span> r<span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>ufds<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nfds<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">!=</span> CURL_SOCKET_BAD<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fds_none <span class="token operator">=</span> FALSE<span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>fds_none<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r <span class="token operator">=</span> <span class="token function">wait_ms</span><span class="token punctuation">(</span>timeout_ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> r<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/* Avoid initial timestamp, avoid gettimeofday() call, when elapsed
     time in this function does not need to be measured. This happens
     when function is called with a zero timeout or a negative timeout
     value indicating a blocking call should be performed. */</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>timeout_ms <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pending_ms <span class="token operator">=</span> timeout_ms<span class="token punctuation">;</span>
    initial_tv <span class="token operator">=</span> <span class="token function">curlx_tvnow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">ifdef</span> HAVE_POLL_FINE</span>

  <span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timeout_ms <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
      pending_ms <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>timeout_ms<span class="token punctuation">)</span>
      pending_ms <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    r <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>ufds<span class="token punctuation">,</span> nfds<span class="token punctuation">,</span> pending_ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    error <span class="token operator">=</span> SOCKERRNO<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error <span class="token operator">&amp;&amp;</span> error_not_EINTR<span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timeout_ms <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pending_ms <span class="token operator">=</span> timeout_ms <span class="token operator">-</span> elapsed_ms<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>pending_ms <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">else</span>  </span><span class="token comment">/* HAVE_POLL_FINE */</span>

  <span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fds_read<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fds_write<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fds_err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  maxfd <span class="token operator">=</span> <span class="token punctuation">(</span>curl_socket_t<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nfds<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">==</span> CURL_SOCKET_BAD<span class="token punctuation">)</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token function">VERIFY_SOCK</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> <span class="token punctuation">(</span>POLLIN<span class="token operator">|</span>POLLOUT<span class="token operator">|</span>POLLPRI<span class="token operator">|</span>
                          POLLRDNORM<span class="token operator">|</span>POLLWRNORM<span class="token operator">|</span>POLLRDBAND<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">&gt;</span> maxfd<span class="token punctuation">)</span>
        maxfd <span class="token operator">=</span> ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> <span class="token punctuation">(</span>POLLRDNORM<span class="token operator">|</span>POLLIN<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">FD_SET</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_read<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> <span class="token punctuation">(</span>POLLWRNORM<span class="token operator">|</span>POLLOUT<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">FD_SET</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_write<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> <span class="token punctuation">(</span>POLLRDBAND<span class="token operator">|</span>POLLPRI<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">FD_SET</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  ptimeout <span class="token operator">=</span> <span class="token punctuation">(</span>timeout_ms <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant">NULL</span> <span class="token operator">:</span> <span class="token operator">&amp;</span>pending_tv<span class="token punctuation">;</span>

  <span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timeout_ms <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pending_tv<span class="token punctuation">.</span>tv_sec <span class="token operator">=</span> pending_ms <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">;</span>
      pending_tv<span class="token punctuation">.</span>tv_usec <span class="token operator">=</span> <span class="token punctuation">(</span>pending_ms <span class="token operator">%</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>timeout_ms<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pending_tv<span class="token punctuation">.</span>tv_sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      pending_tv<span class="token punctuation">.</span>tv_usec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    r <span class="token operator">=</span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>maxfd <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_read<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_write<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_err<span class="token punctuation">,</span> ptimeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    error <span class="token operator">=</span> SOCKERRNO<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error <span class="token operator">&amp;&amp;</span> error_not_EINTR<span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timeout_ms <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pending_ms <span class="token operator">=</span> timeout_ms <span class="token operator">-</span> elapsed_ms<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>pending_ms <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

  r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nfds<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">==</span> CURL_SOCKET_BAD<span class="token punctuation">)</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_read<span class="token punctuation">)</span><span class="token punctuation">)</span>
      ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> POLLIN<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_write<span class="token punctuation">)</span><span class="token punctuation">)</span>
      ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> POLLOUT<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>fds_err<span class="token punctuation">)</span><span class="token punctuation">)</span>
      ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">|=</span> POLLPRI<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ufds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
      r<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">endif</span>  </span><span class="token comment">/* HAVE_POLL_FINE */</span>

  <span class="token keyword">return</span> r<span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:1323px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 324;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x1224462277ed3278c0af6cb3fd1190efeb20c27116de038c11d25178720631e6-114,,254,"><div class="bs-example"><div><div class="bs-example-title">Exemple #18</div><div style="position:absolute;right:15px;top:10px" id="rating_18" data-hash="0x1224462277ed3278c0af6cb3fd1190efeb20c27116de038c11d25178720631e6" data-area="114,,254,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;18&#39;)" class="rating-up btn btn-success" data-id="rating_18"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;18&#39;)" class="rating-down btn btn-danger" data-id="rating_18"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x1224462277ed3278c0af6cb3fd1190efeb20c27116de038c11d25178720631e6-114,,254,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x1224462277ed3278c0af6cb3fd1190efeb20c27116de038c11d25178720631e6&amp;fullName=c%2Fssp%2Fpckt.c&amp;project=kavinsivak%2Fsandbox&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkavinsivak%2Fsandbox%2Fblob%2Fmaster%2Fc%2Fssp%2Fpckt.c">pckt.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkavinsivak%2Fsandbox">kavinsivak/sandbox</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="18"><pre class="line-numbers  language-cpp" data-end="254" data-start="115" data-highlight="143"><span class="token keyword">static</span> <span class="token keyword">void</span> loop <span class="token punctuation">(</span><span class="token keyword">int</span> master_fd<span class="token punctuation">,</span> <span class="token keyword">int</span> ignore_eof<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ssize_t n<span class="token punctuation">;</span>
    <span class="token keyword">char</span> buf <span class="token punctuation">[</span>BUFSIZ<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">struct</span> pollfd fds <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> control_buf <span class="token punctuation">[</span>BUFSIZ<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> data_buf <span class="token punctuation">[</span>BUFSIZ<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> flags<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> strbuf control<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> strbuf data<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> iocblk <span class="token operator">*</span>ioc<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> termios <span class="token operator">*</span>term<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> msg_type<span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>

    fds <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> STDIN_FILENO<span class="token punctuation">;</span>
    fds <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>
    fds <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    fds <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> master_fd<span class="token punctuation">;</span>
    fds <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>
    fds <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    control<span class="token punctuation">.</span>buf <span class="token operator">=</span> control_buf<span class="token punctuation">;</span>
    control<span class="token punctuation">.</span>maxlen <span class="token operator">=</span> BUFSIZ<span class="token punctuation">;</span>
    data<span class="token punctuation">.</span>buf <span class="token operator">=</span> data_buf<span class="token punctuation">;</span>
    data<span class="token punctuation">.</span>maxlen <span class="token operator">=</span> BUFSIZ<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>poll <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> pollfd <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>fds<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> INFTIM<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            err_msg <span class="token punctuation">(</span><span class="token string">"poll failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>fds <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">=</span> read <span class="token punctuation">(</span>STDIN_FILENO<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> BUFSIZ<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                err_msg <span class="token punctuation">(</span><span class="token string">"read from stdin failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ignore_eof<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    fds <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token keyword">continue</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>writen <span class="token punctuation">(</span>master_fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                err_msg <span class="token punctuation">(</span><span class="token string">"writen to pty master failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>fds <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            flags <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">=</span> getmsg <span class="token punctuation">(</span>master_fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>control<span class="token punctuation">,</span> <span class="token operator">&amp;</span>data<span class="token punctuation">,</span> <span class="token operator">&amp;</span>flags<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                err_msg <span class="token punctuation">(</span><span class="token string">"getmsg from pty master failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            msg_type <span class="token operator">=</span> control<span class="token punctuation">.</span>buf <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token keyword">switch</span> <span class="token punctuation">(</span>msg_type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> M_DATA<span class="token operator">:</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>writen <span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span> data<span class="token punctuation">.</span>buf<span class="token punctuation">,</span> data<span class="token punctuation">.</span>len<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                    err_msg <span class="token punctuation">(</span><span class="token string">"writen to stdout failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

            <span class="token keyword">case</span> M_FLUSH<span class="token operator">:</span>
                fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"pckt: pty slave flushed its queues\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

            <span class="token keyword">case</span> M_STOPI<span class="token operator">:</span>
                fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"pckt: pty slave suspended output\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

            <span class="token keyword">case</span> M_STARTI<span class="token operator">:</span>
                fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"pckt: pty slave resumed output\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

            <span class="token keyword">case</span> M_STOP<span class="token operator">:</span>
                fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"pckt: pty slave disabled XON/XOFF "</span>
                         <span class="token string">"flow control\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

            <span class="token keyword">case</span> M_START<span class="token operator">:</span>
                fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"pckt: pty slave enabled XON/XOFF "</span>
                         <span class="token string">"flow control\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

            <span class="token keyword">case</span> M_IOCTL<span class="token operator">:</span>
                ioc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> iocblk <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>data<span class="token punctuation">.</span>buf <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">switch</span> <span class="token punctuation">(</span>ioc <span class="token operator">-&gt;</span> ioc_cmd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">case</span> TCSBRK<span class="token operator">:</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"pckt: pty slave sent BREAK\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">goto</span> out<span class="token punctuation">;</span>

                <span class="token keyword">case</span> TCSETS<span class="token operator">:</span>
                <span class="token keyword">case</span> TCSETSW<span class="token operator">:</span>
                <span class="token keyword">case</span> TCSETSF<span class="token operator">:</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"pckt: pty slave changed "</span>
                             <span class="token string">"terminal attributes\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    term <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> termios <span class="token operator">*</span><span class="token punctuation">)</span>
                           <span class="token operator">&amp;</span>data<span class="token punctuation">.</span>buf <span class="token punctuation">[</span><span class="token keyword">sizeof</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> iocblk<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"  term.c_iflag = x\n"</span><span class="token punctuation">,</span>
                             term <span class="token operator">-&gt;</span> c_iflag<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"  term.c_oflag = x\n"</span><span class="token punctuation">,</span>
                             term <span class="token operator">-&gt;</span> c_oflag<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"  term.c_cflag = x\n"</span><span class="token punctuation">,</span>
                             term <span class="token operator">-&gt;</span> c_cflag<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"  term.c_lflag = x\n"</span><span class="token punctuation">,</span>
                             term <span class="token operator">-&gt;</span> c_lflag<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"  term.c_cc = "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> NCCS<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                        fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"x "</span><span class="token punctuation">,</span> term <span class="token operator">-&gt;</span> c_cc <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>

                <span class="token keyword">default</span><span class="token operator">:</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"pckt: Unrecognised ioc_cmd: "</span>
                             <span class="token string">"x\n"</span><span class="token punctuation">,</span> ioc <span class="token operator">-&gt;</span> ioc_cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"  ioc -&gt; ioc_cmd = x\n"</span><span class="token punctuation">,</span>
                             ioc <span class="token operator">-&gt;</span> ioc_cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"  ioc -&gt; ioc_id = x\n"</span><span class="token punctuation">,</span>
                             ioc <span class="token operator">-&gt;</span> ioc_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"  ioc -&gt; ioc_flag = x\n"</span><span class="token punctuation">,</span>
                             ioc <span class="token operator">-&gt;</span> ioc_flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"  ioc -&gt; ioc_count = x\n"</span><span class="token punctuation">,</span>
                             ioc <span class="token operator">-&gt;</span> ioc_count<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"  ioc -&gt; ioc_rval = x\n"</span><span class="token punctuation">,</span>
                             ioc <span class="token operator">-&gt;</span> ioc_rval<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"  ioc -&gt; ioc_error = x\n"</span><span class="token punctuation">,</span>
                             ioc <span class="token operator">-&gt;</span> ioc_error<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

            <span class="token keyword">default</span><span class="token operator">:</span>
                fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"pckt: Unrecognised message type: "</span>
                         <span class="token string">"x\n"</span><span class="token punctuation">,</span> msg_type<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

out<span class="token operator">:</span>
    <span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:588px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 114;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x1171948a76c02dd922e91659bb422ca149f6db44dbf250ec69a52c2aaa2575a6-254,,384,"><div class="bs-example"><div><div class="bs-example-title">Exemple #19</div><div style="position:absolute;right:15px;top:10px" id="rating_19" data-hash="0x1171948a76c02dd922e91659bb422ca149f6db44dbf250ec69a52c2aaa2575a6" data-area="254,,384,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;19&#39;)" class="rating-up btn btn-success" data-id="rating_19"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;19&#39;)" class="rating-down btn btn-danger" data-id="rating_19"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x1171948a76c02dd922e91659bb422ca149f6db44dbf250ec69a52c2aaa2575a6-254,,384,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x1171948a76c02dd922e91659bb422ca149f6db44dbf250ec69a52c2aaa2575a6&amp;fullName=VisualUefi-master%2Fedk2_old%2FAppPkg%2FApplications%2FSockets%2FDataSink.c&amp;project=binsys%2FVisualUefi&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fbinsys%2FVisualUefi%2Fblob%2Fmaster%2FVisualUefi-master%2Fedk2_old%2FAppPkg%2FApplications%2FSockets%2FDataSink.c">DataSink.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fbinsys%2FVisualUefi">binsys/VisualUefi</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="19"><pre class="line-numbers  language-cpp" data-end="384" data-start="255" data-highlight="295"><span class="token comment">/**
  Poll the socket for more work

  @retval  EFI_SUCCESS      The application is running normally
  @retval  EFI_NOT_STARTED  Listen socket error
  @retval  Other            The user stopped the application
**/</span>
EFI_STATUS
SocketPoll <span class="token punctuation">(</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  BOOLEAN bRemoveSocket<span class="token punctuation">;</span>
  BOOLEAN bListenError<span class="token punctuation">;</span>
  size_t BytesReceived<span class="token punctuation">;</span>
  <span class="token keyword">int</span> CloseStatus<span class="token punctuation">;</span>
  nfds_t Entry<span class="token punctuation">;</span>
  INTN EntryPrevious<span class="token punctuation">;</span>
  <span class="token keyword">int</span> FdCount<span class="token punctuation">;</span>
  nfds_t Index<span class="token punctuation">;</span>
  socklen_t LengthInBytes<span class="token punctuation">;</span>
  <span class="token keyword">struct</span> sockaddr_in <span class="token operator">*</span> pPortIpAddress4<span class="token punctuation">;</span>
  <span class="token keyword">struct</span> sockaddr_in6 <span class="token operator">*</span> pPortIpAddress6<span class="token punctuation">;</span>
  <span class="token keyword">struct</span> sockaddr_in <span class="token operator">*</span> pRemoteAddress4<span class="token punctuation">;</span>
  <span class="token keyword">struct</span> sockaddr_in6 <span class="token operator">*</span> pRemoteAddress6<span class="token punctuation">;</span>
  <span class="token keyword">struct</span> sockaddr_in6 RemoteAddress<span class="token punctuation">;</span>
  <span class="token keyword">int</span> Socket<span class="token punctuation">;</span>
  EFI_STATUS Status<span class="token punctuation">;</span>
  EFI_TPL TplPrevious<span class="token punctuation">;</span>

  <span class="token comment">//</span>
  <span class="token comment">//  Check for control-C</span>
  <span class="token comment">//</span>
  pRemoteAddress4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr_in <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>RemoteAddress<span class="token punctuation">;</span>
  pRemoteAddress6 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr_in6 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>RemoteAddress<span class="token punctuation">;</span>
  bListenError <span class="token operator">=</span> FALSE<span class="token punctuation">;</span>
  Status <span class="token operator">=</span> ControlCCheck <span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>EFI_ERROR <span class="token punctuation">(</span> Status <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
    <span class="token comment">//  Poll the sockets</span>
    <span class="token comment">//</span>
    FdCount <span class="token operator">=</span> poll <span class="token punctuation">(</span> <span class="token operator">&amp;</span>PollFd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     MaxPort<span class="token punctuation">,</span>
                     <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">==</span> FdCount <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//</span>
      <span class="token comment">//  Poll error</span>
      <span class="token comment">//</span>
      DEBUG <span class="token punctuation">(</span><span class="token punctuation">(</span> DEBUG_ERROR<span class="token punctuation">,</span>
                <span class="token string">"ERROR - Poll error, errno: %d\r\n"</span><span class="token punctuation">,</span>
                errno <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      Status <span class="token operator">=</span> EFI_DEVICE_ERROR<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">//</span>
      <span class="token comment">//  Process the poll output</span>
      <span class="token comment">//</span>
      Index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span> FdCount <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        bRemoveSocket <span class="token operator">=</span> FALSE<span class="token punctuation">;</span>

        <span class="token comment">//</span>
        <span class="token comment">//  Account for this descriptor</span>
        <span class="token comment">//</span>
        pPortIpAddress4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr_in <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>Port<span class="token punctuation">[</span> Index <span class="token punctuation">]</span><span class="token punctuation">.</span>IpAddress<span class="token punctuation">;</span>
        pPortIpAddress6 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr_in6 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>Port<span class="token punctuation">[</span> Index <span class="token punctuation">]</span><span class="token punctuation">.</span>IpAddress<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">0</span> <span class="token operator">!=</span> PollFd<span class="token punctuation">[</span> Index <span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token punctuation">)</span> <span class="token punctuation">{</span>
          FdCount <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//</span>
        <span class="token comment">//  Check for a broken connection</span>
        <span class="token comment">//</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">0</span> <span class="token operator">!=</span> <span class="token punctuation">(</span> PollFd<span class="token punctuation">[</span> Index <span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLHUP <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          bRemoveSocket <span class="token operator">=</span> TRUE<span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> ListenSocket <span class="token operator">==</span> PollFd<span class="token punctuation">[</span> Index <span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            bListenError <span class="token operator">=</span> TRUE<span class="token punctuation">;</span>
            DEBUG <span class="token punctuation">(</span><span class="token punctuation">(</span> DEBUG_ERROR<span class="token punctuation">,</span>
                      <span class="token string">"ERROR - Network closed on listen socket, errno: %d\r\n"</span><span class="token punctuation">,</span>
                      errno <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> AF_INET <span class="token operator">==</span> pPortIpAddress4<span class="token operator">-&gt;</span>sin_family <span class="token punctuation">)</span> <span class="token punctuation">{</span>
              DEBUG <span class="token punctuation">(</span><span class="token punctuation">(</span> DEBUG_ERROR<span class="token punctuation">,</span>
                        <span class="token string">"ERROR - Network closed on socket %d.%d.%d.%d:%d, errno: %d\r\n"</span><span class="token punctuation">,</span>
                        pPortIpAddress4<span class="token operator">-&gt;</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span>
                        <span class="token punctuation">(</span> pPortIpAddress4<span class="token operator">-&gt;</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">&gt;&gt;</span> <span class="token number">8</span> <span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span>
                        <span class="token punctuation">(</span> pPortIpAddress4<span class="token operator">-&gt;</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">&gt;&gt;</span> <span class="token number">16</span> <span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span>
                        <span class="token punctuation">(</span> pPortIpAddress4<span class="token operator">-&gt;</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">&gt;&gt;</span> <span class="token number">24</span> <span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span>
                        ntohs <span class="token punctuation">(</span> pPortIpAddress4<span class="token operator">-&gt;</span>sin_port <span class="token punctuation">)</span><span class="token punctuation">,</span>
                        errno <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
              DEBUG <span class="token punctuation">(</span><span class="token punctuation">(</span> DEBUG_ERROR<span class="token punctuation">,</span>
                        <span class="token string">"ERROR - Network closed on socket [%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:%d, errno: %d\r\n"</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">2</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">3</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">4</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">5</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">6</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">7</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">8</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">9</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">10</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">11</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">12</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">13</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">14</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        pPortIpAddress6<span class="token operator">-&gt;</span>sin6_addr<span class="token punctuation">.</span>__u6_addr<span class="token punctuation">.</span>__u6_addr8<span class="token punctuation">[</span> <span class="token number">15</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        ntohs <span class="token punctuation">(</span> pPortIpAddress6<span class="token operator">-&gt;</span>sin6_port <span class="token punctuation">)</span><span class="token punctuation">,</span>
                        errno <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">//</span>
            <span class="token comment">//  Close the socket</span>
            <span class="token comment">//</span>
            CloseStatus <span class="token operator">=</span> close <span class="token punctuation">(</span> PollFd<span class="token punctuation">[</span> Index <span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">0</span> <span class="token operator">==</span> CloseStatus <span class="token punctuation">)</span> <span class="token punctuation">{</span>
              bRemoveSocket <span class="token operator">=</span> TRUE<span class="token punctuation">;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span> AF_INET <span class="token operator">==</span> pPortIpAddress4<span class="token operator">-&gt;</span>sin_family <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                DEBUG <span class="token punctuation">(</span><span class="token punctuation">(</span> DEBUG_INFO<span class="token punctuation">,</span>
                          <span class="token string">"0x%08x: Socket closed for %d.%d.%d.%d:%d\r\n"</span><span class="token punctuation">,</span>
                          PollFd<span class="token punctuation">[</span> Index <span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span>
                          pPortIpAddress4<span class="token operator">-&gt;</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span>
                          <span class="token punctuation">(</span> pPortIpAddress4<span class="token operator">-&gt;</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">&gt;&gt;</span> <span class="token number">8</span> <span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span>
                          <span class="token punctuation">(</span> pPortIpAddress4<span class="token operator">-&gt;</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">&gt;&gt;</span> <span class="token number">16</span> <span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span>
                          <span class="token punctuation">(</span> pPortIpAddress4<span class="token operator">-&gt;</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">&gt;&gt;</span> <span class="token number">24</span> <span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span>
                          ntohs <span class="token punctuation">(</span> pPortIpAddress4<span class="token operator">-&gt;</span>sin_port <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
              <span class="token keyword">else</span> <span class="token punctuation">{</span><div class="line-highlight" style="height: 21px;top:840px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 254;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x1246eeb675dfe6218a0e35678c4f36ae52b366c9867c8bfc793a49d2c1bf6714-47,,227,"><div class="bs-example"><div><div class="bs-example-title">Exemple #20</div><div style="position:absolute;right:15px;top:10px" id="rating_20" data-hash="0x1246eeb675dfe6218a0e35678c4f36ae52b366c9867c8bfc793a49d2c1bf6714" data-area="47,,227,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;20&#39;)" class="rating-up btn btn-success" data-id="rating_20"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;20&#39;)" class="rating-down btn btn-danger" data-id="rating_20"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x1246eeb675dfe6218a0e35678c4f36ae52b366c9867c8bfc793a49d2c1bf6714-47,,227,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x1246eeb675dfe6218a0e35678c4f36ae52b366c9867c8bfc793a49d2c1bf6714&amp;fullName=Alcatel_OT_985_kernel-master%2Fexternal%2Fbluetooth%2Fbluez%2Fl2ping.c&amp;project=crow89%2FAlcatel_OT_985_kernel&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fcrow89%2FAlcatel_OT_985_kernel%2Fblob%2Fmaster%2FAlcatel_OT_985_kernel-master%2Fexternal%2Fbluetooth%2Fbluez%2Fl2ping.c">l2ping.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fcrow89%2FAlcatel_OT_985_kernel">crow89/Alcatel_OT_985_kernel</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="20"><pre class="line-numbers  language-cpp" data-end="227" data-start="48" data-highlight="146"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">ping</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>svr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> sigaction sa<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> sockaddr_l2 addr<span class="token punctuation">;</span>
	socklen_t optlen<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>send_buf<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>recv_buf<span class="token punctuation">;</span>
	<span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span> sk<span class="token punctuation">,</span> lost<span class="token punctuation">;</span>
	<span class="token keyword">uint8_t</span> id<span class="token punctuation">;</span>

	<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sa<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	sa<span class="token punctuation">.</span>sa_handler <span class="token operator">=</span> stat<span class="token punctuation">;</span>
	<span class="token function">sigaction</span><span class="token punctuation">(</span>SIGINT<span class="token punctuation">,</span> <span class="token operator">&amp;</span>sa<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	send_buf <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>L2CAP_CMD_HDR_SIZE <span class="token operator">+</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
	recv_buf <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>L2CAP_CMD_HDR_SIZE <span class="token operator">+</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>send_buf <span class="token operator">||</span> <span class="token operator">!</span>recv_buf<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Can't allocate buffer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/* Create socket */</span>
	sk <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>PF_BLUETOOTH<span class="token punctuation">,</span> SOCK_RAW<span class="token punctuation">,</span> BTPROTO_L2CAP<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>sk <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Can't create socket"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> error<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/* Bind to local address */</span>
	<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	addr<span class="token punctuation">.</span>l2_family <span class="token operator">=</span> AF_BLUETOOTH<span class="token punctuation">;</span>
	<span class="token function">bacpy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>addr<span class="token punctuation">.</span>l2_bdaddr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>bdaddr<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">bind</span><span class="token punctuation">(</span>sk<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Can't bind socket"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> error<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/* Connect to remote device */</span>
	<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	addr<span class="token punctuation">.</span>l2_family <span class="token operator">=</span> AF_BLUETOOTH<span class="token punctuation">;</span>
	<span class="token function">str2ba</span><span class="token punctuation">(</span>svr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>addr<span class="token punctuation">.</span>l2_bdaddr<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">connect</span><span class="token punctuation">(</span>sk<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Can't connect"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> error<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/* Get local address */</span>
	<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	optlen <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getsockname</span><span class="token punctuation">(</span>sk<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>optlen<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Can't get local address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> error<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">ba2str</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>addr<span class="token punctuation">.</span>l2_bdaddr<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Ping: %s from %s (data size %d) ...\n"</span><span class="token punctuation">,</span> svr<span class="token punctuation">,</span> str<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/* Initialize send buffer */</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		send_buf<span class="token punctuation">[</span>L2CAP_CMD_HDR_SIZE <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'A'</span><span class="token punctuation">;</span>

	id <span class="token operator">=</span> ident<span class="token punctuation">;</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> count<span class="token operator">--</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">struct</span> timeval tv_send<span class="token punctuation">,</span> tv_recv<span class="token punctuation">,</span> tv_diff<span class="token punctuation">;</span>
		l2cap_cmd_hdr <span class="token operator">*</span>send_cmd <span class="token operator">=</span> <span class="token punctuation">(</span>l2cap_cmd_hdr <span class="token operator">*</span><span class="token punctuation">)</span> send_buf<span class="token punctuation">;</span>
		l2cap_cmd_hdr <span class="token operator">*</span>recv_cmd <span class="token operator">=</span> <span class="token punctuation">(</span>l2cap_cmd_hdr <span class="token operator">*</span><span class="token punctuation">)</span> recv_buf<span class="token punctuation">;</span>

		<span class="token comment">/* Build command header */</span>
		send_cmd<span class="token operator">-&gt;</span>ident <span class="token operator">=</span> id<span class="token punctuation">;</span>
		send_cmd<span class="token operator">-&gt;</span>len   <span class="token operator">=</span> <span class="token function">htobs</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>reverse<span class="token punctuation">)</span>
			send_cmd<span class="token operator">-&gt;</span>code <span class="token operator">=</span> L2CAP_ECHO_RSP<span class="token punctuation">;</span>
		<span class="token keyword">else</span>
			send_cmd<span class="token operator">-&gt;</span>code <span class="token operator">=</span> L2CAP_ECHO_REQ<span class="token punctuation">;</span>

		<span class="token function">gettimeofday</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tv_send<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">/* Send Echo Command */</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">send</span><span class="token punctuation">(</span>sk<span class="token punctuation">,</span> send_buf<span class="token punctuation">,</span> L2CAP_CMD_HDR_SIZE <span class="token operator">+</span> size<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Send failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">goto</span> error<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">/* Wait for Echo Response */</span>
		lost <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">struct</span> pollfd pf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> err<span class="token punctuation">;</span>

			pf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> sk<span class="token punctuation">;</span>
			pf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>err <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>pf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> timeout <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Poll failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">goto</span> error<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				lost <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>err <span class="token operator">=</span> <span class="token function">recv</span><span class="token punctuation">(</span>sk<span class="token punctuation">,</span> recv_buf<span class="token punctuation">,</span> L2CAP_CMD_HDR_SIZE <span class="token operator">+</span> size<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Recv failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">goto</span> error<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Disconnected\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">goto</span> error<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			recv_cmd<span class="token operator">-&gt;</span>len <span class="token operator">=</span> <span class="token function">btohs</span><span class="token punctuation">(</span>recv_cmd<span class="token operator">-&gt;</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">/* Check for our id */</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>recv_cmd<span class="token operator">-&gt;</span>ident <span class="token operator">!=</span> id<span class="token punctuation">)</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>

			<span class="token comment">/* Check type */</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>reverse <span class="token operator">&amp;&amp;</span> recv_cmd<span class="token operator">-&gt;</span>code <span class="token operator">==</span> L2CAP_ECHO_RSP<span class="token punctuation">)</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>recv_cmd<span class="token operator">-&gt;</span>code <span class="token operator">==</span> L2CAP_COMMAND_REJ<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Peer doesn't support Echo packets\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">goto</span> error<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span>
		sent_pkt<span class="token operator">++</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>lost<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			recv_pkt<span class="token operator">++</span><span class="token punctuation">;</span>

			<span class="token function">gettimeofday</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tv_recv<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">timersub</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tv_recv<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tv_send<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tv_diff<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>verify<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">/* Check payload length */</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>recv_cmd<span class="token operator">-&gt;</span>len <span class="token operator">!=</span> size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"Received %d bytes, expected %d\n"</span><span class="token punctuation">,</span>
						   recv_cmd<span class="token operator">-&gt;</span>len<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">goto</span> error<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token comment">/* Check payload */</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">memcmp</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>send_buf<span class="token punctuation">[</span>L2CAP_CMD_HDR_SIZE<span class="token punctuation">]</span><span class="token punctuation">,</span>
						   <span class="token operator">&amp;</span>recv_buf<span class="token punctuation">[</span>L2CAP_CMD_HDR_SIZE<span class="token punctuation">]</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"Response payload different.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">goto</span> error<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>

			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d bytes from %s id %d time %.2fms\n"</span><span class="token punctuation">,</span> recv_cmd<span class="token operator">-&gt;</span>len<span class="token punctuation">,</span> svr<span class="token punctuation">,</span>
				   id <span class="token operator">-</span> ident<span class="token punctuation">,</span> <span class="token function">tv2fl</span><span class="token punctuation">(</span>tv_diff<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>delay<span class="token punctuation">)</span>
				<span class="token function">sleep</span><span class="token punctuation">(</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"no response from %s: id %d\n"</span><span class="token punctuation">,</span> svr<span class="token punctuation">,</span> id <span class="token operator">-</span> ident<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>id <span class="token operator">&gt;</span> <span class="token number">254</span><span class="token punctuation">)</span>
			id <span class="token operator">=</span> ident<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">stat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>send_buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>recv_buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>

error<span class="token operator">:</span>
	<span class="token function">close</span><span class="token punctuation">(</span>sk<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>send_buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>recv_buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:2058px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 47;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x11a152364715e23a07617908f09c3f9f157b841cfd750aeba2b272cd5e4a086c-263,,327,"><div class="bs-example"><div><div class="bs-example-title">Exemple #21</div><div style="position:absolute;right:15px;top:10px" id="rating_21" data-hash="0x11a152364715e23a07617908f09c3f9f157b841cfd750aeba2b272cd5e4a086c" data-area="263,,327,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;21&#39;)" class="rating-up btn btn-success" data-id="rating_21"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;21&#39;)" class="rating-down btn btn-danger" data-id="rating_21"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x11a152364715e23a07617908f09c3f9f157b841cfd750aeba2b272cd5e4a086c-263,,327,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x11a152364715e23a07617908f09c3f9f157b841cfd750aeba2b272cd5e4a086c&amp;fullName=rtpproxy-master%2Frtpp_command_async.c&amp;project=andviro%2Frtpproxy&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fandviro%2Frtpproxy%2Fblob%2Fmaster%2Frtpproxy-master%2Frtpp_command_async.c">rtpp_command_async.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fandviro%2Frtpproxy">andviro/rtpproxy</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="21"><pre class="line-numbers  language-cpp" data-end="327" data-start="264" data-highlight="280,282"><span class="token keyword">static</span> <span class="token keyword">void</span>
<span class="token function">rtpp_cmd_acceptor_run</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">struct</span> rtpp_cmd_async_cf <span class="token operator">*</span>cmd_cf<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> pollfd <span class="token operator">*</span>tp<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> rtpp_cmd_pollset <span class="token operator">*</span>psp<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> rtpp_cmd_accptset <span class="token operator">*</span>asp<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> rtpp_cmd_connection <span class="token operator">*</span>rcc<span class="token punctuation">;</span>
    <span class="token keyword">int</span> nready<span class="token punctuation">,</span> controlfd<span class="token punctuation">,</span> i<span class="token punctuation">,</span> tstate<span class="token punctuation">;</span>

    cmd_cf <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> rtpp_cmd_async_cf <span class="token operator">*</span><span class="token punctuation">)</span>arg<span class="token punctuation">;</span>
    psp <span class="token operator">=</span> <span class="token operator">&amp;</span>cmd_cf<span class="token operator">-&gt;</span>pset<span class="token punctuation">;</span>
    asp <span class="token operator">=</span> <span class="token operator">&amp;</span>cmd_cf<span class="token operator">-&gt;</span>aset<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token macro property">#<span class="token directive keyword">ifndef</span> LINUX_XXX</span>
        nready <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>asp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">,</span> asp<span class="token operator">-&gt;</span>pfds_used<span class="token punctuation">,</span> INFTIM<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
	nready <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>asp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">,</span> asp<span class="token operator">-&gt;</span>pfds_used<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
        <span class="token function">pthread_mutex_lock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cmd_cf<span class="token operator">-&gt;</span>cmd_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        tstate <span class="token operator">=</span> cmd_cf<span class="token operator">-&gt;</span>tstate_acceptor<span class="token punctuation">;</span>
        <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cmd_cf<span class="token operator">-&gt;</span>cmd_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tstate <span class="token operator">==</span> TSTATE_CEASE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nready <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> asp<span class="token operator">-&gt;</span>pfds_used<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>asp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token function">pthread_mutex_lock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>pfds_used <span class="token operator">&gt;=</span> RTPC_MAX_CONNECTIONS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            controlfd <span class="token operator">=</span> <span class="token function">accept_connection</span><span class="token punctuation">(</span>cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token punctuation">,</span> asp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>controlfd <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            tp <span class="token operator">=</span> <span class="token function">realloc</span><span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> pollfd<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>pfds_used <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>tp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">close</span><span class="token punctuation">(</span>controlfd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* Yeah, sorry, please try later */</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            rcc <span class="token operator">=</span> <span class="token function">rtpp_cmd_connection_ctor</span><span class="token punctuation">(</span>controlfd<span class="token punctuation">,</span> controlfd<span class="token punctuation">,</span> asp<span class="token operator">-&gt;</span>csocks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rcc <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">close</span><span class="token punctuation">(</span>controlfd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* Yeah, sorry, please try later */</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            psp<span class="token operator">-&gt;</span>pfds <span class="token operator">=</span> tp<span class="token punctuation">;</span>
            psp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">[</span>psp<span class="token operator">-&gt;</span>pfds_used<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> controlfd<span class="token punctuation">;</span>
            psp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">[</span>psp<span class="token operator">-&gt;</span>pfds_used<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN <span class="token operator">|</span> POLLERR <span class="token operator">|</span> POLLHUP<span class="token punctuation">;</span>
            psp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">[</span>psp<span class="token operator">-&gt;</span>pfds_used<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>psp<span class="token operator">-&gt;</span>pfds_used<span class="token punctuation">]</span> <span class="token operator">=</span> rcc<span class="token punctuation">;</span>
            psp<span class="token operator">-&gt;</span>pfds_used<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">rtpp_command_async_wakeup</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cmd_cf<span class="token operator">-&gt;</span>pub<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 263;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x1262fb0b3bdb987dbbb3c4a09484cbeb0f2f5789e1dc325053a2f1947549d4e6-876,,1021,"><div class="bs-example"><div><div class="bs-example-title">Exemple #22</div><div style="position:absolute;right:15px;top:10px" id="rating_22" data-hash="0x1262fb0b3bdb987dbbb3c4a09484cbeb0f2f5789e1dc325053a2f1947549d4e6" data-area="876,,1021,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;22&#39;)" class="rating-up btn btn-success" data-id="rating_22"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;22&#39;)" class="rating-down btn btn-danger" data-id="rating_22"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x1262fb0b3bdb987dbbb3c4a09484cbeb0f2f5789e1dc325053a2f1947549d4e6-876,,1021,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x1262fb0b3bdb987dbbb3c4a09484cbeb0f2f5789e1dc325053a2f1947549d4e6&amp;fullName=FreeRDP-master%2Flibfreerdp%2Ftls.c&amp;project=MrRecovery%2FFreeRDP&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FMrRecovery%2FFreeRDP%2Fblob%2Fmaster%2FFreeRDP-master%2Flibfreerdp%2Ftls.c">tls.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FMrRecovery%2FFreeRDP">MrRecovery/FreeRDP</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="22"><pre class="line-numbers  language-cpp" data-end="1021" data-start="877" data-highlight="932,998"><span class="token keyword">int</span> <span class="token function">tls_write_all</span><span class="token punctuation">(</span>rdpTls<span class="token operator">*</span> tls<span class="token punctuation">,</span> <span class="token keyword">const</span> BYTE<span class="token operator">*</span> data<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> status<span class="token punctuation">,</span> nchunks<span class="token punctuation">,</span> commitedBytes<span class="token punctuation">;</span>
	rdpTcp <span class="token operator">*</span>tcp<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">ifdef</span> HAVE_POLL_H</span>
	<span class="token keyword">struct</span> pollfd pollfds<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
	fd_set rset<span class="token punctuation">,</span> wset<span class="token punctuation">;</span>
	fd_set <span class="token operator">*</span>rsetPtr<span class="token punctuation">,</span> <span class="token operator">*</span>wsetPtr<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> timeval tv<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
	BIO<span class="token operator">*</span> bio <span class="token operator">=</span> tls<span class="token operator">-&gt;</span>bio<span class="token punctuation">;</span>
	DataChunk chunks<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

	BIO<span class="token operator">*</span> bufferedBio <span class="token operator">=</span> <span class="token function">findBufferedBio</span><span class="token punctuation">(</span>bio<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>bufferedBio<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">WLog_ERR</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span>  <span class="token string">"error unable to retrieve the bufferedBio in the BIO chain"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	tcp <span class="token operator">=</span> <span class="token punctuation">(</span>rdpTcp<span class="token operator">*</span><span class="token punctuation">)</span> bufferedBio<span class="token operator">-&gt;</span>ptr<span class="token punctuation">;</span>

	<span class="token keyword">do</span>
	<span class="token punctuation">{</span>
		status <span class="token operator">=</span> <span class="token function">BIO_write</span><span class="token punctuation">(</span>bio<span class="token punctuation">,</span> data<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">BIO_should_retry</span><span class="token punctuation">(</span>bio<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">ifdef</span> HAVE_POLL_H</span>
		pollfds<span class="token punctuation">.</span>fd <span class="token operator">=</span> tcp<span class="token operator">-&gt;</span>sockfd<span class="token punctuation">;</span>
		pollfds<span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		pollfds<span class="token punctuation">.</span>events <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>writeBlocked<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			pollfds<span class="token punctuation">.</span>events <span class="token operator">|=</span> POLLOUT<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>readBlocked<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			pollfds<span class="token punctuation">.</span>events <span class="token operator">|=</span> POLLIN<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{</span>
			<span class="token function">WLog_ERR</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span>  <span class="token string">"weird we're blocked but the underlying is not read or write blocked !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">USleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">continue</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			status <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pollfds<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>status <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>errno <span class="token operator">==</span> EINTR<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
		<span class="token comment">/* we try to handle SSL want_read and want_write nicely */</span>
		rsetPtr <span class="token operator">=</span> wsetPtr <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>writeBlocked<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			wsetPtr <span class="token operator">=</span> <span class="token operator">&amp;</span>wset<span class="token punctuation">;</span>
			<span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>wset<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">FD_SET</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>sockfd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>wset<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>readBlocked<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			rsetPtr <span class="token operator">=</span> <span class="token operator">&amp;</span>rset<span class="token punctuation">;</span>
			<span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rset<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">FD_SET</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>sockfd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rset<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{</span>
			<span class="token function">WLog_ERR</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span>  <span class="token string">"weird we're blocked but the underlying is not read or write blocked !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">USleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">continue</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		tv<span class="token punctuation">.</span>tv_sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		tv<span class="token punctuation">.</span>tv_usec <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>

		status <span class="token operator">=</span> <span class="token function">_select</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>sockfd <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> rsetPtr<span class="token punctuation">,</span> wsetPtr<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>tv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/* make sure the output buffer is empty */</span>
	commitedBytes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>nchunks <span class="token operator">=</span> <span class="token function">ringbuffer_peek</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tcp<span class="token operator">-&gt;</span>xmitBuffer<span class="token punctuation">,</span> chunks<span class="token punctuation">,</span> <span class="token function">ringbuffer_used</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tcp<span class="token operator">-&gt;</span>xmitBuffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">int</span> i<span class="token punctuation">;</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nchunks<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>chunks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>size<span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				status <span class="token operator">=</span> <span class="token function">BIO_write</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>socketBio<span class="token punctuation">,</span> chunks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">,</span> chunks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					chunks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>size <span class="token operator">-=</span> status<span class="token punctuation">;</span>
					chunks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data <span class="token operator">+=</span> status<span class="token punctuation">;</span>
					commitedBytes <span class="token operator">+=</span> status<span class="token punctuation">;</span>
					<span class="token keyword">continue</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">BIO_should_retry</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>socketBio<span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token keyword">goto</span> out_fail<span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">ifdef</span> HAVE_POLL_H</span>
				pollfds<span class="token punctuation">.</span>fd <span class="token operator">=</span> tcp<span class="token operator">-&gt;</span>sockfd<span class="token punctuation">;</span>
				pollfds<span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>
				pollfds<span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

				<span class="token keyword">do</span>
				<span class="token punctuation">{</span>
					status <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pollfds<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>status <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>errno <span class="token operator">==</span> EINTR<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
				<span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rset<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">FD_SET</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>sockfd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rset<span class="token punctuation">)</span><span class="token punctuation">;</span>
				tv<span class="token punctuation">.</span>tv_sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				tv<span class="token punctuation">.</span>tv_usec <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>

				status <span class="token operator">=</span> <span class="token function">_select</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>sockfd <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>rset<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>tv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
					<span class="token keyword">goto</span> out_fail<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token function">ringbuffer_commit_read_bytes</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tcp<span class="token operator">-&gt;</span>xmitBuffer<span class="token punctuation">,</span> commitedBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> length<span class="token punctuation">;</span>

out_fail<span class="token operator">:</span>
	<span class="token function">ringbuffer_commit_read_bytes</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tcp<span class="token operator">-&gt;</span>xmitBuffer<span class="token punctuation">,</span> commitedBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 876;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x11a152364715e23a07617908f09c3f9f157b841cfd750aeba2b272cd5e4a086c-348,,454,"><div class="bs-example"><div><div class="bs-example-title">Exemple #23</div><div style="position:absolute;right:15px;top:10px" id="rating_23" data-hash="0x11a152364715e23a07617908f09c3f9f157b841cfd750aeba2b272cd5e4a086c" data-area="348,,454,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;23&#39;)" class="rating-up btn btn-success" data-id="rating_23"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;23&#39;)" class="rating-down btn btn-danger" data-id="rating_23"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x11a152364715e23a07617908f09c3f9f157b841cfd750aeba2b272cd5e4a086c-348,,454,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x11a152364715e23a07617908f09c3f9f157b841cfd750aeba2b272cd5e4a086c&amp;fullName=rtpproxy-master%2Frtpp_command_async.c&amp;project=andviro%2Frtpproxy&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fandviro%2Frtpproxy%2Fblob%2Fmaster%2Frtpproxy-master%2Frtpp_command_async.c">rtpp_command_async.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fandviro%2Frtpproxy">andviro/rtpproxy</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="23"><pre class="line-numbers  language-cpp" data-end="454" data-start="349" data-highlight="379"><span class="token keyword">static</span> <span class="token keyword">void</span>
<span class="token function">rtpp_cmd_queue_run</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">struct</span> rtpp_cmd_async_cf <span class="token operator">*</span>cmd_cf<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> rtpp_cmd_pollset <span class="token operator">*</span>psp<span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> nready<span class="token punctuation">,</span> rval<span class="token punctuation">,</span> umode<span class="token punctuation">;</span>
    <span class="token keyword">double</span> sptime<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">if</span> 0</span>
    <span class="token keyword">double</span> eptime<span class="token punctuation">,</span> tused<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
    <span class="token keyword">struct</span> rtpp_command_stats <span class="token operator">*</span>csp<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> rtpp_stats_obj <span class="token operator">*</span>rtpp_stats_cf<span class="token punctuation">;</span>

    cmd_cf <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> rtpp_cmd_async_cf <span class="token operator">*</span><span class="token punctuation">)</span>arg<span class="token punctuation">;</span>
    rtpp_stats_cf <span class="token operator">=</span> cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token operator">-&gt;</span>stable<span class="token operator">-&gt;</span>rtpp_stats<span class="token punctuation">;</span>
    csp <span class="token operator">=</span> <span class="token operator">&amp;</span>cmd_cf<span class="token operator">-&gt;</span>cstats<span class="token punctuation">;</span>

    psp <span class="token operator">=</span> <span class="token operator">&amp;</span>cmd_cf<span class="token operator">-&gt;</span>pset<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sptime <span class="token operator">=</span> <span class="token function">getdtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">pthread_mutex_lock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>pfds_used <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">wait_next_clock</span><span class="token punctuation">(</span>cmd_cf<span class="token punctuation">)</span> <span class="token operator">==</span> TSTATE_CEASE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        nready <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">,</span> psp<span class="token operator">-&gt;</span>pfds_used<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nready <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">wait_next_clock</span><span class="token punctuation">(</span>cmd_cf<span class="token punctuation">)</span> <span class="token operator">==</span> TSTATE_CEASE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nready <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> errno <span class="token operator">==</span> EINTR<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nready <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> psp<span class="token operator">-&gt;</span>pfds_used<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> <span class="token punctuation">(</span>POLLERR <span class="token operator">|</span> POLLHUP<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">RTPP_CTRL_ISUNIX</span><span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span>csock<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">goto</span> closefd<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span>csock<span class="token operator">-&gt;</span>type <span class="token operator">==</span> RTPC_STDIO <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">goto</span> closefd<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">continue</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">RTPP_CTRL_ISSTREAM</span><span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span>csock<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    rval <span class="token operator">=</span> <span class="token function">process_commands_stream</span><span class="token punctuation">(</span>cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token punctuation">,</span> psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> sptime<span class="token punctuation">,</span> csp<span class="token punctuation">,</span> rtpp_stats_cf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    umode <span class="token operator">=</span> <span class="token function">RTPP_CTRL_ISDG</span><span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span>csock<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    rval <span class="token operator">=</span> <span class="token function">process_commands</span><span class="token punctuation">(</span>cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token punctuation">,</span> psp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span>
                      sptime<span class="token punctuation">,</span> csp<span class="token punctuation">,</span> umode<span class="token punctuation">,</span> rtpp_stats_cf<span class="token punctuation">,</span> cmd_cf<span class="token operator">-&gt;</span>rcache<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">/*
                 * Shut down non-datagram sockets that got I/O error
                 * and also all non-continuous UNIX sockets are recycled
                 * after each use.
                 */</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">RTPP_CTRL_ISDG</span><span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span>csock<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>rval <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">RTPP_CTRL_ISSTREAM</span><span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span>csock<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
closefd<span class="token operator">:</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span>csock<span class="token operator">-&gt;</span>type <span class="token operator">==</span> RTPC_STDIO <span class="token operator">&amp;&amp;</span> psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span>csock<span class="token operator">-&gt;</span>exit_on_close <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token operator">-&gt;</span>stable<span class="token operator">-&gt;</span>slowshutdown <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token function">rtpp_cmd_connection_dtor</span><span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    psp<span class="token operator">-&gt;</span>pfds_used<span class="token operator">--</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>pfds_used <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> psp<span class="token operator">-&gt;</span>pfds_used<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>pfds_used <span class="token operator">-</span> i<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> pollfd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>rccs<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">(</span>psp<span class="token operator">-&gt;</span>pfds_used <span class="token operator">-</span> i<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> rtpp_ctrl_connection <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>psp<span class="token operator">-&gt;</span>pfds_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nready <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">rtpp_anetio_pump</span><span class="token punctuation">(</span>cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token operator">-&gt;</span>stable<span class="token operator">-&gt;</span>rtpp_netio_cf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">if</span> 0</span>
        eptime <span class="token operator">=</span> <span class="token function">getdtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pthread_mutex_lock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cmd_cf<span class="token operator">-&gt;</span>cmd_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">recfilter_apply</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cmd_cf<span class="token operator">-&gt;</span>average_load<span class="token punctuation">,</span> <span class="token punctuation">(</span>eptime <span class="token operator">-</span> sptime <span class="token operator">+</span> tused<span class="token punctuation">)</span> <span class="token operator">*</span> cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token operator">-&gt;</span>stable<span class="token operator">-&gt;</span>target_pfreq<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cmd_cf<span class="token operator">-&gt;</span>cmd_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
        <span class="token function">flush_cstats</span><span class="token punctuation">(</span>rtpp_stats_cf<span class="token punctuation">,</span> csp<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">if</span> 0</span>
<span class="token macro property">#<span class="token directive keyword">if</span> RTPP_DEBUG</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>last_ctick <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token operator">-&gt;</span>stable<span class="token operator">-&gt;</span>target_pfreq <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> last_ctick <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">rtpp_log_write</span><span class="token punctuation">(</span>RTPP_LOG_DBUG<span class="token punctuation">,</span> cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token operator">-&gt;</span>stable<span class="token operator">-&gt;</span>glog<span class="token punctuation">,</span> <span class="token string">"rtpp_cmd_queue_run %lld sptime %f eptime %f, CSV: %f,%f,%f,%f,%f"</span><span class="token punctuation">,</span> \
              last_ctick<span class="token punctuation">,</span> sptime<span class="token punctuation">,</span> eptime<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>last_ctick <span class="token operator">/</span> cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token operator">-&gt;</span>stable<span class="token operator">-&gt;</span>target_pfreq<span class="token punctuation">,</span> \
              eptime <span class="token operator">-</span> sptime <span class="token operator">+</span> tused<span class="token punctuation">,</span> eptime<span class="token punctuation">,</span> sptime<span class="token punctuation">,</span> tused<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">rtpp_log_write</span><span class="token punctuation">(</span>RTPP_LOG_DBUG<span class="token punctuation">,</span> cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token operator">-&gt;</span>stable<span class="token operator">-&gt;</span>glog<span class="token punctuation">,</span> <span class="token string">"run %lld average load %f, CSV: %f,%f"</span><span class="token punctuation">,</span> last_ctick<span class="token punctuation">,</span> \
              cmd_cf<span class="token operator">-&gt;</span>average_load<span class="token punctuation">.</span>lastval <span class="token operator">*</span> <span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>last_ctick <span class="token operator">/</span> cmd_cf<span class="token operator">-&gt;</span>cf_save<span class="token operator">-&gt;</span>stable<span class="token operator">-&gt;</span>target_pfreq<span class="token punctuation">,</span> cmd_cf<span class="token operator">-&gt;</span>average_load<span class="token punctuation">.</span>lastval<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:630px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 348;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x127cbc7c0a5130839bec58cc6f3c67cfaa8f50fbbed4e34f664bb6ca0cb78b55-370,,510,"><div class="bs-example"><div><div class="bs-example-title">Exemple #24</div><div style="position:absolute;right:15px;top:10px" id="rating_24" data-hash="0x127cbc7c0a5130839bec58cc6f3c67cfaa8f50fbbed4e34f664bb6ca0cb78b55" data-area="370,,510,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;24&#39;)" class="rating-up btn btn-success" data-id="rating_24"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;24&#39;)" class="rating-down btn btn-danger" data-id="rating_24"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x127cbc7c0a5130839bec58cc6f3c67cfaa8f50fbbed4e34f664bb6ca0cb78b55-370,,510,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x127cbc7c0a5130839bec58cc6f3c67cfaa8f50fbbed4e34f664bb6ca0cb78b55&amp;fullName=illumos-gate-master%2Fusr%2Fsrc%2Flib%2Flibadutils%2Fldap_ping.c&amp;project=bahamas10%2Fopenzfs&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fbahamas10%2Fopenzfs%2Fblob%2Fmaster%2Fillumos-gate-master%2Fusr%2Fsrc%2Flib%2Flibadutils%2Fldap_ping.c">ldap_ping.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fbahamas10%2Fopenzfs">bahamas10/openzfs</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="24"><pre class="line-numbers  language-cpp" data-end="510" data-start="371" data-highlight="453,464"><span class="token comment">/*
 * Filter out unresponsive servers, and save the domain info
 * returned by the "LDAP ping" in the returned object.
 * If ctx != NULL, this is a query for a DC, in which case we
 * also save the Domain GUID, Site name, and Forest name as
 * "auto" (discovered) values in the ctx.
 *
 * Only return the "winner".  (We only want one DC/GC)
 */</span>
ad_disc_ds_t <span class="token operator">*</span>
<span class="token function">ldap_ping</span><span class="token punctuation">(</span>ad_disc_t ctx<span class="token punctuation">,</span> ad_disc_cds_t <span class="token operator">*</span>dclist<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>dname<span class="token punctuation">,</span> <span class="token keyword">int</span> reqflags<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">struct</span> sockaddr_in6 addr6<span class="token punctuation">;</span>
	socklen_t addrlen<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> pollfd pingchk<span class="token punctuation">;</span>
	ad_disc_cds_t <span class="token operator">*</span>send_ds<span class="token punctuation">;</span>
	ad_disc_cds_t <span class="token operator">*</span>recv_ds <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	ad_disc_ds_t <span class="token operator">*</span>ret_ds <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	BerElement <span class="token operator">*</span>req <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	BerElement <span class="token operator">*</span>res <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">struct</span> _berelement <span class="token operator">*</span>be<span class="token punctuation">,</span> <span class="token operator">*</span>rbe<span class="token punctuation">;</span>
	size_t be_len<span class="token punctuation">,</span> rbe_len<span class="token punctuation">;</span>
	<span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> tries <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> waitsec<span class="token punctuation">;</span>
	<span class="token keyword">int</span> r<span class="token punctuation">;</span>
	<span class="token keyword">uint16_t</span> msgid<span class="token punctuation">;</span>

	<span class="token comment">/* One plus a null entry. */</span>
	ret_ds <span class="token operator">=</span> <span class="token function">calloc</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span>ad_disc_ds_t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret_ds <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token keyword">goto</span> fail<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>PF_INET6<span class="token punctuation">,</span> SOCK_DGRAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">goto</span> fail<span class="token punctuation">;</span>

	<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>addr6<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span>addr6<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	addr6<span class="token punctuation">.</span>sin6_family <span class="token operator">=</span> AF_INET6<span class="token punctuation">;</span>
	addr6<span class="token punctuation">.</span>sin6_addr <span class="token operator">=</span> in6addr_any<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">bind</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>addr6<span class="token punctuation">,</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span>addr6<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">goto</span> fail<span class="token punctuation">;</span>

	<span class="token comment">/*
	 * semi-unique msgid...
	 */</span>
	msgid <span class="token operator">=</span> <span class="token function">gethrtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">;</span>

	<span class="token comment">/*
	 * Is ntver right? It certainly works on w2k8... If others are needed,
	 * that might require changes to cldap_parse
	 */</span>
	req <span class="token operator">=</span> <span class="token function">cldap_build_request</span><span class="token punctuation">(</span>dname<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	    NETLOGON_NT_VERSION_5EX<span class="token punctuation">,</span> msgid<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>req <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token keyword">goto</span> fail<span class="token punctuation">;</span>
	be <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> _berelement <span class="token operator">*</span><span class="token punctuation">)</span>req<span class="token punctuation">;</span>
	be_len <span class="token operator">=</span> be<span class="token operator">-&gt;</span>ber_end <span class="token operator">-</span> be<span class="token operator">-&gt;</span>ber_buf<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>res <span class="token operator">=</span> <span class="token function">ber_alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token keyword">goto</span> fail<span class="token punctuation">;</span>
	rbe <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> _berelement <span class="token operator">*</span><span class="token punctuation">)</span>res<span class="token punctuation">;</span>
	rbe_len <span class="token operator">=</span> rbe<span class="token operator">-&gt;</span>ber_end <span class="token operator">-</span> rbe<span class="token operator">-&gt;</span>ber_buf<span class="token punctuation">;</span>

	pingchk<span class="token punctuation">.</span>fd <span class="token operator">=</span> fd<span class="token punctuation">;</span>
	pingchk<span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>
	pingchk<span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

try_again<span class="token operator">:</span>
	send_ds <span class="token operator">=</span> dclist<span class="token punctuation">;</span>
	waitsec <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>recv_ds <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> waitsec <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token comment">/*
		 * If there is another candidate, send to it.
		 */</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>send_ds<span class="token operator">-&gt;</span>cds_ds<span class="token punctuation">.</span>host<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'\0'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">send_to_cds</span><span class="token punctuation">(</span>send_ds<span class="token punctuation">,</span> be<span class="token operator">-&gt;</span>ber_buf<span class="token punctuation">,</span> be_len<span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
			send_ds<span class="token operator">++</span><span class="token punctuation">;</span>

			<span class="token comment">/*
			 * Wait 1/10 sec. before the next send.
			 */</span>
			r <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pingchk<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">if</span> 0 </span><span class="token comment">/* DEBUG */</span>
			<span class="token comment">/* Drop all responses 1st pass. */</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>waitsec <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span>
				r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">/*
			 * No more candidates to "ping", so
			 * just wait a sec for responses.
			 */</span>
			r <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pingchk<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
				<span class="token operator">--</span>waitsec<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">/*
			 * Got a response.
			 */</span>
			<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>addr6<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> addrlen <span class="token operator">=</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span>addr6<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			r <span class="token operator">=</span> <span class="token function">recvfrom</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> rbe<span class="token operator">-&gt;</span>ber_buf<span class="token punctuation">,</span> rbe_len<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
			    <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>addr6<span class="token punctuation">,</span> <span class="token operator">&amp;</span>addrlen<span class="token punctuation">)</span><span class="token punctuation">;</span>

			recv_ds <span class="token operator">=</span> <span class="token function">find_cds_by_addr</span><span class="token punctuation">(</span>dclist<span class="token punctuation">,</span> <span class="token operator">&amp;</span>addr6<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>recv_ds <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>

			<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">cldap_parse</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> recv_ds<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>recv_ds<span class="token operator">-&gt;</span>cds_ds<span class="token punctuation">.</span>flags <span class="token operator">&amp;</span> reqflags<span class="token punctuation">)</span> <span class="token operator">!=</span> reqflags<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">logger</span><span class="token punctuation">(</span>LOG_ERR<span class="token punctuation">,</span> <span class="token string">"Skip %s"</span>
				    <span class="token string">"due to flags 0x%X"</span><span class="token punctuation">,</span>
				    recv_ds<span class="token operator">-&gt;</span>cds_ds<span class="token punctuation">.</span>host<span class="token punctuation">,</span>
				    recv_ds<span class="token operator">-&gt;</span>cds_ds<span class="token punctuation">.</span>flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
				recv_ds <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>recv_ds <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>tries <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token keyword">goto</span> fail<span class="token punctuation">;</span>
		<span class="token keyword">goto</span> try_again<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">memcpy</span><span class="token punctuation">(</span>ret_ds<span class="token punctuation">,</span> recv_ds<span class="token punctuation">,</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span><span class="token operator">*</span>ret_ds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">ber_free</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ber_free</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>ret_ds<span class="token punctuation">)</span><span class="token punctuation">;</span>

fail<span class="token operator">:</span>
	<span class="token function">ber_free</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ber_free</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">free</span><span class="token punctuation">(</span>ret_ds<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 370;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x11a4875c496302189868a6fa304e849ad419ca8b953ddc2692786ddb09f427e1-46,,174,"><div class="bs-example"><div><div class="bs-example-title">Exemple #25</div><div style="position:absolute;right:15px;top:10px" id="rating_25" data-hash="0x11a4875c496302189868a6fa304e849ad419ca8b953ddc2692786ddb09f427e1" data-area="46,,174,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;25&#39;)" class="rating-up btn btn-success" data-id="rating_25"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;25&#39;)" class="rating-down btn btn-danger" data-id="rating_25"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x11a4875c496302189868a6fa304e849ad419ca8b953ddc2692786ddb09f427e1-46,,174,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x11a4875c496302189868a6fa304e849ad419ca8b953ddc2692786ddb09f427e1&amp;fullName=AvunaDNS%2Fwork.c&amp;project=JavaProphet%2FAvunaDNSD&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FJavaProphet%2FAvunaDNSD%2Fblob%2Fmaster%2FAvunaDNS%2Fwork.c">work.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FJavaProphet%2FAvunaDNSD">JavaProphet/AvunaDNSD</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="25"><pre class="line-numbers  language-cpp" data-end="174" data-start="47" data-highlight="74"><span class="token keyword">void</span> <span class="token function">run_work</span><span class="token punctuation">(</span><span class="token keyword">struct</span> work_param<span class="token operator">*</span> param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">pipe</span><span class="token punctuation">(</span>param<span class="token operator">-&gt;</span>pipes<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Failed to create pipe! %s\n"</span><span class="token punctuation">,</span> <span class="token function">strerror</span><span class="token punctuation">(</span>errno<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> wb<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> mbuf <span class="token operator">=</span> <span class="token function">xmalloc</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">pthread_rwlock_rdlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>param<span class="token operator">-&gt;</span>conns<span class="token operator">-&gt;</span>data_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
		size_t cc <span class="token operator">=</span> param<span class="token operator">-&gt;</span>conns<span class="token operator">-&gt;</span>count<span class="token punctuation">;</span>
		<span class="token keyword">struct</span> pollfd fds<span class="token punctuation">[</span>cc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">struct</span> conn<span class="token operator">*</span> conns<span class="token punctuation">[</span>cc<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> fdi <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> param<span class="token operator">-&gt;</span>conns<span class="token operator">-&gt;</span>size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>param<span class="token operator">-&gt;</span>conns<span class="token operator">-&gt;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				conns<span class="token punctuation">[</span>fdi<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>param<span class="token operator">-&gt;</span>conns<span class="token operator">-&gt;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">struct</span> conn<span class="token operator">*</span> conn <span class="token operator">=</span> conns<span class="token punctuation">[</span>fdi<span class="token punctuation">]</span><span class="token punctuation">;</span>
				fds<span class="token punctuation">[</span>fdi<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> conns<span class="token punctuation">[</span>fdi<span class="token punctuation">]</span><span class="token operator">-&gt;</span>fd<span class="token punctuation">;</span>
				fds<span class="token punctuation">[</span>fdi<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN <span class="token operator">|</span> <span class="token punctuation">(</span>conn<span class="token operator">-&gt;</span>writeBuffer_size <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> POLLOUT <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				fds<span class="token punctuation">[</span>fdi<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>fdi <span class="token operator">==</span> cc<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> conns<span class="token punctuation">[</span>fdi<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token function">pthread_rwlock_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>param<span class="token operator">-&gt;</span>conns<span class="token operator">-&gt;</span>data_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
		fds<span class="token punctuation">[</span>cc<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> param<span class="token operator">-&gt;</span>pipes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fds<span class="token punctuation">[</span>cc<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>
		fds<span class="token punctuation">[</span>cc<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> cp <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>fds<span class="token punctuation">,</span> cc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>param<span class="token operator">-&gt;</span>mysql<span class="token operator">-&gt;</span>mysql <span class="token operator">&amp;&amp;</span> param<span class="token operator">-&gt;</span>mysql<span class="token operator">-&gt;</span>complete <span class="token operator">&amp;&amp;</span> param<span class="token operator">-&gt;</span>zone <span class="token operator">!=</span> param<span class="token operator">-&gt;</span>mysql<span class="token operator">-&gt;</span>czone<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>param<span class="token operator">-&gt;</span>zone <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">freeZone</span><span class="token punctuation">(</span>param<span class="token operator">-&gt;</span>zone<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			param<span class="token operator">-&gt;</span>zone <span class="token operator">=</span> param<span class="token operator">-&gt;</span>mysql<span class="token operator">-&gt;</span>czone<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>cp <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Poll error in worker thread! %s\n"</span><span class="token punctuation">,</span> <span class="token function">strerror</span><span class="token punctuation">(</span>errno<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fds<span class="token punctuation">[</span>cc<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span> <span class="token operator">==</span> POLLIN<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>param<span class="token operator">-&gt;</span>pipes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>wb<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error reading from pipe, infinite loop COULD happen here.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>cp<span class="token operator">--</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cc<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">int</span> re <span class="token operator">=</span> fds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents<span class="token punctuation">;</span>
			<span class="token keyword">struct</span> conn<span class="token operator">*</span> conn <span class="token operator">=</span> conns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>conn <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>re <span class="token operator">&amp;</span> POLLERR<span class="token punctuation">)</span> <span class="token operator">==</span> POLLERR<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">//printf("POLLERR in worker poll! This is bad!\n");</span>
				<span class="token keyword">goto</span> cont<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>re <span class="token operator">&amp;</span> POLLHUP<span class="token punctuation">)</span> <span class="token operator">==</span> POLLHUP<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">closeConn</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
				conn <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
				<span class="token keyword">goto</span> cont<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>re <span class="token operator">&amp;</span> POLLNVAL<span class="token punctuation">)</span> <span class="token operator">==</span> POLLNVAL<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Invalid FD in worker poll! This is bad!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">closeConn</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
				conn <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
				<span class="token keyword">goto</span> cont<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>re <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span> <span class="token operator">==</span> POLLIN<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				size_t tr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				<span class="token function">ioctl</span><span class="token punctuation">(</span>fds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> FIONREAD<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tr<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> loc<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>conn<span class="token operator">-&gt;</span>readBuffer <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					conn<span class="token operator">-&gt;</span>readBuffer <span class="token operator">=</span> <span class="token function">xmalloc</span><span class="token punctuation">(</span>tr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TODO: max upload?</span>
					conn<span class="token operator">-&gt;</span>readBuffer_size <span class="token operator">=</span> tr<span class="token punctuation">;</span>
					loc <span class="token operator">=</span> conn<span class="token operator">-&gt;</span>readBuffer<span class="token punctuation">;</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
					conn<span class="token operator">-&gt;</span>readBuffer_size <span class="token operator">+=</span> tr<span class="token punctuation">;</span>
					conn<span class="token operator">-&gt;</span>readBuffer <span class="token operator">=</span> <span class="token function">xrealloc</span><span class="token punctuation">(</span>conn<span class="token operator">-&gt;</span>readBuffer<span class="token punctuation">,</span> conn<span class="token operator">-&gt;</span>readBuffer_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
					loc <span class="token operator">=</span> conn<span class="token operator">-&gt;</span>readBuffer <span class="token operator">+</span> conn<span class="token operator">-&gt;</span>readBuffer_size <span class="token operator">-</span> tr<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				ssize_t r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> tr <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// nothing to read, but wont block.</span>
					ssize_t x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
					x <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>fds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> loc <span class="token operator">+</span> r<span class="token punctuation">,</span> tr <span class="token operator">-</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token function">closeConn</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
						conn <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
						<span class="token keyword">goto</span> cont<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					r <span class="token operator">+=</span> x<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">while</span> <span class="token punctuation">(</span>r <span class="token operator">&lt;</span> tr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					ssize_t x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
					x <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>fds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> loc <span class="token operator">+</span> r<span class="token punctuation">,</span> tr <span class="token operator">-</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token function">closeConn</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
						conn <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
						<span class="token keyword">goto</span> cont<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					r <span class="token operator">+=</span> x<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">int</span> p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				p <span class="token operator">=</span> <span class="token function">handleRead</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> param<span class="token punctuation">,</span> fds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">goto</span> cont<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>re <span class="token operator">&amp;</span> POLLOUT<span class="token punctuation">)</span> <span class="token operator">==</span> POLLOUT <span class="token operator">&amp;&amp;</span> conn <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				ssize_t mtr <span class="token operator">=</span> <span class="token function">write</span><span class="token punctuation">(</span>fds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd<span class="token punctuation">,</span> conn<span class="token operator">-&gt;</span>writeBuffer<span class="token punctuation">,</span> conn<span class="token operator">-&gt;</span>writeBuffer_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>mtr <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> errno <span class="token operator">!=</span> EAGAIN<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">closeConn</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
					conn <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
					<span class="token keyword">goto</span> cont<span class="token punctuation">;</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mtr <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">goto</span> cont<span class="token punctuation">;</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mtr <span class="token operator">&lt;</span> conn<span class="token operator">-&gt;</span>writeBuffer_size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">memmove</span><span class="token punctuation">(</span>conn<span class="token operator">-&gt;</span>writeBuffer<span class="token punctuation">,</span> conn<span class="token operator">-&gt;</span>writeBuffer <span class="token operator">+</span> mtr<span class="token punctuation">,</span> conn<span class="token operator">-&gt;</span>writeBuffer_size <span class="token operator">-</span> mtr<span class="token punctuation">)</span><span class="token punctuation">;</span>
					conn<span class="token operator">-&gt;</span>writeBuffer_size <span class="token operator">-=</span> mtr<span class="token punctuation">;</span>
					conn<span class="token operator">-&gt;</span>writeBuffer <span class="token operator">=</span> <span class="token function">xrealloc</span><span class="token punctuation">(</span>conn<span class="token operator">-&gt;</span>writeBuffer<span class="token punctuation">,</span> conn<span class="token operator">-&gt;</span>writeBuffer_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
					conn<span class="token operator">-&gt;</span>writeBuffer_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
					<span class="token function">xfree</span><span class="token punctuation">(</span>conn<span class="token operator">-&gt;</span>writeBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
					conn<span class="token operator">-&gt;</span>writeBuffer <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>conn<span class="token operator">-&gt;</span>writeBuffer_size <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> conn<span class="token operator">-&gt;</span>state <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">closeConn</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
					conn <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
					<span class="token keyword">goto</span> cont<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			cont<span class="token operator">:</span> <span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>cp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">xfree</span><span class="token punctuation">(</span>mbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:567px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 46;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x11bea550e3cc1a239d8e8028798b0e99accb2c974026a6eb988c1a5c8d24b137-11,,98,"><div class="bs-example"><div><div class="bs-example-title">Exemple #26</div><div style="position:absolute;right:15px;top:10px" id="rating_26" data-hash="0x11bea550e3cc1a239d8e8028798b0e99accb2c974026a6eb988c1a5c8d24b137" data-area="11,,98,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;26&#39;)" class="rating-up btn btn-success" data-id="rating_26"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;26&#39;)" class="rating-down btn btn-danger" data-id="rating_26"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x11bea550e3cc1a239d8e8028798b0e99accb2c974026a6eb988c1a5c8d24b137-11,,98,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x11bea550e3cc1a239d8e8028798b0e99accb2c974026a6eb988c1a5c8d24b137&amp;fullName=cerveau-master%2Fmultipipe.c&amp;project=7Robot%2FARM&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2F7Robot%2FARM%2Fblob%2Fmaster%2Fcerveau-master%2Fmultipipe.c">multipipe.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2F7Robot%2FARM">7Robot/ARM</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="26"><pre class="line-numbers  language-cpp" data-end="98" data-start="12" data-highlight="70"><span class="token keyword">int</span> <span class="token function">multipipe</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">,</span> <span class="token keyword">int</span> fd<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span> r<span class="token punctuation">,</span> w<span class="token punctuation">,</span> p<span class="token punctuation">;</span>

	<span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span> buffers<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>buffers <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>buffers<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>BUFSIZE <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> <span class="token operator">*</span> c<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> <span class="token operator">*</span> t<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">struct</span> pollfd <span class="token operator">*</span> pfd <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pfd <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> size <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> pollfd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

		p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> BUFSIZE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				pfd<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> fd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				pfd<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>
				pfd<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				t<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
				p<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				pfd<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> fd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				pfd<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLOUT<span class="token punctuation">;</span>
				pfd<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				t<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
				p<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>pfd<span class="token punctuation">,</span> p<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> errno <span class="token operator">==</span> EINTR<span class="token punctuation">)</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"poll"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> p <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>pfd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLIN<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">[</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> buffers<span class="token punctuation">[</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> BUFSIZE<span class="token operator">-</span>c<span class="token punctuation">[</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>errno <span class="token operator">!=</span> EAGAIN <span class="token operator">&amp;&amp;</span> errno <span class="token operator">!=</span> EWOULDBLOCK<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"read"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				c<span class="token punctuation">[</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+=</span> r<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>pfd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLOUT<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>w <span class="token operator">=</span> <span class="token function">write</span><span class="token punctuation">(</span>fd<span class="token punctuation">[</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> buffers<span class="token punctuation">[</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"write"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>w <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					c<span class="token punctuation">[</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">-=</span> w<span class="token punctuation">;</span>
					<span class="token function">memmove</span><span class="token punctuation">(</span>buffers<span class="token punctuation">[</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>buffers<span class="token punctuation">[</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:1218px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 11;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x11d5dc9388b7bc072f283ec6851ac403480083a3bbceb19b42a897720a86fccf-542,,611,"><div class="bs-example"><div><div class="bs-example-title">Exemple #27</div><div style="position:absolute;right:15px;top:10px" id="rating_27" data-hash="0x11d5dc9388b7bc072f283ec6851ac403480083a3bbceb19b42a897720a86fccf" data-area="542,,611,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;27&#39;)" class="rating-up btn btn-success" data-id="rating_27"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;27&#39;)" class="rating-down btn btn-danger" data-id="rating_27"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x11d5dc9388b7bc072f283ec6851ac403480083a3bbceb19b42a897720a86fccf-542,,611,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x11d5dc9388b7bc072f283ec6851ac403480083a3bbceb19b42a897720a86fccf&amp;fullName=illumos-gate-master%2Fusr%2Fsrc%2Fcmd%2Fpicl%2Fplugins%2Fsun4u%2Fsnowbird%2Fpicldr.c&amp;project=AlainODea%2Fillumos-gate&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FAlainODea%2Fillumos-gate%2Fblob%2Fmaster%2Fillumos-gate-master%2Fusr%2Fsrc%2Fcmd%2Fpicl%2Fplugins%2Fsun4u%2Fsnowbird%2Fpicldr.c">picldr.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2FAlainODea%2Fillumos-gate">AlainODea/illumos-gate</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="27"><pre class="line-numbers  language-cpp" data-end="611" data-start="543" data-highlight="598"><span class="token comment">/*ARGSUSED*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token operator">*</span>
<span class="token function">env_polling_thread</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>args<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span>			poll_rc<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> pollfd		poll_fds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span>			<span class="token operator">*</span>datap<span class="token punctuation">;</span>
	<span class="token keyword">int</span>			smcfd<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> strioctl		strio<span class="token punctuation">;</span>
	sc_cmdspec_t		set<span class="token punctuation">;</span>

	smcfd <span class="token operator">=</span> <span class="token function">env_open_smc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>smcfd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">syslog</span><span class="token punctuation">(</span>LOG_ERR<span class="token punctuation">,</span> <span class="token function">gettext</span><span class="token punctuation">(</span><span class="token string">"SUNW_envmond:Error in polling, "</span>
			<span class="token string">"Open of SMC drv failed"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		create_polling_thr <span class="token operator">=</span> B_TRUE<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	set<span class="token punctuation">.</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>	<span class="token operator">=</span> SMC_SENSOR_EVENT_ENABLE_SET<span class="token punctuation">;</span>
	set<span class="token punctuation">.</span>attribute	<span class="token operator">=</span> SC_ATTR_SHARED<span class="token punctuation">;</span>
	strio<span class="token punctuation">.</span>ic_cmd	<span class="token operator">=</span> SCIOC_MSG_SPEC<span class="token punctuation">;</span>
	strio<span class="token punctuation">.</span>ic_timout	<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	strio<span class="token punctuation">.</span>ic_len	<span class="token operator">=</span> ENV_SENSOR_EV_ENABLE_PKT_LEN<span class="token punctuation">;</span>
	strio<span class="token punctuation">.</span>ic_dp	<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>set<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ioctl</span><span class="token punctuation">(</span>smcfd<span class="token punctuation">,</span> I_STR<span class="token punctuation">,</span> <span class="token operator">&amp;</span>strio<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">syslog</span><span class="token punctuation">(</span>LOG_ERR<span class="token punctuation">,</span> <span class="token function">gettext</span><span class="token punctuation">(</span><span class="token string">"SUNW_envmond:Request for "</span>
			<span class="token string">"Sensor events failed"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">close</span><span class="token punctuation">(</span>smcfd<span class="token punctuation">)</span><span class="token punctuation">;</span>
		create_polling_thr <span class="token operator">=</span> B_TRUE<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/* request for async messages */</span>
	poll_fds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fd		<span class="token operator">=</span> smcfd<span class="token punctuation">;</span>
	poll_fds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>events	<span class="token operator">=</span> POLLIN<span class="token operator">|</span>POLLPRI<span class="token punctuation">;</span>
	poll_fds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>revents	<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	set<span class="token punctuation">.</span>attribute	<span class="token operator">=</span> SC_ATTR_SHARED<span class="token punctuation">;</span>
	set<span class="token punctuation">.</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>	<span class="token operator">=</span> SMC_IPMI_RESPONSE_NOTIF<span class="token punctuation">;</span>
	set<span class="token punctuation">.</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>	<span class="token operator">=</span> SMC_SMC_LOCAL_EVENT_NOTIF<span class="token punctuation">;</span>
	strio<span class="token punctuation">.</span>ic_cmd	<span class="token operator">=</span> SCIOC_MSG_SPEC<span class="token punctuation">;</span>
	strio<span class="token punctuation">.</span>ic_timout	<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	strio<span class="token punctuation">.</span>ic_len	<span class="token operator">=</span> ENV_IPMI_SMC_ENABLE_PKT_LEN<span class="token punctuation">;</span>
	strio<span class="token punctuation">.</span>ic_dp	<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>set<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ioctl</span><span class="token punctuation">(</span>smcfd<span class="token punctuation">,</span> I_STR<span class="token punctuation">,</span> <span class="token operator">&amp;</span>strio<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">syslog</span><span class="token punctuation">(</span>LOG_ERR<span class="token punctuation">,</span> <span class="token function">gettext</span><span class="token punctuation">(</span><span class="token string">"SUNW_envmond:Request for"</span>
			<span class="token string">"Async messages failed"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">close</span><span class="token punctuation">(</span>smcfd<span class="token punctuation">)</span><span class="token punctuation">;</span>
		create_polling_thr <span class="token operator">=</span> B_TRUE<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/* Now wait for SMC events to come */</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		poll_rc <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>poll_fds<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* poll forever */</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>poll_rc <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">syslog</span><span class="token punctuation">(</span>LOG_ERR<span class="token punctuation">,</span> <span class="token function">gettext</span><span class="token punctuation">(</span><span class="token string">"SUNW_envmond:Event "</span>
				<span class="token string">"processing halted"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">env_process_smc_event</span><span class="token punctuation">(</span>smcfd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>datap<span class="token punctuation">)</span> <span class="token operator">==</span> NO_EVENT<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">syslog</span><span class="token punctuation">(</span>LOG_ERR<span class="token punctuation">,</span> <span class="token function">gettext</span><span class="token punctuation">(</span><span class="token string">"SUNW_envmond:"</span>
				<span class="token string">"wrong event data posted from SMC"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token function">close</span><span class="token punctuation">(</span>smcfd<span class="token punctuation">)</span><span class="token punctuation">;</span>
	create_polling_thr <span class="token operator">=</span> B_TRUE<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:1155px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 542;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef-726,,791,"><div class="bs-example"><div><div class="bs-example-title">Exemple #28</div><div style="position:absolute;right:15px;top:10px" id="rating_28" data-hash="0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef" data-area="726,,791,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;28&#39;)" class="rating-up btn btn-success" data-id="rating_28"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;28&#39;)" class="rating-down btn btn-danger" data-id="rating_28"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef-726,,791,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef&amp;fullName=main.cpp&amp;project=kevintrinh%2Fsoftserver&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevintrinh%2Fsoftserver%2Fblob%2Fmaster%2Fmain.cpp">main.cpp</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevintrinh%2Fsoftserver">kevintrinh/softserver</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="28"><pre class="line-numbers  language-cpp" data-end="791" data-start="727" data-highlight="786"><span class="token keyword">bool</span> <span class="token function">stop_serv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>bServerOnline<span class="token punctuation">)</span>  <span class="token comment">//Make sure it actually is online</span>
    <span class="token punctuation">{</span>
        <span class="token function">gtk_widget_set_sensitive</span><span class="token punctuation">(</span>start_and_stop_button<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bServerOnline <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">//Make sure the server is actually off</span>
        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Main]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span><span class="token string">"Waiting for all threads to complete"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">check_if_all_threads_completed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">/*Wait for safety!*/</span>
        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Main]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span><span class="token string">"All threads have exited safely"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>rgClients<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">close</span><span class="token punctuation">(</span>rgClients<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>uiSocketUDP<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">close</span><span class="token punctuation">(</span>rgClients<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>uiSocketTCP<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
         <span class="token comment">/*Wait for safety!*/</span>
        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Main]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span><span class="token string">"All sockets (including server's) have been closed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/*Back up all players here*/</span>
        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Main]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span><span class="token string">"Pushing all accounts to save queue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>rgAccounts<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>rgAccounts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>status <span class="token operator">==</span> active<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                qSaveAccounts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>rgAccounts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Main]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span><span class="token string">"Waiting for saving queue to finish"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>qSaveAccounts<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Block until qSaveAccounts has been all worked upon</span>
         <span class="token comment">/*Wait for safety!*/</span>

        <span class="token comment">/*Cleaning up for next time init*/</span>
        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Main]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span><span class="token string">"Cleaning up existing list of sockets, clients, and accounts"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rgAccounts<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">/*Wait for safety!*/</span>
        rgClients<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">/*Wait for safety!*/</span>
        rgSockets<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Clear these parallel mother fuckers!</span>

        <span class="token comment">/*Close databases*/</span>
        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Database]"</span><span class="token punctuation">,</span> notification<span class="token punctuation">,</span><span class="token string">"Closing database/accounts.db"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sqlite3_close</span><span class="token punctuation">(</span>accounts_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
        accounts_db <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Database]"</span><span class="token punctuation">,</span> notification<span class="token punctuation">,</span><span class="token string">"Accounts database has successfully closed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">/*Wait for safety!*/</span>
        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Database]"</span><span class="token punctuation">,</span> notification<span class="token punctuation">,</span><span class="token string">"Closing database/area.db"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sqlite3_close</span><span class="token punctuation">(</span>area_db<span class="token punctuation">)</span><span class="token punctuation">;</span>
        accounts_db <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Database]"</span><span class="token punctuation">,</span> notification<span class="token punctuation">,</span><span class="token string">"Area database has successfully closed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">gtk_button_set_label</span><span class="token punctuation">(</span><span class="token punctuation">(</span>GtkButton<span class="token operator">*</span><span class="token punctuation">)</span>start_and_stop_button<span class="token punctuation">,</span> <span class="token string">"Start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">g_signal_handler_disconnect</span><span class="token punctuation">(</span>start_and_stop_button<span class="token punctuation">,</span> start_stop_button_ls_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        start_stop_button_ls_id <span class="token operator">=</span> <span class="token function">g_signal_connect_after</span><span class="token punctuation">(</span>start_and_stop_button<span class="token punctuation">,</span> <span class="token string">"released"</span><span class="token punctuation">,</span> <span class="token function">G_CALLBACK</span><span class="token punctuation">(</span>init_serv<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Main]"</span><span class="token punctuation">,</span>notification<span class="token punctuation">,</span><span class="token string">"Server has stopped successfully"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">change_status_msg</span><span class="token punctuation">(</span><span class="token string">"&lt;span foreground='red'&gt;&lt;b&gt;Offline&lt;/b&gt;&lt;/span&gt; The server has stopped successfully"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Server]"</span><span class="token punctuation">,</span> important_offline<span class="token punctuation">,</span> <span class="token string">"[Server is now offline]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">poll</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">gtk_widget_set_sensitive</span><span class="token punctuation">(</span>start_and_stop_button<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bConsoleActive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">//Turn off console</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:1239px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 726;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x10ae9dfb23912d0f304d29fad48586dfa03f81e4cfc3e2f70cc8af75f176d7c4-1186,,1250,"><div class="bs-example"><div><div class="bs-example-title">Exemple #29</div><div style="position:absolute;right:15px;top:10px" id="rating_29" data-hash="0x10ae9dfb23912d0f304d29fad48586dfa03f81e4cfc3e2f70cc8af75f176d7c4" data-area="1186,,1250,"><div class="rating-amount">0</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;29&#39;)" class="rating-up btn btn-success" data-id="rating_29"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;29&#39;)" class="rating-down btn btn-danger" data-id="rating_29"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x10ae9dfb23912d0f304d29fad48586dfa03f81e4cfc3e2f70cc8af75f176d7c4-1186,,1250,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x10ae9dfb23912d0f304d29fad48586dfa03f81e4cfc3e2f70cc8af75f176d7c4&amp;fullName=uclinux-2-master%2Flib%2FDirectFB%2FDirectFB-1.2.7%2Flib%2Fmanager.c&amp;project=kizukukoto%2FWDN900_GPL&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkizukukoto%2FWDN900_GPL%2Fblob%2Fmaster%2Fuclinux-2-master%2Flib%2FDirectFB%2FDirectFB-1.2.7%2Flib%2Fmanager.c">manager.c</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkizukukoto%2FWDN900_GPL">kizukukoto/WDN900_GPL</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="29"><pre class="line-numbers  language-cpp" data-end="1250" data-start="1187" data-highlight="1202"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token operator">*</span>
<span class="token function">manager_input_loop</span><span class="token punctuation">(</span> DirectThread <span class="token operator">*</span>thread<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>arg <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
     <span class="token keyword">int</span>            len<span class="token punctuation">;</span>
     <span class="token keyword">struct</span> pollfd  pf<span class="token punctuation">;</span>
     VoodooManager <span class="token operator">*</span>manager <span class="token operator">=</span> arg<span class="token punctuation">;</span>

     manager<span class="token operator">-&gt;</span>millis <span class="token operator">=</span> <span class="token function">direct_clock_get_millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>manager<span class="token operator">-&gt;</span>quit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">D_MAGIC_ASSERT</span><span class="token punctuation">(</span> manager<span class="token punctuation">,</span> VoodooManager <span class="token punctuation">)</span><span class="token punctuation">;</span>

          pf<span class="token punctuation">.</span>fd     <span class="token operator">=</span> manager<span class="token operator">-&gt;</span>fd<span class="token punctuation">;</span>
          pf<span class="token punctuation">.</span>events <span class="token operator">=</span> POLLIN<span class="token punctuation">;</span>

          <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">poll</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>pf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>errno <span class="token operator">!=</span> EINTR<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                         <span class="token function">D_PERROR</span><span class="token punctuation">(</span> <span class="token string">"Voodoo/Input: Could not poll() the socket!\n"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                         <span class="token function">usleep</span><span class="token punctuation">(</span> <span class="token number">200000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token comment">/* fall through */</span>

               <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                    <span class="token keyword">continue</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>

          <span class="token function">pthread_mutex_lock</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>lock <span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token keyword">while</span> <span class="token punctuation">(</span>manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>end <span class="token operator">==</span> manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>max<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token function">pthread_cond_wait</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>wait<span class="token punctuation">,</span> <span class="token operator">&amp;</span>manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>lock <span class="token punctuation">)</span><span class="token punctuation">;</span>

               <span class="token keyword">if</span> <span class="token punctuation">(</span>manager<span class="token operator">-&gt;</span>quit<span class="token punctuation">)</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>

          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>manager<span class="token operator">-&gt;</span>quit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               len <span class="token operator">=</span> <span class="token function">recv</span><span class="token punctuation">(</span> manager<span class="token operator">-&gt;</span>fd<span class="token punctuation">,</span> manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>buffer <span class="token operator">+</span> manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>end<span class="token punctuation">,</span>
                           manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>max <span class="token operator">-</span> manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>end<span class="token punctuation">,</span> MSG_DONTWAIT <span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">switch</span> <span class="token punctuation">(</span>errno<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                         <span class="token keyword">case</span> EINTR<span class="token operator">:</span>
                         <span class="token keyword">case</span> EAGAIN<span class="token operator">:</span>
                              <span class="token keyword">break</span><span class="token punctuation">;</span>
                         <span class="token keyword">default</span><span class="token operator">:</span>
                              <span class="token function">D_PERROR</span><span class="token punctuation">(</span> <span class="token string">"Voodoo/Input: Could not recv() data!\n"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                              <span class="token function">usleep</span><span class="token punctuation">(</span> <span class="token number">200000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
               <span class="token punctuation">}</span>
               <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">D_DEBUG</span><span class="token punctuation">(</span> <span class="token string">"Voodoo/Input: Received %d bytes...\n"</span><span class="token punctuation">,</span> len <span class="token punctuation">)</span><span class="token punctuation">;</span>

                    manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>end <span class="token operator">+=</span> len<span class="token punctuation">;</span>

                    <span class="token function">pthread_cond_broadcast</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>wait <span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
               <span class="token keyword">else</span>
                    <span class="token function">handle_disconnect</span><span class="token punctuation">(</span> manager <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>

          <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>manager<span class="token operator">-&gt;</span>input<span class="token punctuation">.</span>lock <span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:315px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 1186;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div class="example-item" id="0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef-614,,724,"><div class="bs-example"><div><div class="bs-example-title">Exemple #30</div><div style="position:absolute;right:15px;top:10px" id="rating_30" data-hash="0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef" data-area="614,,724,"><div class="rating-amount">-12</div><a title="Noter cet exemple comme bon" href="javascript:app.addRating(1, &#39;30&#39;)" class="rating-up btn btn-success" data-id="rating_30"><i class="icon-button icon-thumbs-up"></i></a><a title="Noter cet exemple comme mauvais" href="javascript:app.addRating(-1,&#39;30&#39;)" class="rating-down btn btn-danger" data-id="rating_30"><i class="icon-button icon-thumbs-down"></i></a></div></div><div style="display:flex;align-items:center;flex-wrap:wrap"><div style="display:inline-block;margin-right:10px"><a class="btn btn-default" title="Lien direct vers cet exemple" href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html#0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef-614,,724,"><i class="icon-button icon-link"></i></a><a rel="nofollow" class="btn btn-default" href="javascript:app.open(&#39;https://cpp.hotexamples.com/fr/site/file?hash=0x12ca6544a54e35f4e36ae8e9489d8d9e86adf360ddc079f0319c0234a74567ef&amp;fullName=main.cpp&amp;project=kevintrinh%2Fsoftserver&#39;)">Afficher le fichier</a></div><div class="example-project-info"><nobr><span>Fichier :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevintrinh%2Fsoftserver%2Fblob%2Fmaster%2Fmain.cpp">main.cpp</a></nobr>
<nobr><span>Projet :</span>
<a target="_blank" rel="nofollow" href="https://cpp.hotexamples.com/fr/site/redirect?url=https%3A%2F%2Fgithub.com%2Fkevintrinh%2Fsoftserver">kevintrinh/softserver</a></nobr></div></div></div><figure class="highlight"><div class="example" data-id="30"><pre class="line-numbers  language-cpp" data-end="724" data-start="615" data-highlight="706"><span class="token keyword">bool</span> <span class="token function">init_serv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>bServerOnline<span class="token punctuation">)</span>  <span class="token comment">//Make sure it is offline.</span>
    <span class="token punctuation">{</span>
        <span class="token function">activate_console</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">gtk_widget_set_sensitive</span><span class="token punctuation">(</span>start_and_stop_button<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*Gray it out*/</span>

        init_args xml_args <span class="token operator">=</span> <span class="token function">load_external_files</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>xml_args<span class="token punctuation">.</span>bSuccess<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">gtk_widget_set_sensitive</span><span class="token punctuation">(</span>start_and_stop_button<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Server]"</span><span class="token punctuation">,</span>error<span class="token punctuation">,</span><span class="token string">"has ended init_serv() process"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">//End server start up right away</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">bool</span> bErrorFree <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>bThreadActive<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">//Start all threads false</span>
        <span class="token punctuation">{</span>
            bThreadActive<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>

        uiMasterSocketTCP <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>uiMasterSocketTCP <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"tcp-socket"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Init]"</span><span class="token punctuation">,</span>error<span class="token punctuation">,</span><span class="token string">"Could not initialize TCP socket"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        uiMasterSocketUDP <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_DGRAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>uiMasterSocketUDP <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"udp-socket"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Init]"</span><span class="token punctuation">,</span>error<span class="token punctuation">,</span><span class="token string">"Could not initialize UDP socket"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>SBindTCPAddress<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>SBindTCPAddress<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Memset to make sure</span>
        <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>SBindUDPAddress<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>SBindUDPAddress<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Memset to make sure</span>

        SBindTCPAddress<span class="token punctuation">.</span>sin_family <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span>
        SBindUDPAddress<span class="token punctuation">.</span>sin_family <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span>
        SBindTCPAddress<span class="token punctuation">.</span>sin_port <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span>xml_args<span class="token punctuation">.</span>uiPortTCP<span class="token punctuation">)</span><span class="token punctuation">;</span>
        SBindUDPAddress<span class="token punctuation">.</span>sin_port <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span>xml_args<span class="token punctuation">.</span>uiPortUDP<span class="token punctuation">)</span><span class="token punctuation">;</span>
        SBindTCPAddress<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> INADDR_ANY<span class="token punctuation">;</span>
        SBindUDPAddress<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> INADDR_ANY<span class="token punctuation">;</span>



        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">bind</span><span class="token punctuation">(</span>uiMasterSocketTCP<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr<span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>SBindTCPAddress<span class="token punctuation">,</span> <span class="token keyword">sizeof</span> SBindTCPAddress<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"tcp-bind"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Perrors are only for us to debug</span>
            <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Init]"</span><span class="token punctuation">,</span>error<span class="token punctuation">,</span> <span class="token string">"Could not bind TCP"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//These are for the end-user</span>
            bErrorFree <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">bind</span><span class="token punctuation">(</span>uiMasterSocketUDP<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr<span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>SBindUDPAddress<span class="token punctuation">,</span> <span class="token keyword">sizeof</span> SBindUDPAddress<span class="token punctuation">)</span>  <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"udp-bind"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Init]"</span><span class="token punctuation">,</span>error<span class="token punctuation">,</span> <span class="token string">"Could not bind UDP"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            bErrorFree <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">listen</span><span class="token punctuation">(</span>uiMasterSocketTCP<span class="token punctuation">,</span> xml_args<span class="token punctuation">.</span>uiMaxQueue<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"tcp-listen"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Init]"</span><span class="token punctuation">,</span>error<span class="token punctuation">,</span> <span class="token string">"Could not listen on TCP socket"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            bErrorFree <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        bServerOnline <span class="token operator">=</span> bErrorFree<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>bErrorFree<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>


            <span class="token comment">/*listen thread*/</span>
            thread_args listen_thread_args<span class="token punctuation">;</span>
            <span class="token function">pthread_create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>listen_thread<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> listen_thread_func<span class="token punctuation">,</span> <span class="token operator">&amp;</span>listen_thread_args<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">/*flow thread*/</span>
            thread_args flow_thread_args<span class="token punctuation">;</span>
            <span class="token function">pthread_create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>flow_thread<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> flow_thread_func<span class="token punctuation">,</span> <span class="token operator">&amp;</span>flow_thread_args<span class="token punctuation">)</span><span class="token punctuation">;</span>

            thread_args save_thread_args<span class="token punctuation">;</span>
            <span class="token function">pthread_create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>save_thread<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> save_thread_func<span class="token punctuation">,</span> <span class="token operator">&amp;</span>save_thread_args<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">poll</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> CPU_DELAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">check_if_all_threads_running</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token function">gtk_widget_set_sensitive</span><span class="token punctuation">(</span>start_and_stop_button<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*ungray*/</span>
                    <span class="token function">gtk_button_set_label</span><span class="token punctuation">(</span><span class="token punctuation">(</span>GtkButton<span class="token operator">*</span><span class="token punctuation">)</span>start_and_stop_button<span class="token punctuation">,</span> <span class="token string">"Stop"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">g_signal_handler_disconnect</span><span class="token punctuation">(</span>start_and_stop_button<span class="token punctuation">,</span> start_stop_button_ls_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    start_stop_button_ls_id <span class="token operator">=</span> <span class="token function">g_signal_connect_after</span><span class="token punctuation">(</span>start_and_stop_button<span class="token punctuation">,</span> <span class="token string">"released"</span><span class="token punctuation">,</span> <span class="token function">G_CALLBACK</span><span class="token punctuation">(</span>stop_serv<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">change_status_msg</span><span class="token punctuation">(</span><span class="token string">"&lt;span foreground='green'&gt;&lt;b&gt;Online&lt;/b&gt;&lt;/span&gt; &lt;b&gt;0&lt;/b&gt; user(s) connected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">add_console_msg</span><span class="token punctuation">(</span><span class="token string">"[Server]"</span><span class="token punctuation">,</span> important_online<span class="token punctuation">,</span> <span class="token string">"[Server is now online]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>


            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><div class="line-highlight" style="height: 21px;top:1911px"></div><span class="line-numbers-rows" style="left:0;counter-reset: linenumber 614;padding-top: 14px;line-height: 21px"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></figure></div><div id="all-examples"></div></div></div></strong></div><strong><div class="page-side-banner hidden-xs hidden-sm hidden-md" style="width: 300px; height: auto;"><span id="ezoic-pub-ad-placeholder-131"></span><span class="ezoic-ad banner-2 banner-2131 adtester-container adtester-container-131 ez-sticky" data-ez-name="hotexamples_com-banner-2"><span id="div-gpt-ad-hotexamples_com-banner-2-0" ezaw="300" ezah="250" style="position:relative;z-index:0;display:inline-block;padding:0;min-height:250px;min-width:300px" class="ezoic-ad"><script data-ezscrex="false" data-cfasync="false" style="display:none">if(typeof __ez_fad_position!='undefined'){__ez_fad_position('div-gpt-ad-hotexamples_com-banner-2-0')};</script></span><span style="width:300px;display:block;height:14px;margin:auto" class="reportline"><span style="text-align:center;font-size:smaller;float:left;line-height:normal"><a href="https://www.ezoic.com/what-is-ezoic/" target="_blank" rel="noopener noreferrer nofollow" style="cursor:pointer"><img src="./C++ (Cpp) poll Exemples - HotExamples_files/ezoic.png" alt="Ezoic" style="height:12px!important;padding:2px!important;border:0!important;cursor:pointer!important;width:58px!important;margin:0!important;box-sizing:content-box!important"></a></span><span class="ez-report-ad-button" name="?pageview_id=ba6b9e4a-2fe5-4554-4fd2-dd3f475f90e8&amp;ad_position_id=131&amp;impression_group_id=hotexamples_com-banner-2/2021-08-07/4786046734443026&amp;ad_size=300x250&amp;domain_id=110793&amp;url=https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html" style="cursor:pointer!important;font-size:12px!important;color:#a5a5a5;float:right;text-decoration:none!important;font-family:arial!important;line-height:normal">report this ad</span></span></span></div></strong></div><strong></strong></div><iframe name="__tcfapiLocator" style="display: none;" src="./C++ (Cpp) poll Exemples - HotExamples_files/saved_resource.html"></iframe><strong><footer class="footer"><div class="container"><div class="row"><div class="col-md-12" style="text-align:center"><a href="https://cpp.hotexamples.com/fr/site/trends?type=cpp%7Cf">Fonctions les mieux classées</a> |
<a href="https://cpp.hotexamples.com/fr/site/trends?type=cpp%7Cc">Classes les mieux classées</a>
| <a href="https://cpp.hotexamples.com/site/privacy">Politique de confidentialité</a></div></div><div class="row"><div class="col-md-12" style="text-align:center"><a href="https://hotexamples.com/fr/">PHP</a>
| <a href="https://csharp.hotexamples.com/fr/">C# (CSharp)</a>
| <a href="https://java.hotexamples.com/fr/">Java</a>
| <a href="https://golang.hotexamples.com/fr/">Golang</a>
| <a href="https://cpp.hotexamples.com/fr/">C++ (Cpp)</a>
| <a href="https://python.hotexamples.com/fr/">Python</a>
| <a href="https://javascript.hotexamples.com/fr/">JavaScript</a>
| <a href="https://typescript.hotexamples.com/fr/">TypeScript</a></div></div><div class="row"><div class="col-md-12" style="text-align:center"><a href="https://cpp.hotexamples.com/examples/-/-/poll/cpp-poll-function-examples.html">EN</a>
| <a href="https://cpp.hotexamples.com/ru/examples/-/-/poll/cpp-poll-function-examples.html">RU</a>
| <a href="https://cpp.hotexamples.com/de/examples/-/-/poll/cpp-poll-function-examples.html">DE</a>
| <a href="https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html">FR</a>
| <a href="https://cpp.hotexamples.com/es/examples/-/-/poll/cpp-poll-function-examples.html">ES</a>
| <a href="https://cpp.hotexamples.com/pt/examples/-/-/poll/cpp-poll-function-examples.html">PT</a>
| <a href="https://cpp.hotexamples.com/it/examples/-/-/poll/cpp-poll-function-examples.html">IT</a>
| <a href="https://cpp.hotexamples.com/jp/examples/-/-/poll/cpp-poll-function-examples.html">JP</a>
| <a href="https://cpp.hotexamples.com/zh/examples/-/-/poll/cpp-poll-function-examples.html">ZH</a></div></div><div class="row"><div class="col-md-10 col-md-offset-1"></div><div class="col-md-1"><script ez-screx="true">__ez.scxr.getDW(document).write("<a href='//www.liveinternet.ru/click' "+
"target=_blank><img src='//counter.yadro.ru/hit?t44.6;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";"+Math.random()+
"' alt='' title='LiveInternet' "+
"border='0' width='31' height='31'><\/a>");</script><a href="https://www.liveinternet.ru/click" target="_blank"><img src="./C++ (Cpp) poll Exemples - HotExamples_files/hit" alt="" title="LiveInternet" border="0" width="31" height="31"></a></div></div></div></footer><script src="./C++ (Cpp) poll Exemples - HotExamples_files/jquery.min.js" ez-screx="true"></script><script src="./C++ (Cpp) poll Exemples - HotExamples_files/0ece11eaf2d51f90dc0ed9b7c5f3722eadd637bd.js" ez-screx="true"></script><script ez-screx="true">setTimeout(function(){var headID=document.getElementsByTagName("head")[0];var newScript=document.createElement('script');newScript.type='text/javascript';newScript.src='//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5981be286ade2bca';headID.appendChild(newScript);},10000);</script><script ez-screx="true">ezoicSiteSpeed(jQuery,String(/documentReady/).substring(1).slice(0,-1),String(/jQuery-document-ready/).substring(1).slice(0,-1),function($){jQuery('#search-form').yiiActiveForm([{"id":"searchform-lang","name":"lang","container":".field-searchform-lang","input":"#searchform-lang","enableAjaxValidation":true},{"id":"searchform-search","name":"search","container":".field-searchform-search","input":"#searchform-search","enableAjaxValidation":true,"validate":function(attribute,value,messages,deferred,$form){yii.validation.required(value,messages,{"message":"Search ne peut être vide."});}}],[]);});</script></strong><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">try{var __ezlcp;const fd=window._ezfd||{}
fd.measure=fd.measure||function(cb){cb()}
function __ezlcpcd(){fd.measure(function(){const po=new PerformanceObserver((entryList)=>{const entries=entryList.getEntries();const lcpElement=entries[entries.length-1];var vh=window.innerHeight||Math.max(document.documentElement.clientHeight,document.body.clientHeight);var scrollTop=window.pageYOffset||document.documentElement.scrollTop;if(lcpElement.element.getBoundingClientRect().top+scrollTop<vh){if(lcpElement!=undefined&&lcpElement.element.parentElement!=undefined&&lcpElement.element.parentElement.id=="ez-cookie-template"){return;}
__ezlcp=lcpElement;}});po.observe({type:'largest-contentful-paint',buffered:true});});};__ezlcpcd();function __ez_sendLCPElement(){fd.measure(function(){if(window.__ezlcp&&typeof window.__ezlcp.element!='undefined'&&window._ezaq&&typeof window._ezaq.domain_id!='undefined'){var vh=window.innerHeight||Math.max(document.documentElement.clientHeight,document.body.clientHeight);var json={url:document.URL,formfactor:window.ezoFormfactor,domainid:window._ezaq.domain_id,element:__ezlcp.element.outerHTML,viewht:vh,};var url="/cheetah/lcpel.go";if((typeof window.ezJsu!=="undefined"&&window.ezJsu===true)||(typeof window._ez_sa!=="undefined"&&window._ez_sa===true)||((typeof window.isAmp!='undefined')&&window.isAmp===true)||((typeof window.ezWp!=='undefined')&&window.ezWp===true)||((typeof window._ez_send_requests_through_ezoic!=='undefined')&&window._ez_send_requests_through_ezoic===true)){url="//g.ezoic.net"+url;}
var xhr=new XMLHttpRequest();xhr.open("POST",url,true);xhr.setRequestHeader('Content-Type','text/plain');xhr.send(JSON.stringify(json));}else{setTimeout(__ez_sendLCPElement,4000);}});}
if(window.addEventListener){window.addEventListener('load',function(){setTimeout(__ez_sendLCPElement,2000);},false);}}catch(e){}</script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">__ez.surgeonuri="/cheetah/SeCSS.go";</script><script>var __inScopeForCCPA=false;function __uspapi(command,version,callback){var response=null;var successs=false;if(command==="getUSPData"&&version===1){var uspString="1";if(__inScopeForCCPA){uspString+="Y";var result;var consentCookie=(result=new RegExp('(?:^|; )ezoccpaconsent=([^;]*)').exec(document.cookie))?(result[1]):null;if(consentCookie==="nonconsent"){uspString+="Y";}
else{uspString+="N";}
uspString+="N"}
else{uspString+="---";}
response={uspString:uspString,version:1};success=true;}
return callback(response,success);};function __receiveUspapiMessage(event){if(event.data.hasOwnProperty('__uspapiCall')){__uspapi('getUSPData',1,function(uspData,success){event.source.postMessage({__uspapiReturn:{returnValue:uspData,success:success,callId:event.data.__uspapiCall.callId}},event.origin);});}
return null;};window.addEventListener("message",__receiveUspapiMessage,false);</script><script>function __ez_fad_ezpbinit(){var s=document.createElement('script');s.setAttribute('src','//go.ezodn.com/hb/dall.js?b=amx,appnexus,conversant,criteo,ix,medianet,oftmedia,onetag,pubmatic,sovrn&cb=195-2-26');document.body.appendChild(s);}var epbjs=epbjs||{};epbjs.que=epbjs.que||[];epbjs.bidderTimeout=2500;epbjs.useAdj=true;epbjs.SS={"amx":11290,"appnexus":10087,"conversant":10033,"criteo":10050,"ix":10082,"medianet":11307,"oftmedia":10081,"onetag":11291,"pubmatic":10061,"sovrn":10017};epbjs.bidders=['amx,appnexus,conversant,criteo,ix,medianet,oftmedia,onetag,pubmatic,sovrn'];epbjs.que.push(function(){epbjs.aliasBidder('appnexus','conversant');epbjs.aliasBidder('appnexus','oftmedia');});epbjs.bidderSettings={'conversant':{bidCpmAdjustment:function(bidCpm){var adj1=bidCpm*1.000000;var adj2=adj1*1.000000;return adj2;}},'sovrn':{bidCpmAdjustment:function(bidCpm){var adj1=bidCpm*1.000000;var adj2=adj1*1.000000;return adj2;}},'oftmedia':{bidCpmAdjustment:function(bidCpm){var adj1=bidCpm*0.850000;var adj2=adj1*1.000000;return adj2;}},'ix':{bidCpmAdjustment:function(bidCpm){var adj1=bidCpm*0.950000;var adj2=adj1*1.000000;return adj2;}},'criteo':{bidCpmAdjustment:function(bidCpm){var adj1=bidCpm*0.900000;var adj2=adj1*1.000000;return adj2;}},'pubmatic':{bidCpmAdjustment:function(bidCpm){var adj1=bidCpm*1.000000;var adj2=adj1*1.000000;return adj2;}},'amx':{bidCpmAdjustment:function(bidCpm){var adj1=bidCpm*1.000000;var adj2=adj1*1.000000;return adj2;}},'appnexus':{bidCpmAdjustment:function(bidCpm){var adj1=bidCpm*0.950000;var adj2=adj1*1.000000;return adj2;}},'medianet':{bidCpmAdjustment:function(bidCpm){var adj1=bidCpm*1.000000;var adj2=adj1*1.000000;return adj2;}},'onetag':{bidCpmAdjustment:function(bidCpm){var adj1=bidCpm*1.000000;var adj2=adj1*1.000000;return adj2;}},};epbjs.gadj=1.000000;var __enableAnalytics=false;var __s2sbidders=[];var __allBidders=['conversant','sovrn','oftmedia','ix','criteo','pubmatic','amx','appnexus','medianet','onetag'];__ez.queue.addFile('/detroitchicago/denver.js','/detroitchicago/denver.js?gcb=2&cb=1',false,[],true,false,true,false);__ez.queue.addFunc("epbjsRequestAdUnits","epbjsRequestAdUnits",[[{code:'div-gpt-ad-hotexamples_com-box-1-0',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593577'}},{bidder:'oftmedia',params:{placementId:'19593629',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305136',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_sidebar_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}],sizeMapping:[{minWidth:300,sizes:[[300,250]]}]},{code:'div-gpt-ad-hotexamples_com-box-1-0_1',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593577'}},{bidder:'oftmedia',params:{placementId:'19593629',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305136',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_sidebar_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{crid:'188911743',cid:'8CUBCB617'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}],sizeMapping:[{minWidth:300,sizes:[[300,250]]}]},{code:'div-gpt-ad-hotexamples_com-box-1-0_2',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593577'}},{bidder:'oftmedia',params:{placementId:'19593629',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305136',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_sidebar_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}],sizeMapping:[{minWidth:300,sizes:[[300,250]]}]},{code:'div-gpt-ad-hotexamples_com-box-1-0_3',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593577'}},{bidder:'oftmedia',params:{placementId:'19593629',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305136',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_sidebar_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}],sizeMapping:[{minWidth:300,sizes:[[300,250]]}]},{code:'div-gpt-ad-hotexamples_com-large-leaderboard-1-0',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593700'}},{bidder:'oftmedia',params:{placementId:'19594063',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305147',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_sidebar_bottom_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}],sizeMapping:[{minWidth:300,sizes:[[300,250]]}]},{code:'div-gpt-ad-hotexamples_com-large-leaderboard-1-0_1',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593700'}},{bidder:'oftmedia',params:{placementId:'19594063',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305147',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_sidebar_bottom_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}],sizeMapping:[{minWidth:300,sizes:[[300,250]]}]},{code:'div-gpt-ad-hotexamples_com-large-leaderboard-1-0_2',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593700'}},{bidder:'oftmedia',params:{placementId:'19594063',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305147',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_sidebar_bottom_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}],sizeMapping:[{minWidth:300,sizes:[[300,250]]}]},{code:'div-gpt-ad-hotexamples_com-large-leaderboard-1-0_3',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593700'}},{bidder:'oftmedia',params:{placementId:'19594063',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305147',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_sidebar_bottom_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}],sizeMapping:[{minWidth:300,sizes:[[300,250]]}]},{code:'div-gpt-ad-hotexamples_com-large-billboard-2-0',mediaTypes:{banner:{sizes:[[250,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593691'}},{bidder:'oftmedia',params:{placementId:'19594060',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_sidebar_middle_250x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}]},{code:'div-gpt-ad-hotexamples_com-box-4-0',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593612'}},{bidder:'oftmedia',params:{placementId:'19594020',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305139',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_mid_content_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}]},{code:'div-gpt-ad-hotexamples_com-banner-2-0',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593678'}},{bidder:'oftmedia',params:{placementId:'19594057',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305145',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_sidebar_floating_1_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}]},{code:'div-gpt-ad-hotexamples_com-banner-1-0',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593667'}},{bidder:'oftmedia',params:{placementId:'19594054',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305144',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_long_content_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}]},{code:'div-gpt-ad-hotexamples_com-medrectangle-4-0',mediaTypes:{banner:{sizes:[[468,60]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593663'}},{bidder:'oftmedia',params:{placementId:'19594051',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305143',size:[468,60]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_under_second_paragraph_468x60'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}]},{code:'div-gpt-ad-hotexamples_com-box-2-0',mediaTypes:{banner:{sizes:[[728,90]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593590'}},{bidder:'oftmedia',params:{placementId:'19594005',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305137',size:[728,90]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_top_of_page_728x90'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}]},{code:'div-gpt-ad-hotexamples_com-large-leaderboard-2-0',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593711'}},{bidder:'oftmedia',params:{placementId:'19594066',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305148',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_longer_content_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}]},{code:'div-gpt-ad-hotexamples_com-box-3-0',mediaTypes:{banner:{sizes:[[728,90]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593602'}},{bidder:'oftmedia',params:{placementId:'19594014',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305138',size:[728,90]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_under_page_title_728x90'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}]},{code:'div-gpt-ad-hotexamples_com-leader-1-0',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'sovrn',params:{tagid:'593722'}},{bidder:'oftmedia',params:{placementId:'19594070',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305149',size:[300,250]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_longest_content_300x250'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}]},{code:'div-gpt-ad-hotexamples_com-medrectangle-3-0',mediaTypes:{banner:{sizes:[[580,400]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'oftmedia',params:{placementId:'19594048',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'ix',params:{siteId:'305142',size:[580,400]}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'e_under_first_paragraph_580x400'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}]},{code:'div-gpt-ad-hotexamples_com-large-mobile-banner-1-0',mediaTypes:{banner:{sizes:[[300,250]]}},bids:[{bidder:'conversant',params:{site_id:'207364',secure:1}},{bidder:'criteo',params:{networkId:'7987'}},{bidder:'pubmatic',params:{publisherId:'156983',adSlot:'In-Content_300x250_BTF'}},{bidder:'amx',params:{tagId:'ZXpvaWMuY29t'}},{bidder:'appnexus',params:{placementId:'20393530',video:{skippable:true,playback_method:['auto_play_sound_off']}}},{bidder:'medianet',params:{cid:'8CUBCB617',crid:'188911743'}},{bidder:'onetag',params:{pubId:'62499636face9dc'}}]}]],false,['/detroitchicago/denver.js'],true,true,true,true);</script><script>var __ez_tkn_evnt=function(){if(typeof(_ezaq)!='undefined'){if(typeof window.ezogtk!=="undefined"&&window.ezogtk!==""){__ez.bit.AddAndFire(_ezaq.page_view_id,[new __ezDotData("ext_user_hash",window.ezogtk)]);}}};document.addEventListener("DOMContentLoaded",__ez.queue.addFunc("__ez_tkn_evnt","__ez_tkn_evnt",event,false,['/detroitchicago/minneapolis.js','/detroitchicago/memphis.js'],true,true,false,true));</script><script async="" data-ezscrex="false">__ez_fad_load(0,0);__ez_fad_doc_ht=__ez_fad_docht();__ez_fad_vp_ht=__ez_fad_vpht();function __ez_fad_scroll(){return window.pageYOffset||(document.documentElement||document.body.parentNode||document.body).scrollTop}
var __ez_fad_scrollint=setInterval(function(){var sy=__ez_fad_scroll();var isShortPage=__ez_fad_doc_ht<=(__ez_fad_vh+100);var bot=(__ez_fad_vp_ht+sy);var botThresh=bot+__ez_fad_vp_ht;for(var divid in __ez_fad_divpos){if(__ez_fad_fastdiv.indexOf(divid)!=-1){continue;}
var divPos=__ez_fad_divpos[divid];if(divPos>0&&divPos>sy&&divPos<(sy+200)){if(typeof __ez_fad_instaslots[divid]=='function'){__ez_fad_instaslots[divid]();}}else if(divPos>0&&divPos>sy&&divPos<(sy+600)){if(typeof __ez_fad_instaslots[divid]=='function'){__ez_fad_viewslots[divid]();}}}
__ez_fad_chkpos();if(ezslit_run[0]!=true){__ez_fad_load(0,0);}
if((sy>0||isShortPage)&&ezslit_run[1]!=true){__ez_fad_load(1,null);__ez_fad_load(5,null);}
if((sy>100||isShortPage)&&ezslit_run[2]!=true){__ez_fad_load(2,null);}
if(sy>(__ez_fad_vp_ht*.75)&&ezslit_run[3]!=true){__ez_fad_load(3,null);}
if(ezslit_run[1]==true&&ezslit_run[2]==true&&ezslit_run[3]==true){clearInterval(__ez_fad_scrollint);}},500);function __ez_fad_chkpos(){if(typeof __ez_fad_divs[4]!='undefined'){for(var i=0;i<__ez_fad_divs[4].length;i++){var id=__ez_fad_divs[4][i];__ez_fad_divs[4][i]=null;__ez_fad_position([id]);};}}</script><script>(function(f,a){function g(b,a,c){b.addEventListener?b.addEventListener(a,c):b.attachEvent("on"+a,function(){c.call(b)})}function k(b){b&&("string"==typeof b["class"]&&b["class"]&&a.getElementById("uglipop_popbox").setAttribute("class",b["class"]),b.keepLayout&&!b["class"]&&a.getElementById("uglipop_popbox").setAttribute("style","position:relative;height:300px;width:300px;background-color:white;opacity:1;"),"string"==typeof b.content&&b.content&&"html"==b.source&&(a.getElementById("uglipop_popbox").innerHTML=b.content),"string"==typeof b.content&&b.content&&"div"==b.source&&(a.getElementById("uglipop_popbox").innerHTML=a.getElementById(b.content).innerHTML));a.getElementById("uglipop_overlay_wrapper").style.display="";a.getElementById("uglipop_overlay").style.display="";a.getElementById("uglipop_content_fixed").style.display=""}function h(){a.getElementById("uglipop_overlay_wrapper").style.display="none";a.getElementById("uglipop_overlay").style.display="none";a.getElementById("uglipop_content_fixed").style.display="none"}g(a,"DOMContentLoaded",function(){var b=a.createElement("div"),e=a.createElement("div"),c=a.createElement("div"),d=a.createElement("div");e.id="uglipop_content_fixed";e.setAttribute("style","position:fixed;top: 50%;left: 50%;transform: translate(-50%, -50%);-webkit-transform: translate(-50%, -50%);-ms-transform: translate(-50%, -50%);opacity:1;z-index:10000000;");c.id="uglipop_popbox";d.id="uglipop_overlay_wrapper";d.setAttribute("style","position:absolute;top:0;bottom:0;left:0;right:0;display:none");b.id="uglipop_overlay";b.setAttribute("style","position:fixed;top:0;bottom:0;left:0;right:0;opacity:0.3;width:100%;height:100%;background-color:black;");d.appendChild(b);e.appendChild(c);a.body.appendChild(d);a.body.appendChild(e);a.getElementById("uglipop_overlay_wrapper").style.display="none";a.getElementById("uglipop_overlay").style.display="none";a.getElementById("uglipop_content_fixed").style.display="none";d.addEventListener("click",h);g(f,"keydown",function(a){27==a.keyCode&&h()});f.uglipop=k})})(window,document);var ezRBA=(function(){function init(){var reportAdsBtns=document.querySelectorAll('.ez-report-ad-button');for(var i=0;i<reportAdsBtns.length;i++){reportAdsBtns[i].addEventListener('click',function(e){var url='<iframe src="https://svc.ezoic.com/pub/reportads/reportads.html'+e.target.getAttribute('name')+'" width="400" height="500" style="border-radius: 10px; box-shadow: 2px 2px 30px 6px rgba(0,0,0,0.75); border: 1px solid black;"></iframe>'
uglipop({class:'none',source:'html',content:url,});});}
function bindEvent(element,eventName,eventHandler){if(element.addEventListener){element.addEventListener(eventName,eventHandler,false);}else if(element.attachEvent){element.attachEvent('on'+eventName,eventHandler);}}
bindEvent(window,'message',function(e){if(e.data==='close-report-ad-modal'){document.getElementById('uglipop_overlay_wrapper').style.display='none';document.getElementById('uglipop_overlay').style.display='none';document.getElementById('uglipop_content_fixed').style.display='none';}})}
return{init:init};})();ezRBA.init();</script><script data-cfasync="false">(function(){var addListeners=function(eltype,els){for(var en=0;en<els.length;en++){var el=els[en];if(el.complete==false||(typeof(el.readyState)!='undefined'&&el.readyState<4)){var src=el.getAttribute('src')||el.currentSrc;if(typeof(el.readyState)!='undefined'&&el.readyState==0){el.addEventListener('loadstart',function(e){var src=e.currentTarget.getAttribute('src')||e.currentSrc;window["ezorqs"](e,src);});}else{var src=el.getAttribute('src')||el.currentSrc;window["ezorqs"](el,src);}
el.addEventListener('load',function(e){var src=e.currentTarget.getAttribute('src')||e.srcElement.currentSrc;window["ezorqe"](e,src);});el.addEventListener('loadeddata',function(e){var src=e.currentTarget.getAttribute('src')||e.srcElement.currentSrc;window["ezorqe"](e,src);});el.addEventListener('error',function(e){var src=e.currentTarget.getAttribute('src')||e.srcElement.currentSrc;window["ezorqe"](e,src);});}}};var CssLoadedListeners=function(els){for(var en=0;en<els.length;en++){var el=els[en];if((el.getAttribute('rel')=='preload'||el.getAttribute('rel')=='stylesheet')&&el.getAttribute('href')!=null){if(isStyleSheetLoaded(el.getAttribute('href'))){window["ezorqs"](el,el.getAttribute('href'));var img=document.createElement('img');img.onerror=function(e){if(typeof e.path!="undefined"&&typeof e.path[0].currentSrc!="undefined"){window["ezorqe"](el,e.path[0].currentSrc);}else if(typeof e.srcElement!="undefined"&&typeof e.srcElement.href!="undefined"){window["ezorqe"](el,e.srcElement.href);}};img.src=el.getAttribute('href');}else{}}else{}}};function isStyleSheetLoaded(url){for(var i=0;i<document.styleSheets.length;i++){if(document.styleSheets[i].href==url){return true}}
return false;}
__ez_addAllListeners=function(){addListeners('img',document.querySelectorAll('img'));addListeners('video',document.querySelectorAll('video'));addListeners('audio',document.querySelectorAll('audio'));CssLoadedListeners(document.querySelectorAll('link'));if(typeof window["__ez"]["ssaf"]!="undefined"&&window["__ez"]["ssaf"].indexOf(16)>-1){if(typeof window["__ez"]["sshsdef"]!=="undefined"&&window["__ez"]["sshsdef"]===false){if(Element.prototype.addEventListener){if(typeof window["onload"]=="function"){window["addEventListener"]("load",window["onload"]);window["onload"]=null;}
if(typeof document["onload"]=="function"){document["addEventListener"].addEventListener("load",document["onload"]);document["onload"]=null;}}}}}
__ez.queue.addFunc("__ez_addAllListeners","__ez_addAllListeners",null,false,['/detroitchicago/tulsa.js'],true,true,true,true);}());</script><script style="display:none">var __ez_dims=(function(){var setCookie=function(name,content,expiry){return document.cookie=name+'='+content+((expiry)?';expires='+(new Date(Math.floor(new Date().getTime()+expiry*1000)).toUTCString()):'')+';path=/';};var ffid=1;var oh=window.screen.height;var ow=window.screen.width;var h=ffid===1?oh:(oh>ow)?oh:ow;var w=ffid===1?ow:(oh>ow)?ow:oh;var uh=window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName('body')[0].clientHeight;var uw=window.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName('body')[0].clientWidth;setCookie('ezds',encodeURIComponent('ffid='+ffid+',w='+w+',h='+h),(31536e3*7));setCookie('ezohw',encodeURIComponent('w='+uw+',h='+uh),(31536e3*7));})();</script><script style="display:none" async=""></script><script type="text/javascript">
	var ezCanEngagePage = false;
	(function() {
		var attachEvent = function(element, evt, func) {
			if (element.addEventListener) {
				element.addEventListener(evt, func, false);
			} else {
				element.attachEvent("on" + evt, func);
			}
		};
		attachEvent(document.body, "ezPageEngageable", function (e) {
			ezCanEngagePage = true;
		});
		attachEvent(document.body, "ezCMPComplete", function (e) {
			if (typeof(_ezaq) !== "undefined"){
				__ez.bit.AddAndFire(_ezaq["page_view_id"], [(new __ezDotData('pageview_updated_t_time', Date.now()))]);
			}
		});	
	})();</script>
<script type="text/javascript">var cmpCookies={};cmpCookies["3"]=["ezoadgid_110793=-1; Path=/; Domain=hotexamples.com; Expires=Sat, 07 Aug 2021 10:46:07 UTC","ezoref_110793=google.com; Path=/; Domain=hotexamples.com; Expires=Sat, 07 Aug 2021 12:16:07 UTC","ezoab_110793=mod31-c; Path=/; Domain=hotexamples.com; Expires=Sat, 07 Aug 2021 12:16:07 UTC","ezopvc_110793=1; Path=/; Domain=hotexamples.com; Expires=Sat, 07 Aug 2021 10:46:07 UTC","ezepvv=710; Path=/; Domain=hotexamples.com; Expires=Sun, 08 Aug 2021 10:16:07 UTC","ezovid_110793=374492497; Path=/; Domain=hotexamples.com; Expires=Sat, 07 Aug 2021 10:46:07 UTC","lp_110793=https://cpp.hotexamples.com/fr/examples/-/-/poll/cpp-poll-function-examples.html; Path=/; Domain=hotexamples.com; Expires=Sat, 07 Aug 2021 10:46:07 UTC"];
</script>

<script>
var __ezCmpConfig = {
	version: 4,
	pageIsEngageable: false,
	results: {"domain":".hotexamples.com","contentData":{"languages":{"de":"de","en":"en","es":"es","fr":"fr","hr":"hr","it":"it","nl":"nl","sl":"sl","sr":"sr","sv":"sv"},"list":[{"id":106,"did":0,"language":"en","dialogHeading":"This website uses cookies","dialogBody":"This website use cookies to personalize content, provide custom experiences, target ads, to provide social media features and to analyse our traffic. We also share information about your use of our site with our social media, advertising and analytics partners who may combine it with other information that you've provided to them or that they've collected from your use of their services. Below you have the option of selecting which types of cookies you'll allow to store your personal information. To view the vendor list or change consent settings at any time please visit our privacy policy using the link below.","declineButton":"Allow Necessary Cookies \u0026 Continue","acceptButton":"Continue with Recommended Cookies","okButton":"Save","cookieInfo":"Cookies are small text files that can be used by websites to make a user's experience more efficient.\r\n\r\nThe law states that we can store cookies that contain personal information on your device if they are strictly necessary for the operation of this site. For all other types of cookies that contain personal information we need your permission.\r\n\r\nThis site uses different types of cookies. Some cookies are placed by third party services that appear on our pages.","necessaryCategory":"Necessary","necessaryDescription":"Necessary cookies help make a website usable by enabling basic functions like page navigation and access to secure areas of the website. The website cannot function properly without these cookies.                            ","preferenceCategory":"Preferences","preferenceDescription":"Preference cookies enable a website to remember information that changes the way the website behaves or looks, like your preferred language or the region that you are in.","statisticsCategory":"Statistics","statisticsDescription":"Statistic cookies help website owners to understand how visitors interact with websites by collecting and reporting information anonymously.","marketingCategory":"Marketing","marketingDescription":"Marketing cookies are used to track visitors across websites. The intention is to display ads that are relevant and engaging for the individual user and thereby more valuable for publishers and third party advertisers.","unclassifiedCategory":"Unclassified","unclassifiedDescription":"Unclassified cookies are cookies that we are in the process of classifying, together with the providers of individual cookies.","cookieDetailsLink":"Cookie Details","aboutCookiesLink":"About Cookies","privacyPolicyLink":"Privacy Policy","columnName":"Name","columnPurpose":"Purpose","columnPII":"May Contain Personal Information","columnDuration":"Duration","mainHeading":"Privacy \u0026 Transparency","purposes":"Purposes","legitimateInterest":"Legitimate Interest","consent":"Consent","specialPurposes":"Special Purposes","manageSettings":"Manage Settings","saveSettings":"Save Settings \u0026 Exit","vendors":"Vendor List","nonTcfVendors":"Additional Vendors","features":"Features","specialFeatures":"Special Features","acceptAllButton":"Accept All \u0026 Continue","purposePrefix":"We and our partners use cookies to ","stackPrefix":"We and our partners use data for ","mainBody":"An example of data being processed may be a unique identifier stored in a cookie. Some of our partners may process your data as a part of their legitimate business interest without asking for consent. To view the purposes they believe they have legitimate interest for, or to object to this data processing use the vendor list link below. The consent submitted will only be used for data processing originating from this website. If you would like to change your settings or withdraw consent at any time, the link to do so is in our privacy policy accessible from our home page."},{"id":107,"did":0,"language":"fr","dialogHeading":"Ce site web utilise des cookies","dialogBody":"Nous utilisons des cookies pour personnaliser le contenu et les publicités, pour fournir des fonctionnalités de médias sociaux et pour analyser notre trafic. Nous partageons également des informations sur votre utilisation de notre site avec nos partenaires de médias sociaux, de publicité et d'analyse qui peuvent les combiner avec d'autres informations que vous leur avez fournies ou qu'ils ont collectées à partir de votre utilisation de leurs services. S'il vous plaît lire plus sur notre page de politique de confidentialité. Pour consulter la liste des fournisseurs ou modifier les paramètres de consentement à tout moment, veuillez consulter notre politique de confidentialité en utilisant le lien ci-dessous.","declineButton":"Utilisez les cookies nécessaires uniquement et continuez","acceptButton":"Autoriser tous les cookies et continuer","okButton":"D'accord","cookieInfo":"Les cookies sont de petits fichiers texte qui peuvent être utilisés par les sites Web pour rendre l'expérience utilisateur plus efficace.\r\n\r\nLa loi stipule que nous pouvons stocker des cookies sur votre appareil s'ils sont strictement nécessaires au fonctionnement de ce site. Pour tous les autres types de cookies, nous avons besoin de votre permission.\r\n\r\nCe site utilise différents types de cookies. Certains cookies sont placés par des services tiers qui apparaissent sur nos pages.","necessaryCategory":"Nécessaire","necessaryDescription":"Les cookies nécessaires permettent de rendre un site Web utilisable en activant des fonctions de base telles que la navigation dans les pages et l'accès à des zones sécurisées du site Web. Le site Web ne peut pas fonctionner correctement sans ces cookies.","preferenceCategory":"Préférences","preferenceDescription":"Les cookies de préférence permettent à un site Web de mémoriser des informations qui modifient le comportement ou l'aspect du site Web, comme votre langue préférée ou la région dans laquelle vous vous trouvez.","statisticsCategory":"Statistiques","statisticsDescription":"Les cookies statistiques aident les propriétaires de sites Web à comprendre comment les visiteurs interagissent avec les sites Web en collectant et en signalant les informations de manière anonyme.","marketingCategory":"Commercialisation","marketingDescription":"Les cookies de marketing sont utilisés pour suivre les visiteurs sur les sites Web. L'intention est d'afficher des publicités pertinentes et engageantes pour l'utilisateur individuel et donc plus utiles pour les éditeurs et les annonceurs tiers.","unclassifiedCategory":"Non classé","unclassifiedDescription":"Les cookies non classés sont des cookies que nous sommes en train de classer, ainsi que les fournisseurs de cookies individuels.","cookieDetailsLink":"Détails du cookie","aboutCookiesLink":"À propos des cookies","privacyPolicyLink":"Politique de confidentialité","columnName":"Prénom","columnPurpose":"Objectif","columnPII":"Peut contenir des informations personnelles","columnDuration":"Durée","mainHeading":"Confidentialité et Transparence","purposes":"Objectifs","legitimateInterest":"Intérêt Légitime","consent":"Consentement","specialPurposes":"Objectifs Spéciaux","manageSettings":"Gérer les Paramètres","saveSettings":"Enregistrer les Paramètres","vendors":"Liste de Fournisseurs","nonTcfVendors":"Fournisseurs Supplémentaires","features":"Caractéristiques","specialFeatures":"Particularités","acceptAllButton":"Accepter Tout et Continuer","purposePrefix":"Nous et nos partenaires utilisons des cookies pour ","stackPrefix":"Nous et nos partenaires utilisons les données pour ","mainBody":"Un exemple de données traitées peut être un identifiant unique stocké dans un cookie. Certains de nos partenaires peuvent traiter vos données dans le cadre de leurs intérêts commerciaux légitimes sans vous demander votre consentement. Pour connaître les raisons pour lesquelles ils estiment avoir un intérêt légitime ou pour s'opposer à ce traitement de données, utilisez le lien de la liste des fournisseurs ci-dessous. Le consentement soumis ne sera utilisé que pour le traitement des données provenant de ce site web. Si vous souhaitez modifier vos paramètres ou retirer votre consentement à tout moment, le lien pour ce faire se trouve dans notre politique de confidentialité accessible depuis notre page d'accueil."},{"id":108,"did":0,"language":"de","dialogHeading":"Diese Website verwendet Cookies","dialogBody":"Um diese Website zu betreiben, ist es für mich notwendig Cookies zu verwenden. Einige Cookies sind erforderlich, um die Funktionalität zu gewährleisten, andere brauche ich für Statistiken und wieder andere helfen mir dir nur die Werbung anzuzeigen, die dich interessiert. Mehr erfährst du in meiner Datenschutzerklärung.","declineButton":"Nur notwendige Cookies","acceptButton":"Weiter mit den empfohlenen Cookies","okButton":"Speichern","cookieInfo":"Cookies sind kleine Textdateien, die von Websites verwendet werden können, um die Nutzererfahrung effizienter zu gestalten.\n\nDas Gesetz besagt, dass wir Cookies, die persönliche Informationen auf Ihrem Gerät enthalten, speichern können, wenn sie für den Betrieb dieser Website unbedingt erforderlich sind. Für alle anderen Arten von Cookies, die persönliche Informationen enthalten, benötigen wir Ihre Erlaubnis.\n\nDiese Seite verwendet verschiedene Arten von Cookies. Einige Cookies werden von Drittanbietern auf unseren Seiten platziert. ","necessaryCategory":"Notwendig","necessaryDescription":"Notwendige Cookies helfen dabei, eine Website nutzbar zu machen, indem grundlegende Funktionen wie Seitennavigation und Zugriff auf sichere Bereiche der Website aktiviert werden. Die Website kann ohne diese Cookies nicht ordnungsgemäß funktionieren.","preferenceCategory":"Präferenzen","preferenceDescription":"Präferenz-Cookies ermöglichen es einer Website, Informationen zu speichern, die das Verhalten oder das Aussehen der Website ändern, wie z.B. Ihre bevorzugte Sprache oder die Region, in der Sie sich befinden.","statisticsCategory":"Statistiken","statisticsDescription":"Statistische Cookies helfen Website-Betreibern zu verstehen, wie Besucher mit Websites interagieren, indem sie Informationen anonym sammeln und melden.","marketingCategory":"Marketing","marketingDescription":"Marketing-Cookies werden verwendet, um Besucher auf Websites zu verfolgen. Die Absicht besteht darin, relevante und ansprechende Anzeigen für den einzelnen Nutzer anzuzeigen und somit für Publisher und Werbetreibende von Drittanbietern nützlicher zu sein.","unclassifiedCategory":"Nicht klassifiziert","unclassifiedDescription":"Nicht klassifizierte Cookies sind Cookies, die wir gerade klassifizieren, sowie die Lieferanten einzelner Cookies.","cookieDetailsLink":"Details von Cookies","aboutCookiesLink":"Über Cookies","privacyPolicyLink":"Datenschutzerklärung","columnName":"Name","columnPurpose":"Ziel","columnPII":"Kann persönliche Informationen enthalten","columnDuration":"Dauer","mainHeading":"Datenschutz \u0026 Transparenz","purposes":"Verwendungszwecke","legitimateInterest":"Legitimes Interesse","consent":"Consent","specialPurposes":"besondere Verwendungszwecke","manageSettings":"Einstellungen verwalten","saveSettings":"Einstellungen speichern \u0026 Beenden","vendors":"Anbieter-Liste","nonTcfVendors":"Zusätzliche Anbieter","features":"Eigenschaften","specialFeatures":"Besondere Eigenschaften","acceptAllButton":"Alle akzeptieren \u0026 fortfahren","purposePrefix":"Wir und unsere Partner verwenden Cookies, um","stackPrefix":"Wir und unsere Partner verwenden Daten für","mainBody":"Ein Beispiel für Daten, welche verarbeitet werden, kann eine in einem Cookie gespeicherte eindeutige Kennung sein. Einige unserer Partner können Ihre Daten im Rahmen ihrer legitimen Geschäftsinteressen verarbeiten, ohne Ihre Zustimmung einzuholen. Um die Verwendungszwecke einzusehen, für die diese ihrer Meinung nach ein berechtigtes Interesse haben, oder um dieser Datenverarbeitung zu widersprechen, verwenden Sie den unten stehenden Link zur Anbieterliste. Die übermittelte Einwilligung wird nur für die von dieser Webseite ausgehende Datenverarbeitung verwendet. Wenn Sie Ihre Einstellungen ändern oder Ihre Einwilligung jederzeit widerrufen möchten, finden Sie den Link dazu in unserer Datenschutzerklärung, die von unserer Homepage aus zugänglich ist"},{"id":1528,"did":0,"language":"es","dialogHeading":"Este sitio web utiliza cookies","dialogBody":"Este sitio web utiliza cookies para personalizar el contenido, proporcionar experiencias personalizadas, mostrar anuncios, proporcionar características de redes sociales y analizar nuestro tráfico. También compartimos información sobre su uso en nuestro sitio con nuestros socios de redes sociales, publicidad y análisis que pueden combinarlo con otra información que les haya proporcionado o que hayan recopilado sobre el uso de sus servicios. A continuación, tiene la opción de seleccionar qué tipos de cookies permitirá que almacenen su información personal. Para ver la lista de proveedores o cambiar la configuración de consentimiento en cualquier momento, visite nuestra \"Política de privacidad\" utilizando el siguiente enlace.","declineButton":"Permitir las Cookies Necesarias y Continuar","acceptButton":"Continuar con las Cookies Recomendadas","okButton":"Guardar","cookieInfo":"Las cookies son pequeños archivos de texto que los sitios web pueden usar para hacer que la experiencia del usuario sea más eficiente.\nLa ley establece que podemos almacenar cookies que contienen información personal en su dispositivo si son estrictamente necesarias para el funcionamiento de este sitio. Para todos los demás tipos de cookies que contienen información personal, necesitamos su permiso.\nEste sitio utiliza diferentes tipos de cookies. Algunas cookies son colocadas por servicios de terceros que aparecen en nuestras páginas.","necessaryCategory":"Necesarias","necessaryDescription":"Las cookies necesarias ayudan a que un sitio web sea utilizable al habilitar funciones básicas como la navegación de páginas y el acceso a áreas seguras del sitio web. El sitio web no puede funcionar correctamente sin estas cookies.","preferenceCategory":"Preferencias","preferenceDescription":"Las cookies de preferencias, permiten que un sitio web guarde la información que modifica, la forma en que se comporta o se ve el sitio web, así como, su idioma preferido o la región en la que se encuentra.","statisticsCategory":"Estadísticas","statisticsDescription":"Las cookies de estadísticas ayudan a los propietarios de los sitios web, a comprender cómo los visitantes interactúan con los sitios mediante la recolección y reporte de información anónima.","marketingCategory":"Mercadeo","marketingDescription":"Las cookies de mercadeo se utilizan para seguir a los visitantes en los sitios web. La intención es mostrar anuncios que sean relevantes y atractivos para el usuario y, por tanto, más valiosos para editores y anunciantes externos.","unclassifiedCategory":"Sin clasificación","unclassifiedDescription":"Las cookies no clasificadas son cookies que estamos en proceso de clasificar, junto con los proveedores de cookies individuales.","cookieDetailsLink":"Detalles de Cookies","aboutCookiesLink":"Acerca de las Cookies","privacyPolicyLink":"Enlace de políticas de privacidad","columnName":"Nombre","columnPurpose":"Propósito","columnPII":"Puede contener información personal","columnDuration":"Duración","mainHeading":"Privacidad y transparencia","purposes":"Propósitos","legitimateInterest":"Interés legítimo","consent":"Consentimiento","specialPurposes":"Fines especiales","manageSettings":"Administrar configuración","saveSettings":"Guardar configuración y salir","vendors":"Lista de proveedores","nonTcfVendors":"Proveedores adicionales","features":"Funciones","specialFeatures":"Funciones especiales","acceptAllButton":"Aceptar todo y continuar","purposePrefix":"Nosotros y nuestros socios utilizamos cookies para ","stackPrefix":"Nosotros y nuestros socios usamos datos para ","mainBody":"Un ejemplo de datos procesados ​​puede ser un identificador único almacenado en una cookie. Algunos de nuestros socios pueden procesar sus datos como parte de su interés comercial legítimo sin solicitar su consentimiento. Para ver los propósitos que creen que tienen interés legítimo u oponerse a este procesamiento de datos, utilice el enlace de la lista de proveedores a continuación. El consentimiento enviado solo se utilizará para el procesamiento de datos que tienen su origen en este sitio web. Si desea cambiar su configuración o retirar el consentimiento en cualquier momento, el enlace hacerlo está en nuestra política de privacidad accesible desde nuestra página de inicio."},{"id":1715,"did":0,"language":"it","dialogHeading":"questo sito usa i cookie","dialogBody":"Questo sito web utilizza i cookie per personalizzare i contenuti, fornire esperienze personalizzate, annunci mirati, fornire funzionalità di social media e analizzare il nostro traffico. Condividiamo anche informazioni sull'utilizzo del nostro sito con i nostri partner di social media, pubblicità e analisi che possono combinare con altre informazioni che avete fornito loro o che hanno raccolto dall'utilizzo dei loro servizi da parte vostra. Di seguito avete la possibilità di selezionare quali tipi di cookie consentite di memorizzare le vostre informazioni personali. Per visualizzare l'elenco dei fornitori o modificare le impostazioni di consenso in qualsiasi momento, visitate la nostra politica sulla privacy utilizzando il link sottostante","declineButton":"accettare necessario","acceptButton":"accetta tutto e continua","okButton":"accetta","cookieInfo":"I cookie sono piccoli file di testo che possono essere utilizzati dai siti web per rendere più efficiente l'esperienza dell'utente. La legge afferma che possiamo memorizzare i cookie che contengono informazioni personali sul tuo dispositivo se sono strettamente necessari per il funzionamento di questo sito. Per tutti gli altri tipi di cookie che contengono informazioni personali abbiamo bisogno della tua autorizzazione. Questo sito utilizza diversi tipi di cookie. Alcuni cookie sono inseriti da servizi di terze parti che compaiono sulle nostre pagine.","necessaryCategory":"necessario","necessaryDescription":"I cookie di preferenza consentono ad un sito web di memorizzare informazioni che cambiano il modo in cui il sito web si comporta o il suo aspetto, come la lingua preferita, o la regione in cui ci si trova","preferenceCategory":"preferenze","preferenceDescription":"I cookie di preferenza consentono a un sito web di ricordare le informazioni che cambiano il modo in cui il sito web si comporta o appare, come la tua lingua preferita o la regione in cui ti trovi.","statisticsCategory":"statistiche","statisticsDescription":"I cookie statistici aiutano i proprietari dei siti web a capire come i visitatori interagiscono con i siti raccogliendo e trasmettendo informazioni in forma anonima.","marketingCategory":"marketing","marketingDescription":"I cookie per il marketing vengono utilizzati per tracciare i visitatori dei siti web. L'intenzione è quella di visualizzare annunci che siano rilevanti e coinvolgenti per il singolo utente e quindi di maggior valore per gli editori e gli inserzionisti di terze parti","unclassifiedCategory":" ","unclassifiedDescription":" ","cookieDetailsLink":"dettagli cookie","aboutCookiesLink":"informazioni sui cookie","privacyPolicyLink":"informativa sulla privacy","columnName":" ","columnPurpose":" ","columnPII":" ","columnDuration":" ","mainHeading":"privacy e trasparenza","purposes":"finalita","legitimateInterest":"interesse legittimo","consent":"consentire","specialPurposes":"scopi specifici","manageSettings":"gestire le impostazioni","saveSettings":"accetta","vendors":"lista dei fornitori","nonTcfVendors":"fornitori aggiuntivi","features":"caratteristiche","specialFeatures":"caratteristiche speciali","acceptAllButton":"accetta tutto e continua","purposePrefix":"Noi e i nostri partner utilizziamo i cookie per","stackPrefix":"Noi e i nostri partner utilizziamo i cookie per","mainBody":"Un esempio di trattamento dei dati può essere un identificatore univoco memorizzato in un cookie. Alcuni dei nostri partner possono trattare i vostri dati come parte del loro legittimo interesse commerciale senza chiedere il consenso. Per visualizzare le finalità per le quali ritengono di avere un interesse legittimo o per opporsi a questo trattamento dei dati, utilizzare il link della lista dei fronitori qui sotto. Il consenso fornito sarà utilizzato solo per il trattamento dei dati provenienti da questo sito web. Se si desidera modificare le impostazioni o non dare il consenso in qualsiasi momento, il link per farlo è nella nostra politica sulla privacy accessibile dalla nostra home page"},{"id":2121,"did":0,"language":"hr","dialogHeading":"Ovo web-mjesto upotrebljava kolačiće.","dialogBody":"Ovo web-mjesto koristi kolačiće za prilagodbu sadržaja, pružanje prilagođenih iskustava, ciljanje oglasa, pružanje značajki društvenih mreža i analizu našeg prometa. Također dijelimo informacije o vašoj upotrebi naše stranice s našim društvenim mrežama, oglašivačkim i analitičkim partnerima koji ih mogu kombinirati s ostalim informacijama koje ste im pružili ili koje su prikupili iz vašeg korištenja njihovim uslugama. Niže u tekstu nalazi se mogućnost odabira vrsta kolačića kojima ćete dopustiti pohranu vaših osobnih podataka. Da biste u bilo kojem trenutku pregledali popis dobavljača ili promijenili postavke privole, posjetite našu politiku privatnosti putem donje poveznice.","declineButton":"Omogući nužne kolačiće i nastavi","acceptButton":"Nastavi s preporučenim kolačićima","okButton":"Spremi","cookieInfo":"Kolačići su male tekstualne datoteke koje web-mjesta mogu upotrebljavati za učinkovitije korisničko iskustvo.\n\nZakonom je propisano da na vaš uređaj možemo pohraniti kolačiće koji sadrže osobne podatke ako su oni nužno potrebni za rad ove stranice. Za sve ostale vrste kolačića koji sadrže osobne podatke trebamo vaše dopuštenje.\n\nOva stranica upotrebljava različite vrste kolačića. Neke kolačiće postavljaju usluge trećih strana koje se pojavljuju na našim stranicama.","necessaryCategory":"Nužni kolačići","necessaryDescription":"Nužni kolačići pomažu da se web-mjesto učini korisnim omogućavanjem osnovnih funkcija poput navigacije stranicom i pristupa sigurnim dijelovima web-mjesta. Web-mjesto ne može ispravno funkcionirati bez ovih kolačića.","preferenceCategory":"Kolačići preferencija","preferenceDescription":"Kolačići preferencija omogućuju web-mjestu da pamti informacije koje mijenjaju način ponašanja ili izgleda web-mjesta, poput željenog jezika ili regije u kojoj se nalazite.","statisticsCategory":"Statistički kolačići","statisticsDescription":"Statistički kolačići pomažu vlasnicima web-mjesta da razumiju interakciju između posjetitelja i web-mjesta anonimnim prikupljanjem i izvješavanjem o informacijama.","marketingCategory":"Marketinški kolačići","marketingDescription":"Marketinški kolačići upotrebljavaju se za praćenje posjetitelja na web-mjestima. Namjera je prikazati oglase koji su relevantni i zanimljivi pojedinačnom korisniku te stoga vrjedniji izdavačima i oglašivačima trećih strana.","unclassifiedCategory":"Neklasificirani kolačići","unclassifiedDescription":"Neklasificirani kolačići su kolačići koje u tom trenutku klasificiramo, zajedno s pružateljima pojedinačnih kolačića.","cookieDetailsLink":"Detalji kolačića","aboutCookiesLink":"O kolačićima","privacyPolicyLink":"Politika privatnosti","columnName":"Naziv","columnPurpose":"Svrha","columnPII":"Mogu sadržavati osobne informacije","columnDuration":"Trajanje","mainHeading":"Privatnost i transparentnost","purposes":"Svrhe","legitimateInterest":"Legitiman interes","consent":"Privola","specialPurposes":"Posebne svrhe","manageSettings":"Upravljanje postavkama","saveSettings":"Spremi postavke i izađi","vendors":"Popis dobavljača","nonTcfVendors":"Dodatni dobavljači","features":"Značajke","specialFeatures":"Posebne značajke","acceptAllButton":"Prihvati sve i nastavi","purposePrefix":"Mi i naši partneri upotrebljavamo kolačiće za","stackPrefix":"Mi i naši partneri upotrebljavamo podatke za","mainBody":"Primjer podataka koji se obrađuju može biti jedinstveni identifikator pohranjen u kolačiću. Neki naši partneri mogu obrađivati vaše podatke kao dio svojeg legitimnog poslovnog interesa bez traženja privole. Da biste vidjeli svrhe za koje partneri smatraju da imaju legitimni interes ili se usprotivili ovoj obradi podataka, upotrijebite donju poveznicu na popis dobavljača. Poslana privola koristit će se samo za obradu podataka koji potječu s ovog web-mjesta. Ako u bilo kojem trenutku želite promijeniti svoje postavke ili povući privolu, poveznica za to nalazi se u našoj politici privatnosti dostupnoj na našoj početnoj stranici."},{"id":2125,"did":0,"language":"sv","dialogHeading":"Den här hemsidan använder sig av cookies","dialogBody":"Denna webbplats använder cookies för att anpassa innehåll, tillhandahålla anpassade upplevelser, rikta annonser, för att tillhandahålla sociala mediefunktioner och för att analysera trafiken. Vi delar också information om din användning av vår webbplats med våra sociala medier, reklam- och analyspartner som kan kombinera den med annan information som du har gett dem eller som de har samlat in från din användning av deras tjänster. Nedan har du möjlighet att välja vilka typer av cookies du tillåter för att lagra din personliga information. För att se leverantörslistan eller ändra samtyckeinställningar när som helst, besök vår integritetspolicy med länken nedan.","declineButton":"Till nödvändiga cookies och fortsätt","acceptButton":"Fortsätt med rekommenderade cookies","okButton":"Spara","cookieInfo":"Cookies är små textfiler som kan användas av webbplatser för att effektivisera användarens upplevelse. \n\nEnligt lag kan vi spara cookies som innehåller personlig information på din enhet om de är absolut nödvändiga för driften av denna webbplats. För alla andra typer av cookies som innehåller personlig information behöver vi din tillåtelse. \n\nDenna webbplats använder olika typer av cookies. Vissa cookies placeras av tjänster från tredje part som visas på våra sidor.","necessaryCategory":"Nödvändiga","necessaryDescription":"Nödvändiga cookies hjälper till att göra en webbplats användbar genom att möjliggöra grundläggande funktioner som sidnavigering och åtkomst till säkra områden på webbplatsen. Webbplatsen kan inte fungera korrekt utan dessa cookies.","preferenceCategory":"Inställningar","preferenceDescription":"Nödvändiga cookies hjälper till att göra en webbplats användbar genom att aktivera grundläggande funktioner som sidnavigering och tillgång till säkra områden på webbplatsen. Webbplatsen kan inte fungera korrekt utan dessa cookies.","statisticsCategory":"Statistik","statisticsDescription":"Cookies för statistik hjälper en webbplatsägare att förstå hur besökare interagerar med webbplatser genom att samla och rapportera in information anonymt.","marketingCategory":"Marknadsföring","marketingDescription":"Cookies för marknadsföring används för att spåra besökare på webbplatser. Avsikten är att visa annonser som är relevanta och engagerande för enskilda användare, och därmed mer värdefull för utgivare och tredjepartsannonsörer.","unclassifiedCategory":"Oklassifierade","unclassifiedDescription":"Oklassificerade cookies är cookies som ännu inte har klassificerats, dessa håller vi på att klassificera tillsammans med leverantörerna av leverantörerna av dessa cookies.","cookieDetailsLink":"Cookie detaljer","aboutCookiesLink":"Om Cookies","privacyPolicyLink":"Integritetspolicy","columnName":"Namn","columnPurpose":"Syfte","columnPII":"Kan innehålla personlig information","columnDuration":"Varaktighet","mainHeading":"Sekretess och transparens","purposes":"Syften","legitimateInterest":"Legitima intressen","consent":"Samtycke","specialPurposes":"Särskilda ändamål","manageSettings":"Hantera inställningar","saveSettings":"Spara inställningar och avsluta","vendors":"Leverantörs lista","nonTcfVendors":"Ytterligare leverantörer","features":"Funktioner","specialFeatures":"Speciella funktioner","acceptAllButton":"Acceptera alla och fortsätt","purposePrefix":"Vi och våra partners använder cookies för att","stackPrefix":"Vi och våra partners använder data för","mainBody":"Ett exempel på data som samlas in kan vara en unik identifierare lagrad i en cookie. Vissa av våra partners kan behandla dina uppgifter som en del av deras legitima affärsintresse utan att fråga om samtycke. För att se ändamålen som de anser att de har ett berättigat intresse för, eller för att invända mot denna databehandling, använder du länken för leverantörslistan nedan. Det samtycke som lämnas kommer endast att användas för databehandling som härrör från denna webbplats. Du kan när som helst ändra dina inställningar eller återkalla ditt samtycke genom länken som finns i vår integritetspolicy, vilken är tillgänglig på vår hemsida."},{"id":2126,"did":0,"language":"sr","dialogHeading":"Ова веб страница користи колачиће","dialogBody":"На овој веб страници користимо колачиће да бисмо персонализовали садржину, пружили прилагођена корисничка искуства, приказали огласе за циљану публику, омогућили одређене карактеристике друштвених мрежа и анализирали промет на нашој страници. Такође, податке о вашем коришћењу наше веб странице делимо са нашим партнерима за друштвене мреже, оглашавање и анализу, а они би их могли комбиновати са другим подацима које сте им пружили или које су сакупили док сте користили њихове услуге. У продужетку вам нудимо могућност избора врсте колачића којим ћете дозволити похрану ваших личних података. Да бисте могли у било ком тренутку прегледати попис добављача или променити поставке сагласности, помоћу следеће повезнице приступите нашим Правилима о заштити приватности.","declineButton":"Прихвати нужне колачиће и продужи","acceptButton":"Продужи са препорученим колачићима","okButton":"Спреми","cookieInfo":"Колачићи су мале текстуалне датотеке које се користе на интернет страницама да би се унапредило корисничко искуство.\n \n Законом је дозвољено спремање колачића који садрже личне податке на ваш уређај ако су они изричито потребни за рад ове странице. За све остале врсте колачића које садрже личне податке потребна нам је ваша дозвола.\n \n На овој веб страници користимо различите врсте колачића. Неки колачићи постављају услуге трећих страна које се приказују на нашим страницама.","necessaryCategory":"Нужни","necessaryDescription":"Нужни колачићи омогућавају коришћење веб странице тако да омогућавају основне функције, као што су навигација страницом и приступ безбедним подручјима на страници. Исправан рад веб странице није могућ без тих колачића.","preferenceCategory":"Преферирани","preferenceDescription":"Преферирани колачићи омогућавају веб страници да упамти податке који мењају начин рада или изглед веб странице, као што су преферирани језик или регион у ком се налазите.","statisticsCategory":"Статистички","statisticsDescription":"Статистички колачићи помажу власницима веб страницама да разумеју како посетиоци употребљавају интернет страницу и то тако да анонимно сакупљају и извештавају о подацима.","marketingCategory":"Маркетиншки","marketingDescription":"Маркетиншки колачићи се користе за бележење броја посетиоца на интернет страницама. Циљ је приказивање огласа који интересују и привлаче индивидуалног корисника и који су због тога вреднији издавачима и оглашивачима трећих страна.","unclassifiedCategory":"Некласификовани","unclassifiedDescription":"Некласификовани колачићи су колачићи који су, са појединим колачићима пружаоца улуге, у поступку класификовања.","cookieDetailsLink":"Подаци о колачићима","aboutCookiesLink":"Више података о колачићима","privacyPolicyLink":"Правила о заштити приватности","columnName":"Назив","columnPurpose":"Сврха","columnPII":"Може да садржи личне податке","columnDuration":"Трајање","mainHeading":"Приватност и транспарентност","purposes":"Сврхе","legitimateInterest":"Легитимни интерес","consent":"Сагласност","specialPurposes":"Посебне сврхе","manageSettings":"Управљање поставкама","saveSettings":"Спреми поставке и изађи","vendors":"Попис добављача","nonTcfVendors":"Додатни добављачи","features":"Карактеристике","specialFeatures":"Посебне карактеристике","acceptAllButton":"Прихвати све и продужи","purposePrefix":"Ми и наши партнери користимо колачиће за","stackPrefix":"Ми и наши партнери користимо податке за","mainBody":"Подаци који се обрађују могу да представљају јединствени идентификатор похрањен у колачићу. Неки од наших партнера могу да обрађују ваше податке као део свог легитимног пословног интереса без тражења сагласности. Да бисте прегледали сврхе за које партнери наводе да имају легитимни интерес или да бисте уложили приговор на такву обраду података, погледајте попис добављача у продужетку. Предана сагласност користиће се само за обраду података који потичу са ове веб странице. Ако у било ком тренутку одлучите да промените поставке или да повучете сагласност, то можете да учините помоћу повезнице у нашим правилима о заштити приватности којим можете да приступите са наше насловне странице."},{"id":2127,"did":0,"language":"sl","dialogHeading":"Ta spletna stran uporablja piškotke","dialogBody":"Na tej spletni strani uporabljamo piškotke za personalizirane vsebine, zagotavljanje prilagojenih uporabniških izkušenj, prikazovanje oglasov za ciljne skupine, omogočanje določenih funkcij družbenih omrežij in analizo prometa na naši spletni strani. Podatke o vaši uporabi naše spletne strani delimo tudi z našimi partnerji za družabna omrežja, oglaševanje in analizo, ki jih lahko kombinirajo z drugimi informacijami, ki ste jih posredovali ali zbrali med uporabo njihovih storitev. V nadaljevanju vam ponujamo možnost izbire vrste piškotkov, s katerimi dovoljujete shranjevanje vaših osebnih podatkov. Če želite kadar koli pregledati seznam ponudnikov ali spremeniti nastavitve privolitve, uporabite naslednjo povezavo za dostop do naših pravil o varstvu zasebnosti.","declineButton":"Strinjam se","acceptButton":"Nadaljujte s priporočenimi piškotki","okButton":"Shrani","cookieInfo":"Piškotek je majhna tekstovna datoteka, ki se uporablja na spletnih straneh za izboljšanje uporabniške izkušnje.\n \n Zakon dovoljuje shranjevanje piškotkov, ki vsebujejo osebne podatke, če je to izrecno potrebno za delovanje te strani. Za vse druge vrste piškotkov, ki vsebujejo osebne podatke, potrebujemo vaše dovoljenje.\n \n Na tej spletni strani uporabljamo različne vrste piškotkov. Nekateri piškotki opredeljujejo storitve tretjih oseb, ki so prikazane na naših spletnih straneh.","necessaryCategory":"Nujni","necessaryDescription":"Nujni piškotki omogočajo uporabo spletne strani, tako da omogočajo osnovne funkcije, kot so navigacija po spletišču in dostop do varnih delov spletišča. Brez teh piškotkov ni možno zagotoviti pravilno delovanje spletne strani.","preferenceCategory":"Prednostni","preferenceDescription":"Prednostni piškotki omogočajo spletni strani, da si zapomni informacije, ki spreminjajo način delovanja ali izgleda, kot je vaš želeni jezik ali regija, v kateri se nahajate.","statisticsCategory":"Statistični","statisticsDescription":"Statistični piškotki lastnikom spletnih strani pomagajo razumeti, kako obiskovalci uporabljajo spletno stran z anonimnim zbiranjem in poročanjem podatkov.","marketingCategory":"Marketinški","marketingDescription":"Marketinški piškotki se uporabljajo za spremljanje obiskovalcev skozi spletne strani. Namen je prikazovanje oglasov, ki so relevantni za določenega uporabnika in ga spodbujajo k sodelovanju, kar je pomembno za založnike in oglaševalce tretjih oseb.","unclassifiedCategory":"Nerazvrščeni","unclassifiedDescription":"Nerazvrščeni piškotki so piškotki, ki jim bomo skupaj s ponudniki posameznih piškotkov počasi razvrstili.","cookieDetailsLink":"Informacije o piškotkih","aboutCookiesLink":"Več informacij o piškotkih","privacyPolicyLink":"Pravila o varstvu zasebnosti","columnName":"Ime","columnPurpose":"Namen","columnPII":"Lahko vsebuje osebne podatke","columnDuration":"Trajanje delovanja","mainHeading":"Zasebnost in preglednost","purposes":"Namen","legitimateInterest":"Legitimni interes","consent":"Privolitev","specialPurposes":"Poseben namen","manageSettings":"Upravljanje nastavitev","saveSettings":"Shrani nastavitve in zapri","vendors":"Seznam ponudnikov","nonTcfVendors":"Dodatni ponudniki","features":"Značilnosti","specialFeatures":"Posebne značilnosti","acceptAllButton":"Sprejmi vse in nadaljuj","purposePrefix":"Mi in naši partnerji uporabljamo piškotke za","stackPrefix":"Mi in naši partnerji uporabljamo podatke za","mainBody":"Podatki, ki se obdelujejo, lahko predstavljajo edinstveni identifikator, ki je shranjen v piškotku. Nekateri naši partnerji lahko obdelujejo vaše podatke brez privolitve kot del svojega legitimnega poslovnega interesa. Če želite pregledati namene, za katere partnerji izjavijo, da imajo legitimen interes, ali da bi vložili ugovor takšni obdelavi podatkov, si oglejte seznam ponudnikov v nadaljevanju. Dana privolitev se bo uporabljala samo za obdelavo podatkov, ki izvirajo s te spletne strani. Če se odločite kadar koli spremeniti svoje nastavitve ali umakniti privolitev, lahko to storite s povezavo v naših pravilih o varstvu zasebnosti, do katerih lahko dostopate z naše domače strani."},{"id":2128,"did":0,"language":"nl","dialogHeading":"Deze website gebruikt cookies","dialogBody":"Deze website gebruikt cookies om inhoud te personaliseren, aangepaste ervaringen aan te bieden, advertenties te targeten, om functies voor sociale media aan te bieden en om ons verkeer te analyseren. We delen ook informatie over uw gebruik van onze site met onze sociale media-, advertentie- en analysepartners die deze kunnen combineren met andere informatie die u aan hen heeft verstrekt of die zij hebben verzameld door uw gebruik van hun diensten. Hieronder kunt u selecteren welke soorten cookies u toestaat om uw persoonlijke gegevens op te slaan. Als u de leverancierslijst wilt bekijken of de toestemmingsinstellingen op elk gewenst moment wilt wijzigen, gaat u naar ons privacybeleid via de onderstaande link.","declineButton":"Enkel noodzakelijke cookies toestaan","acceptButton":"Ga verder met aanbevolen cookies","okButton":"Opslaan","cookieInfo":"Cookies zijn kleine tekstbestanden die door websites kunnen worden gebruikt om de gebruikerservaring efficiënter te maken.\n\nDe wet stelt dat we cookies die persoonlijke informatie bevatten op uw apparaat kunnen opslaan als ze strikt noodzakelijk zijn voor de werking van deze site. Voor alle andere soorten cookies die persoonlijke informatie bevatten, hebben we uw toestemming nodig.\n\nDeze site gebruikt verschillende soorten cookies. Sommige cookies worden geplaatst door diensten van derden die op onze pagina's verschijnen.","necessaryCategory":"Noodzakelijk","necessaryDescription":"Noodzakelijke cookies helpen een website bruikbaar te maken door basisfuncties zoals paginanavigatie en toegang tot beveiligde delen van de website mogelijk te maken. Zonder deze cookies kan de website niet naar behoren functioneren.","preferenceCategory":"Voorkeuren","preferenceDescription":"Met voorkeurscookies kan een website informatie onthouden die de manier waarop de website zich gedraagt of eruit ziet verandert, zoals de taal van uw voorkeur of de regio waarin u zich bevindt.","statisticsCategory":"Statistieken","statisticsDescription":"Statistische cookies helpen website-eigenaren om te begrijpen hoe bezoekers omgaan met websites door anoniem informatie te verzamelen en te rapporteren.","marketingCategory":"Marketing","marketingDescription":"Marketingcookies worden gebruikt om bezoekers op verschillende websites te volgen. Het is de bedoeling advertenties weer te geven die relevant en aantrekkelijk zijn voor de individuele gebruiker en daardoor waardevoller zijn voor uitgevers en externe adverteerders.","unclassifiedCategory":"Niet geclassificeerd","unclassifiedDescription":"Niet-geclassificeerde cookies zijn cookies die we aan het classificeren zijn, samen met de aanbieders van individuele cookies.","cookieDetailsLink":"Cookie Details","aboutCookiesLink":"Over Cookies","privacyPolicyLink":"Privacy Policy","columnName":"Naam","columnPurpose":"Doel","columnPII":"Kan persoonlijke informatie bevatten","columnDuration":"Duur","mainHeading":"Privacy \u0026 Transparantie","purposes":"Doeleinden","legitimateInterest":"Gerechtvaardigd belang ","consent":"Toestemming","specialPurposes":"Speciale doeleinden","manageSettings":"Instellingen beheren","saveSettings":"Instellingen opslaan \u0026 Afsluiten","vendors":"Leverancierslijst","nonTcfVendors":"Bijkomende Leveranciers","features":"Kenmerken","specialFeatures":"Speciale kenmerken","acceptAllButton":"Accepteer alles en ga door","purposePrefix":"Wij en onze partners gebruiken cookies om","stackPrefix":"Wij en onze partners gebruiken gegevens voor","mainBody":"Een voorbeeld van de gegevens die worden verwerkt, kan een unieke identificatie zijn die in een cookie is opgeslagen. Sommige van onze partners kunnen uw gegevens verwerken als onderdeel van hun legitieme zakelijke belang zonder toestemming te vragen. Gebruik de onderstaande link met de leverancierslijst om te zien voor welke doeleinden zij denken dat ze een gerechtvaardigd belang hebben, of om bezwaar te maken tegen deze gegevensverwerking. De verstrekte toestemming wordt alleen gebruikt voor gegevensverwerking die afkomstig is van deze website. Als u uw instellingen wilt wijzigen of uw toestemming op enig moment wilt intrekken, vindt u de link om dit te doen in ons privacybeleid dat toegankelijk is vanaf onze startpagina."}]},"settings":{"DomainSettingId":4522,"DomainId":110793,"defaultLanguage":"en","IsDialogEnabled":true,"IsOrigDialogEnabled":true,"IsMinorContent":false,"IsTCF2":true,"IsAMPDialogEnabled":false,"AutoDetectLanguage":true,"IsThirdParty":false,"IsWorldWide":false,"IsIabLspaSignatory":false,"ShowAcceptNecessaryButton":false,"ShowCategoryCheckboxes":false,"dialogAccentColor":"#5fa624","dialogBackgroundColor":"#ffffff","dialogTextColor":"#000000","checkedConsentBoxes":"preference,statistics","country":"","ccpaBannerPosition":"bottom","AltConsentEnabled":false,"hasNoConsentPage":false,"HasDynamicCookieRegex":false},"vendors":{"vendorList":null},"ezCMP":"ezCMPCookieConsent","ckLength":365,"cmpAllCookies":null,"cmpCookieTranslations":null,"privacy":"https://g.ezoic.net/privacy/hotexamples.com"},
	styles: '#ez-cookie-dialog-wrapper {width: 100% !important;height: 100% !important;margin: 0 auto !important;position: fixed !important;top: 0 !important;left: 0 !important;background-color: rgba(0, 0, 0, 0.5) !important;font-family: Arial, serif !important;z-index: 2000000000 !important;overflow-y: auto !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-table-box {overflow-y: auto !important;max-height: 150px !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog .select-wrapper span, #ez-cookie-dialog-wrapper #ez-cookie-dialog .select-wrapper ul, #ez-cookie-dialog-wrapper #ez-cookie-dialog .select-wrapper input {display: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog {display: block !important;position: relative !important;opacity: 1 !important;visibility: visible !important;margin: 150px auto 0 !important;width: 650px !important;-webkit-box-sizing: content-box !important;-moz-box-sizing: content-box !important;box-sizing: content-box !important;max-width: 90% !important;background: {background_color}!important;padding: 12px 24px !important;overflow: hidden !important;z-index: 2000000000 !important;border: 10px solid {accent_color}!important;box-shadow: #333 1px 1px 10px 1px !important;line-height: 1.2 !important;text-align: left !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog h2 {font-size: 20px !important;line-height: 16px !important;font-weight: 700 !important;margin: 10px 0 16px !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog p {margin: 12px 0 !important;line-height: 16px !important;text-indent: 0 !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog button {line-height: 16px !important;text-transform: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog select, #ez-cookie-dialog-wrapper #ez-cookie-dialog input {display: inline-block !important;position: relative !important;opacity: 1 !important;margin: 3px !important;font-size: 13px !important;color: {text_color};background-color: {background_color}!important;width: initial !important;padding: 0 !important;border: 1px solid {accent_color}!important;border-radius: 0 !important;height: initial !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog a, #ez-cookie-dialog-wrapper #ez-cookie-dialog p, #ez-cookie-dialog-wrapper #ez-cookie-dialog h2, #ez-cookie-dialog-wrapper #ez-cookie-dialog button {color: {text_color}!important;font-style: normal !important;text-decoration: none !important;font-variant: normal !important;font-family: Arial, serif !important;box-shadow: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog p, #ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-details-description, #ez-cookie-dialog-wrapper #ez-cookie-dialog button {font-weight: 400 !important;font-size: 10pt !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-details-description {padding: 10px 0 5px !important;color: {text_color}!important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-details {height: 34px !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-details, #ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-about-cookies {display: table-cell !important;color: {accent_color}!important;vertical-align: bottom !important;position: relative !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-details:after {width: 0px !important;height: 0px !important;border-left: 4px solid transparent !important;border-right: 4px solid transparent !important;border-top: 4px solid {accent_color}!important;content: "" !important;position: absolute !important;right: -14px !important;bottom: 6px !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-details.open:after {border-bottom: 4px solid {accent_color}!important;border-top: 0 solid transparent !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-about-cookies-text {display: none !important;margin-top: 12px !important;text-align: left !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-necessary-cookies {border: none !important;font-family: Arial, serif !important;color: #ffffff !important;background: #333333 !important;padding: 10px 20px 10px 20px !important;text-decoration: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-necessary-cookies:hover {cursor: pointer !important;background: #111111 !important;text-decoration: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-all-cookies {border: none !important;font-family: Arial, serif !important;color: {accept_button_text_color}!important;background: {accent_color}!important;padding: 10px 20px 10px 20px !important;text-decoration: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-all-cookies:hover {cursor: pointer !important;background: {accent_color}!important;text-decoration: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #privacy-link {font-size: 12px !important;display: block !important;margin-top: 20px !important;text-decoration: underline !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-ok-cookies {border: 1px solid {background_color}!important;font-family: Arial, serif !important;font-size: 9pt !important;color: {text_color}!important;background: {background_color}!important;padding: 5px 15px !important;text-decoration: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-ok-cookies:hover {cursor: pointer !important;background: {background_color}!important;text-decoration: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-about-cookies-container {margin: 32px auto 12px !important;width: 100% !important;display: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog a {color: {accent_color}!important;text-decoration: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #privacy {text-align: right !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-options {display: flex !important;flex-direction: row !important;margin: 12px 0 !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-details-container {display: none !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog .ez-cookie-option {flex: 1 !important;font-family: Arial, serif !important;font-size: 9pt !important;display: block !important;line-height: 26px !important;color: {text_color}!important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog .ez-cookie-option label {cursor: pointer !important;font-size: 12px !important;color: {text_color}!important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-table {max-width: 525px !important;width: 525px !important;margin-top: 12px !important;font-family: Arial, serif !important;border-spacing: 1px !important;font-size: 8pt !important;border-collapse: separate !important;background-color: {background_color}!important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-table th {background-color: {background_color}!important;color: {text_color}!important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #button-row {display: flex !important;flex-wrap: nowrap !important;justify-content: space-between !important;margin-right: 10px !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #secondary-links {display: flex !important;font-size: 12px !important;margin-top: 20px !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #secondary-links .bar {margin: 0 5px !important;width:auto!important;height:auto!important;position:relative!important;background:0 0!important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-table td {background-color: {background_color}!important;font-size: 8pt !important;width: 30% !important;-ms-word-break: break-word !important;word-break: break-word !important;color: {text_color}!important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-table td:nth-child(1) {width: 30% !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-table td:nth-child(2) {width: 50% !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-table td:nth-child(3) {width: 20% !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-table th, #ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-table td {text-align: left !important;padding: 3px !important;vertical-align: top !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog .ez-cookie-option input {vertical-align: middle !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-language {position: absolute !important;top: 10px !important;right: 10px !important;color: {text_color}!important;}@media only screen and (max-width: 600px) {#ez-cookie-dialog-wrapper #ez-cookie-dialog {margin-top: 5px !important;width: 100% !important;padding: 10px !important;border-width: 5px !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #button-row {flex-direction: column !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-options {flex-direction: column !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-necessary-cookies {margin-bottom: 5px !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog h2 {margin: 5px 0 !important;margin-right: 44px !important;font-size: 16px !important;}#ez-cookie-dialog-wrapper #ez-cookie-dialog #ez-cookie-table-box {overflow-y: auto !important;max-height: 100px !important;}}.cDuration {display: none;}',
	wrapper: '<div id="ez-cookie-dialog-wrapper"> <div id="ez-cookie-dialog"> <select id="ez-cookie-language" onchange="ezCMP.changeLanguage(this.value)">{language-options}</select> <div id="ez-cookie-form"></div> </div></div>',
	template:'<div id="ez-cookie-template"> <h2>{dialog-heading}</h2> <p>{dialog-body}</p><p><span id="button-row"> <span> <button id="ez-necessary-cookies" style="display:{decline-botton-text-display}" onclick="ezCMP.handleDeclineClick()">{decline-button-text}</button> <button id="ez-all-cookies" onclick="ezCMP.handleAcceptClick()">{accept-button-text}</button> </span> <span> <a id="ez-cookie-details" onclick="ezCMP.toggleDetails(true)" href="javascript:void(0);">{cookie-details-link}</a> </span> </span> </p><div id="ez-cookie-options" style="display:{cookie-options-display}"> <div class="ez-cookie-option"><label><input id="ez-cookie-option-necessary" type="checkbox" value="1" disabled checked/>{necessary}</label></div><div class="ez-cookie-option"><label><input id="ez-cookie-option-preference" type="checkbox" value="0"{preference-checked}/>{preference}</label></div><div class="ez-cookie-option"><label><input id="ez-cookie-option-statistics" type="checkbox" value="0"{statistics-checked}/>{statistics}</label></div><div class="ez-cookie-option"><label><input id="ez-cookie-option-marketing" type="checkbox" value="0"{marketing-checked}/>{marketing}</label></div><div class="ez-cookie-option"><button id="ez-ok-cookies" onclick="ezCMP.handleOkClick()">{ok-button-text}</button></div></div><div id="ez-cookie-details-container"> <div> <select onchange="ezCMP.loadDetails(this.value)"> <option value="necessary">{necessary}</option> <option value="preference">{preference}</option> <option value="statistics">{statistics}</option> <option value="marketing">{marketing}</option> <option value="unclassified">{unclassified}</option> </select> </div><div id="ez-cookie-details-description"></div><div style="overflow-x:auto;" id="ez-cookie-table-box"> <table id="ez-cookie-table"> <thead> <tr> <th>{column-name}</th> <th>{column-purpose}</th> <th>{column-pii}</th> <th class="cDuration">{column-duration}</th> </tr></thead> <tbody id="ez-cookie-table-body"> </tbody> </table> </div></div><p id="ez-about-cookies-text">{cookie-info}</p><div id="secondary-links"> <a id="ez-about-cookies" href="javascript:void(0);" onclick="ezCMP.toggleAbout()">{about-cookies-link}</a> <span class="bar">|</span> <a href="{privacy}" target="_privacy">{privacy-link}</a> </div></div>'
};
</script>

<script type="text/javascript" async="" src="./C++ (Cpp) poll Exemples - HotExamples_files/ezcl.webp"></script><div id="uglipop_overlay_wrapper" style="position:absolute;top:0;bottom:0;left:0;right:0;display:none"><div id="uglipop_overlay" style="position: fixed; inset: 0px; opacity: 0.3; width: 100%; height: 100%; background-color: black; display: none;"></div></div><div id="uglipop_content_fixed" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 1; z-index: 10000000; display: none;"><div id="uglipop_popbox"></div></div></body></html>